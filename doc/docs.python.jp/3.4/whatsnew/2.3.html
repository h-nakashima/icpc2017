<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>What’s New in Python 2.3 &mdash; Python 3.4.3 ドキュメント</title>
    
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.4.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 3.4.3 ドキュメント 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="top" title="Python 3.4.3 ドキュメント" href="../contents.html" />
    <link rel="up" title="What’s New in Python" href="index.html" />
    <link rel="next" title="What’s New in Python 2.2" href="2.2.html" />
    <link rel="prev" title="What’s New in Python 2.4" href="2.4.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/_jp.js"></script>
    <script type="text/javascript" src="../_static/version_switch.js"></script>
    
 

  <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-34175846-1', 'python.jp');
        ga('send', 'pageview');

      </script>
  <body role="document">  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="2.2.html" title="What’s New in Python 2.2"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="2.4.html" title="What’s New in Python 2.4"
             accesskey="P">前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &raquo;</li>
        <li>
          <span class="version_switcher_placeholder">3.4.3</span>
          <a href="../index.html">Documentation</a> &raquo;
        </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">What&#8217;s New in Python</a> &raquo;</li> 
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="what-s-new-in-python-2-3">
<h1>What&#8217;s New in Python 2.3<a class="headerlink" href="#what-s-new-in-python-2-3" title="このヘッドラインへのパーマリンク">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">A.M. Kuchling</td>
</tr>
</tbody>
</table>
<p>この文書は Python 2.3 の新機能について解説します。Python 2.3 は 2003 年 7 月 29 日にリリースされました。</p>
<p>Python 2.3 の主要なテーマは、2.2 で追加されたいくつかの機能を磨くこと、言語中核に小さいながらも有用な種々の拡張をすること、そして標準ライブラリの拡充です。ひとつ前のバージョンで導入された新しいオブジェクトモデルは、18 ヶ月に渡るバグフィックスと新スタイルクラスの性能改善をもたらした最適化の努力の恩恵を受けました。 <a class="reference internal" href="../library/functions.html#sum" title="sum"><code class="xref py py-func docutils literal"><span class="pre">sum()</span></code></a>, <a class="reference internal" href="../library/functions.html#enumerate" title="enumerate"><code class="xref py py-func docutils literal"><span class="pre">enumerate()</span></code></a> のような、新たなビルトイン関数が少し追加されました。 <a class="reference internal" href="../reference/expressions.html#in"><code class="xref std std-keyword docutils literal"><span class="pre">in</span></code></a> 演算子がサブストリングの検索に使えるようになりました (例えば <code class="docutils literal"><span class="pre">&quot;ab&quot;</span> <span class="pre">in</span> <span class="pre">&quot;abc&quot;</span></code> は <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> を返します)。</p>
<p>たくさんのライブラリ新機能…、Boolean、 set、 heap、 日付/時刻データ型、ZIP 形式アーカイブからのモジュールインポート、待ち望まれていた Python カタログのためのメタデータサポート、更新されたバージョンの IDLE、ロギングメッセージのためのモジュール、テキストの折り返し、CSV ファイルの解析、コマンドラインオプションの処理、BerkeleyDB データベースの使用…、新機能、強化機能のリストは長大になります。</p>
<p>このドキュメントは個々の新機能の完全な詳細を提供するのではなくて、簡易な概要を提供することを目的にしています。完全な詳細が知りたければ、 Python ライブラリリファレンス、Python リファレンスマニュアルのような Python 2.4 のドキュメントを参照してください。設計と実装の根拠を理解したい場合は、新機能に関する PEP を参照してください。</p>
<div class="section" id="pep-218-a-standard-set-datatype">
<h2>PEP 218: 標準の集合データ型<a class="headerlink" href="#pep-218-a-standard-set-datatype" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>(&#8212;訳注: イキナリですが、あなたが今これを「Python の歴史を知る」もしくは「初登場時の熱量高い紹介」を読みたくて読んでいるのでない限りは、もしくは本当に今 2.3 を使う必要があれば別ですが、このモジュールは 2.4 で既にビルトインで置き換えられ、2.6 では非推奨となり、3.0 では削除されています。ので、集合型について知りたければここよりも 2.4 のビルトインの方から読んだ方が良いです。&#8212;) &#8212; 新しいモジュール <code class="xref py py-mod docutils literal"><span class="pre">sets</span></code> には、集合データ型の実装が含まれています。 <code class="xref py py-class docutils literal"><span class="pre">Set</span></code> クラスは <a class="reference internal" href="../glossary.html#term-mutable"><span class="xref std std-term">mutable</span></a> の集合のためのクラスで、メンバの追加と削除が出来ます。 <code class="xref py py-class docutils literal"><span class="pre">ImmutableSet</span></code> は変更できない集合のためのクラスなので、辞書のキーとして利用出来ます。集合型は辞書の上に構築されているので、集合内の要素はハッシュ可能でなければなりません。</p>
<p>単純な使用例です:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">sets</span><span class="o">.</span><span class="n">Set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span>
<span class="go">Set([1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span> <span class="ow">in</span> <span class="n">S</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">0</span> <span class="ow">in</span> <span class="n">S</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span>
<span class="go">Set([1, 2, 5])</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>和集合 (union) と共通集合 (intersection) は <code class="xref py py-meth docutils literal"><span class="pre">union()</span></code> と <code class="xref py py-meth docutils literal"><span class="pre">intersection()</span></code> メソッドで計算出来ます; 別の記法として、ビット演算子 <code class="docutils literal"><span class="pre">&amp;</span></code> と <code class="docutils literal"><span class="pre">|</span></code> も使えます。変更可能な集合ではこれらのインプレイス版 <code class="xref py py-meth docutils literal"><span class="pre">union_update()</span></code> と <code class="xref py py-meth docutils literal"><span class="pre">intersection_update()</span></code> も使えます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">=</span> <span class="n">sets</span><span class="o">.</span><span class="n">Set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S2</span> <span class="o">=</span> <span class="n">sets</span><span class="o">.</span><span class="n">Set</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
<span class="go">Set([1, 2, 3, 4, 5, 6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">|</span> <span class="n">S2</span>                  <span class="c"># Alternative notation</span>
<span class="go">Set([1, 2, 3, 4, 5, 6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
<span class="go">Set([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">&amp;</span> <span class="n">S2</span>                  <span class="c"># Alternative notation</span>
<span class="go">Set([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span><span class="o">.</span><span class="n">union_update</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span>
<span class="go">Set([1, 2, 3, 4, 5, 6])</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>2 つの集合の対称差 (symmetric difference) を取ることも出来ます。これは、union から intersection を除いた全要素を取ります。別の言い方をすれば、対称差とは、正確に一つの集合だけに含まれる全要素、ということです。ほかと同じくビット演算子の記法 (<code class="docutils literal"><span class="pre">^</span></code>) が使え、インプレイス版は見苦しい名前の <code class="xref py py-meth docutils literal"><span class="pre">symmetric_difference_update()</span></code> です:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">=</span> <span class="n">sets</span><span class="o">.</span><span class="n">Set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S2</span> <span class="o">=</span> <span class="n">sets</span><span class="o">.</span><span class="n">Set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
<span class="go">Set([1, 2, 5, 6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">^</span> <span class="n">S2</span>
<span class="go">Set([1, 2, 5, 6])</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p><code class="xref py py-meth docutils literal"><span class="pre">issubset()</span></code> と <code class="xref py py-meth docutils literal"><span class="pre">issuperset()</span></code> メソッドも使えます。これはある集合が部分集合、上位集合であるかとうかをチェックします:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">=</span> <span class="n">sets</span><span class="o">.</span><span class="n">Set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S2</span> <span class="o">=</span> <span class="n">sets</span><span class="o">.</span><span class="n">Set</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S2</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
<span class="go">True</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-48"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0218"><strong>PEP 218</strong></a> - 集合オブジェクト型をビルトインに追加する</dt>
<dd><p class="first last">PEP 著 Greg V. Wilson. 実装: Greg V. Wilson, Alex Martelli, GvR. (&#8212;訳注: PEPそのものは 2.4 のビルトイン型 set, frozenset の追加と同じものですが、2.3 ではモジュールとして追加され、2.4 でビルトイン版が追加され、2.6 でモジュール版が非推奨となった、という流れです。&#8212;)</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-255-simple-generators">
<span id="section-generators"></span><h2>PEP 255: 単純なジェネレータ<a class="headerlink" href="#pep-255-simple-generators" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python 2.2 では、ジェネレータが <code class="docutils literal"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">generators</span></code> ディレクティブで有効に出来るオプションの機能として追加されました。2.3 ではジェネレータは特別に有効化する必要なく、もういつでもそこにあります。このセクションの残りの部分は &#8220;What&#8217;s New in Python 2.2&#8221; のジェネレータの記述からの丸々コピーですので、2.2 のときに読んだなら読み飛ばしてもらって結構です。</p>
<p>Python や C の標準的な関数コールについては、よくご存じに違いありません。関数を呼ぶと、ローカル変数を作るプライベートな名前空間ができますね。その関数が <code class="docutils literal"><span class="pre">return</span></code> 文まで来ると、ローカル変数が破壊されてから、返り値が呼び出し元に返ります。次に同じ関数をもう一度呼ぶと、新しいプライベート名前空間に新規のローカル変数が作られるのです。しかし、関数を出るときにローカル変数を捨てなければどうなるでしょうか。その出ていったところから関数を続行できたとしたら、どうでしょう。これこそジェネレータが提供する機能です; すなわち、ジェネレータは続行できる関数と考えることができます。</p>
<p>ジェネレータ関数の最も単純な例です:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">generate_ints</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">i</span>
</pre></div>
</div>
<p>新しいキーワード <a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal"><span class="pre">yield</span></code></a> がジェネレータのために導入されました。 <a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal"><span class="pre">yield</span></code></a> ステートメントを含むどんな関数もジェネレータ関数です; Python バイトコードコンパイラはこれを検知し、関数が特別に扱われるように翻訳します。 (&#8212;訳注: Python 2.5 の PEP 342 も参照して下さい。この 2.2 で導入時点の <code class="docutils literal"><span class="pre">yield</span></code> はステートメントではなく式に変更されています。&#8212;)</p>
<p>ジェネレータ関数を呼び出すと、単一の値の代わりにイテレータプロトコルに対応したオブジェクトを返します。上の例で <code class="docutils literal"><span class="pre">yield</span></code> を実行したとき、ジェネレータは <code class="docutils literal"><span class="pre">return</span></code> 文のようにして <code class="docutils literal"><span class="pre">i</span></code> の値を生成します。 <code class="docutils literal"><span class="pre">yield</span></code> と <code class="docutils literal"><span class="pre">return</span></code> 文の大きな違いは、 <code class="docutils literal"><span class="pre">yield</span></code> に到達した段階でジェネレータの実行状態が一時停止になって、ローカル変数が保存される点です。次回そのジェネレータの <code class="docutils literal"><span class="pre">.next()</span></code> メソッドを呼ぶと、 <a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal"><span class="pre">yield</span></code></a> の直後から関数が実行を再開します。(複雑な理由により、 <a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal"><span class="pre">yield</span></code></a> は <a class="reference internal" href="../reference/compound_stmts.html#try"><code class="xref std std-keyword docutils literal"><span class="pre">try</span></code></a>...<a class="reference internal" href="../reference/compound_stmts.html#finally"><code class="xref std std-keyword docutils literal"><span class="pre">finally</span></code></a> の <a class="reference internal" href="../reference/compound_stmts.html#try"><code class="xref std std-keyword docutils literal"><span class="pre">try</span></code></a> ブロック内に含めることは許されていません; <span class="target" id="index-49"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0255"><strong>PEP 255</strong></a> に <a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal"><span class="pre">yield</span></code></a> と例外の相互作用についての詳細説明がありますので参照して下さい。) &#8212; (&#8212;訳注: Python 2.5 の PEP 342 で <a class="reference internal" href="../reference/compound_stmts.html#try"><code class="xref std std-keyword docutils literal"><span class="pre">try</span></code></a>...<a class="reference internal" href="../reference/compound_stmts.html#finally"><code class="xref std std-keyword docutils literal"><span class="pre">finally</span></code></a> 内に置けないという制約はなくなりました。また、 <a class="reference internal" href="../reference/compound_stmts.html#try"><code class="xref std std-keyword docutils literal"><span class="pre">try</span></code></a>...<a class="reference internal" href="../reference/compound_stmts.html#finally"><code class="xref std std-keyword docutils literal"><span class="pre">finally</span></code></a> の <a class="reference internal" href="../reference/compound_stmts.html#try"><code class="xref std std-keyword docutils literal"><span class="pre">try</span></code></a> 、とここであえて特定しているのは、同じく 2.5 の PEP 341 によって try/except/finally の一体化されるまでは、 <code class="docutils literal"><span class="pre">finally</span></code> の <code class="docutils literal"><span class="pre">try</span></code> と <code class="docutils literal"><span class="pre">except</span></code> の <code class="docutils literal"><span class="pre">try</span></code> が別物だったからです。&#8212;)</p>
<p>上記 <code class="docutils literal"><span class="pre">generate_ints()</span></code> ジェネレータはこんな具合に使います:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">generate_ints</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span>
<span class="go">&lt;generator object at 0x8117f90&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;stdin&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
  File <span class="nb">&quot;stdin&quot;</span>, line <span class="m">2</span>, in <span class="n">generate_ints</span>
<span class="gr">StopIteration</span>
</pre></div>
</div>
<p>同じく <code class="docutils literal"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">generate_ints(5)</span></code> や <code class="docutils literal"><span class="pre">a,b,c</span> <span class="pre">=</span> <span class="pre">generate_ints(3)</span></code> といった書き方もできます。</p>
<p>ジェネレータ関数内で <code class="docutils literal"><span class="pre">return</span></code> 文は、引数を付けずに、処理の終わりを知らせるためにだけ使うことができます; <code class="docutils literal"><span class="pre">return</span></code> を実行したあとは、もうそのジェネレータが値を返すことはできません。ジェネレータ関数の中では、 <code class="docutils literal"><span class="pre">return</span> <span class="pre">5</span></code> などと値を付けた <code class="docutils literal"><span class="pre">return</span></code> は構文エラーです。ジェネレータの出力が終わったことを示すには、ほかにも、手動で <a class="reference internal" href="../library/exceptions.html#StopIteration" title="StopIteration"><code class="xref py py-exc docutils literal"><span class="pre">StopIteration</span></code></a>  を投げてもいいですし、関数の最後まで実行するだけでも同じことになります。(&#8212;訳注: Python 2.7 まではジェネレータ内での戻り値のある <code class="docutils literal"><span class="pre">return</span> <span class="pre">5</span></code> は構文エラーになりますが、少なくとも Python 3.4 で構文エラーとはなりません。単に無視されます。リファレンスに言及されていない振舞いなので、何かの事故かもしれません。いずれにせよジェネレータ内では Python 3 でも <code class="docutils literal"><span class="pre">return</span></code> で値は戻せません。&#8212;)</p>
<p>自分でクラスを書いて、ジェネレータで言うところのローカル変数をインスタンス変数として全部保管しておけば、同じ効果を得ることは可能です。たとえば整数のリストを返すのは、 <code class="docutils literal"><span class="pre">self.count</span></code> を 0 にして、 <code class="docutils literal"><span class="pre">next()</span></code> メソッドが <code class="docutils literal"><span class="pre">self.count</span></code> をインクリメントして返すようにすればできます。しかしながら、ある程度複雑なジェネレータになってくると、同じことをするクラスを書くのは格段にややこしいことになります。 <code class="file docutils literal"><span class="pre">Lib/test/test_generators.py</span></code> にはもっと面白い例がたくさん含まれています。一番単純な一つは、ジェネレータを再帰的に使ってツリーを順繰りに横断する実装をするこれです (&#8212;訳注: ジェネレータは現在の最新 3.5 までの間に 2 度大きな機能強化が行われているのですが、一つが 2.5 での PEP 342 でこれは yield 「に」値を戻せるようにするものです。もう一つが 3.3 での PEP 380 で、これはサブジェネレータへの委譲 <code class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span> <span class="pre">&lt;subgen&gt;</span></code> の追加でした。ですのでこの 3.3 からの <code class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span></code> を使うと下記例はもっとスッキリ書けます。&#8212;):</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="c"># A recursive generator that generates Tree leaves in in-order.</span>
<span class="k">def</span> <span class="nf">inorder</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">t</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inorder</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">left</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">x</span>
        <span class="k">yield</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inorder</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">right</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">x</span>
</pre></div>
</div>
<p>ほかにも:file:<cite>Lib/test/test_generators.py</cite> には、N-Queens 問題 (N×N コマのチェス盤に、互いに攻撃できないような配置で N 個のクイーンを置く) やナイト・ツアー (N×N 盤の全コマをナイトが一度ずつ通るような経路を探す) の解を出す例が入っています。</p>
<p>ジェネレータの発想はほかのプログラミング言語、特に Icon (<a class="reference external" href="http://www.cs.arizona.edu/icon/">http://www.cs.arizona.edu/icon/</a>) から着想しています。Icon ではジェネレータが言語の中枢になっています。Icon では、あらゆる式と関数がジェネレータのように振舞います。 <a class="reference external" href="http://www.cs.arizona.edu/icon/docs/ipd266.htm">http://www.cs.arizona.edu/icon/docs/ipd266.htm</a> の &#8220;Icon プログラミング言語の概要&#8221; の一つの例が、これがどのようなものであるのかを教えてくれます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">sentence</span> <span class="p">:</span><span class="o">=</span> <span class="s">&quot;Store it in the neighboring harbor&quot;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="s">&quot;or&quot;</span><span class="p">,</span> <span class="n">sentence</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="n">then</span> <span class="n">write</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>Icon では <code class="xref py py-func docutils literal"><span class="pre">find()</span></code> 関数は部分文字列 &#8220;or&#8221; が見つかる位置 3, 23, 33 を返します。 <a class="reference internal" href="../reference/compound_stmts.html#if"><code class="xref std std-keyword docutils literal"><span class="pre">if</span></code></a> 文内では <code class="docutils literal"><span class="pre">i</span></code> には最初 3 が代入されますが、これは 3 より小さいので比較は失敗し、Icon は次の値 23 を取り出します。 23 は 5 より大きいので比較は成功し、コードは 23 をスクリーンに表示します。</p>
<p>Python では Icon がそうするほどにはジェネレータを中心的概念に置きません。ジェネレータは Python 言語中核の新たな一面ではありますが、それらを学ぶのも使うのも誰しも行うべきだというものでもなく、そしてこれで解決できない何か問題があれば、忘れてしまっても良いものです。Icon と比較した特筆すべき Python インターフェイスの機能はジェネレータの状態が具象オブジェクト (イテレータ) で表現されることであり、それは他の関数に渡せますし、データ構造に記憶しておくことも出来ます。(&#8212;訳注: ジェネレータについてかなり控えめなのは、この時点で著者は将来の拡張を既に見据えていたから? かもしれませんね。PEP 342 と PEP 380 により今やジェネレータはこの頃より遥かに高機能になっており、今ではきっと「こんなものなくても困らない」なんて Python 使いはいないでしょう。&#8212;)</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-50"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0255"><strong>PEP 255</strong></a> - 単純なジェネレータ</dt>
<dd><p class="first last">Neil Schemenauer, Tim Peters, Magnus Lie Hetland により著されました。実装のほとんどは Neil Schemenauer と Tim Peters により行われ、 Python Labs クルーにより他の修正が行われました。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-263-source-code-encodings">
<span id="section-encodings"></span><h2>PEP 263: ソースコードのエンコーディング<a class="headerlink" href="#pep-263-source-code-encodings" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python ソースファイルで、異なる文字セットエンコーディングを宣言出来るようになりました。エンコーディングはソースコードの 1 行目か 2 行目に特殊形式のコメントを含めることで宣言出来ます。 UTF-8 ファイルであればこのように宣言出来ます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: UTF-8 -*-</span>
</pre></div>
</div>
<p>このエンコーディング宣言がなければ、デフォルトの 7 ビット ASCII エンコーディングが使われます(訳注: Python 3 からはデフォルトは utf-8 (PEP 3120))。8 ビット文字を含んでいるのにエンコーディング宣言がないモジュールの実行やインポートを行うと、 Python 2.3 では <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal"><span class="pre">DeprecationWarning</span></code></a> を引き起こします; 2.4 ではこれは構文エラーになる予定です(訳注: 実際には 2.4 ではこれは実現せず、2.5 から)。</p>
<p>エンコーディング宣言は Unicode 文字列リテラルにのみ影響します。それらは指定したエンコーディングで Unicode 文字列に変換されます。Python 識別子は今でも ASCII 文字列に制限されていることに注意してください。ですから普通の英数字範囲外の文字を変数名に使うことは出来ません。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-51"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0263"><strong>PEP 263</strong></a> - Python ソースコードのエンコーディングを定義する</dt>
<dd><p class="first last">Marc-André Lemburg、 Martin von Löwis 著; Suzuki Hisao、 Martin von Löwis 実装.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-273-importing-modules-from-zip-archives">
<h2>PEP 273: Zip アーカイブからモジュールをインポートする<a class="headerlink" href="#pep-273-importing-modules-from-zip-archives" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>新たなモジュール <a class="reference internal" href="../library/zipimport.html#module-zipimport" title="zipimport: support for importing Python modules from ZIP archives."><code class="xref py py-mod docutils literal"><span class="pre">zipimport</span></code></a> が、ZIP フォーマットの書庫からモジュールのインポートをサポートします。 <a class="reference internal" href="../library/zipimport.html#module-zipimport" title="zipimport: support for importing Python modules from ZIP archives."><code class="xref py py-mod docutils literal"><span class="pre">zipimport</span></code></a> を明示的にインポートする必要はありません; <code class="docutils literal"><span class="pre">sys.path</span></code> に ZIP 形式書庫が追加されるとそれは自動的にインポートされます。例えば:</p>
<div class="highlight-python3"><div class="highlight"><pre>amk@nyman:~/src/python$ unzip -l /tmp/example.zip
Archive:  /tmp/example.zip
  Length     Date   Time    Name
 --------    ----   ----    ----
     8467  11-26-02 22:30   jwzthreading.py
 --------                   -------
     8467                   1 file
amk@nyman:~/src/python$ ./python
Python 2.3 (#1, Aug 1 2003, 19:54:32)
&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.path.insert(0, &#39;/tmp/example.zip&#39;)  # Add .zip file to front of path
&gt;&gt;&gt; import jwzthreading
&gt;&gt;&gt; jwzthreading.__file__
&#39;/tmp/example.zip/jwzthreading.py&#39;
&gt;&gt;&gt;
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">sys.path</span></code> には今や ZIP 書庫のファイル名も入れることが出来ます。ZIP アーカイブ内にはどんなファイルを置いてもかまいませんが、import できるのは <code class="file docutils literal"><span class="pre">*.py</span></code>, <code class="file docutils literal"><span class="pre">*.pyc</span></code>, <code class="file docutils literal"><span class="pre">*.pyo</span></code> だけです。書庫に <code class="file docutils literal"><span class="pre">*.py</span></code> だけが含まれる場合には、Python は書庫を修正して対応する <code class="file docutils literal"><span class="pre">*.pyc</span></code> を作るなどということはしないので、 <code class="file docutils literal"><span class="pre">*.pyc</span></code> ファイルを含まない ZIP 書庫からのインポートはやや遅いかもしれません。</p>
<p>書庫内のパスをサブディレクトリ以下のみインポートするように指定出来ます; 例えば、パス <code class="file docutils literal"><span class="pre">/tmp/example.zip/lib/</span></code> はその書庫内の <code class="file docutils literal"><span class="pre">lib/</span></code> サブディレクトリだけからインポートします。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-52"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0273"><strong>PEP 273</strong></a> - Zip アーカイブからモジュールをインポートする</dt>
<dd><p class="first last">このモジュールの実装も行った、James C. Ahlstrom による PEP です。 Python 2.3 は  <span class="target" id="index-53"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0273"><strong>PEP 273</strong></a> の仕様に従っていますが、 Just van Rossum の書いた、 <span class="target" id="index-54"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0302"><strong>PEP 302</strong></a> に記述されている import フックによる実装を使っています。その新しい import フックについては  <a class="reference internal" href="#section-pep302"><span>PEP 302: 新たなインポートフック</span></a>  をみてください。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-277-unicode-file-name-support-for-windows-nt">
<h2>PEP 277: Windows NT での Unicode ファイル名サポート<a class="headerlink" href="#pep-277-unicode-file-name-support-for-windows-nt" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Windows NT, 2000, XP では、ファイルシステムはファイル名として Unicode 文字列を使います。伝統的に Python はファイル名をバイト文字列として表現してきましたが、それはアクセス出来ないファイル名を表してしまう場合があって、不十分でした。</p>
<p>Python はいまや (ファイルシステムの制約の範囲内での) 任意の Unicode 文字列をファイル名が期待される全ての関数で許容します。 <a class="reference internal" href="../library/os.html#os.listdir" title="os.listdir"><code class="xref py py-func docutils literal"><span class="pre">os.listdir()</span></code></a> に Unicode 文字列が渡されれば、Python は今では Unicode 文字列のリストを返します。新しい関数 <code class="xref py py-func docutils literal"><span class="pre">os.getcwdu()</span></code> は Unicode 文字列でカレントディレクトリを返します(訳注: ちなみに Python 3 での Unicode 周りの大改造に伴いこの関数はなくなり、代わりに「あえてバイト列のほうを返す」 <code class="docutils literal"><span class="pre">os.getcwdb</span></code> が追加されています(<code class="docutils literal"><span class="pre">os.getcwdu</span></code> がもはや Unicode を返すので)。)。</p>
<p>ファイル名のバイト文字列はいまでも動きます。Windows 版 Python は透過的にそれらを Unicode に <code class="docutils literal"><span class="pre">mbcs</span></code> エンコーディングを使って変換します。</p>
<p>ほかのシステムでもファイル名の Unicode は許容されますが、システムに渡す前にバイト文字列に変換され、 <a class="reference internal" href="../library/exceptions.html#UnicodeError" title="UnicodeError"><code class="xref py py-exc docutils literal"><span class="pre">UnicodeError</span></code></a> 例外を引き起こすかもしれません。アプリケーションは任意の Unicode 文字列がファイル名に許されるかどうかを、ブーリアン値 <a class="reference internal" href="../library/os.path.html#os.path.supports_unicode_filenames" title="os.path.supports_unicode_filenames"><code class="xref py py-attr docutils literal"><span class="pre">os.path.supports_unicode_filenames</span></code></a> をチェックすることでテスト出来ます。</p>
<p>MacOS では、 <a class="reference internal" href="../library/os.html#os.listdir" title="os.listdir"><code class="xref py py-func docutils literal"><span class="pre">os.listdir()</span></code></a> は Unicode ファイル名を返すようになっているでしょう。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-55"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0277"><strong>PEP 277</strong></a> - Windows NT での Unicode ファイル名サポート</dt>
<dd><p class="first last">Neil Hodgson 著; 実装 Neil Hodgson, Martin von Löwis, Mark Hammond。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-278-universal-newline-support">
<span id="index-8"></span><h2>PEP 278: Universal Newline サポート<a class="headerlink" href="#pep-278-universal-newline-support" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>今日では 3 つの主要なオペレーティングシステムが使われています。 Microsoft Windows, Apple の Macintosh OS, さまざまな Unix 派生系です。テキストファイルの行終端マークに使う文字がこれら 3 つ全てでそれぞれ違っていることが、クロスプラットフォームのための仕事における小さな苛立ちです。  Unix が使うのはラインフィード (ASCII 文字 10), MacOS が使うのはキャリッジリターン (ASCII 文字 13),  Windows に至ってはキャリッジリターンとラインフィード 2 文字のシーケンスを使います。</p>
<p>Python のファイルオブジェクトが、動作しているプラットフォームに従わない行終端変換をサポートするようになりました。ファイルのオープンにモード <code class="docutils literal"><span class="pre">'U'</span></code> や <code class="docutils literal"><span class="pre">'rU'</span></code> を使うと、 <a class="reference internal" href="../glossary.html#term-universal-newlines"><span class="xref std std-term">universal newlines</span></a> モードを使った読み込みとしてファイルを開きます。これで <code class="xref py py-meth docutils literal"><span class="pre">read()</span></code>, <a class="reference internal" href="../library/readline.html#module-readline" title="readline: GNU readline support for Python. (Unix)"><code class="xref py py-meth docutils literal"><span class="pre">readline()</span></code></a> などのファイルメソッドが、 3 つどの行終端でも <code class="docutils literal"><span class="pre">'\n'</span></code> に翻訳して返すようになります。</p>
<p>universal newline サポートはモジュールのインポートと <code class="xref py py-func docutils literal"><span class="pre">execfile()</span></code> 関数でのファイル実行にも使われます。これで 3 つ全てのオペレーティングシステム間で行終端変換の必要なく Python モジュールを共有出来ます。</p>
<p>この機能は Python をソースからビルドする際に <strong class="program">configure</strong> スクリプトに <code class="xref std std-option docutils literal"><span class="pre">--without-universal-newlines</span></code> スイッチ を付けることで無効に出来ます。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-56"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0278"><strong>PEP 278</strong></a> : Universal Newline サポート</dt>
<dd><p class="first last">Jack Jansen 著、実装</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-279-enumerate">
<span id="section-enumerate"></span><h2>PEP 279: enumerate()<a class="headerlink" href="#pep-279-enumerate" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>新たな組み込み関数 <a class="reference internal" href="../library/functions.html#enumerate" title="enumerate"><code class="xref py py-func docutils literal"><span class="pre">enumerate()</span></code></a> はある種のループ処理を少し簡潔にするものです。 <em>thing</em> がイテレータかシーケンスだとして、 <code class="docutils literal"><span class="pre">enumerate(thing)</span></code> は <code class="docutils literal"><span class="pre">(0,</span> <span class="pre">thing[0])</span></code>, <code class="docutils literal"><span class="pre">(1,</span> <span class="pre">thing[1])</span></code>, <code class="docutils literal"><span class="pre">(2,</span> <span class="pre">thing[2])</span></code>, … を生成するイテレータを返します。</p>
<p>リストの全てを変更するためのよくあるイディオムはこのようなものでしょう:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c"># ... compute some result based on item ...</span>
    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</pre></div>
</div>
<p>これは <a class="reference internal" href="../library/functions.html#enumerate" title="enumerate"><code class="xref py py-func docutils literal"><span class="pre">enumerate()</span></code></a> を使ってこのように書き換えることが出来ます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="c"># ... compute some result based on item ...</span>
    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-57"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0279"><strong>PEP 279</strong></a> - 組み込み関数 enumerate()</dt>
<dd><p class="first last">Raymond D. Hettinger 著、実装.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-282-the-logging-package">
<h2>PEP 282: ロギングパッケージ<a class="headerlink" href="#pep-282-the-logging-package" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A standard package for writing logs, <a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a>, has been added to Python
2.3.  It provides a powerful and flexible mechanism for generating logging
output which can then be filtered and processed in various ways.  A
configuration file written in a standard format can be used to control the
logging behavior of a program.  Python includes handlers that will write log
records to standard error or to a file or socket, send them to the system log,
or even e-mail them to a particular address; of course, it&#8217;s also possible to
write your own handler classes.</p>
<p>The <code class="xref py py-class docutils literal"><span class="pre">Logger</span></code> class is the primary class. Most application code will deal
with one or more <code class="xref py py-class docutils literal"><span class="pre">Logger</span></code> objects, each one used by a particular
subsystem of the application. Each <code class="xref py py-class docutils literal"><span class="pre">Logger</span></code> is identified by a name, and
names are organized into a hierarchy using <code class="docutils literal"><span class="pre">.</span></code>  as the component separator.
For example, you might have <code class="xref py py-class docutils literal"><span class="pre">Logger</span></code> instances named <code class="docutils literal"><span class="pre">server</span></code>,
<code class="docutils literal"><span class="pre">server.auth</span></code> and <code class="docutils literal"><span class="pre">server.network</span></code>.  The latter two instances are below
<code class="docutils literal"><span class="pre">server</span></code> in the hierarchy.  This means that if you turn up the verbosity for
<code class="docutils literal"><span class="pre">server</span></code> or direct <code class="docutils literal"><span class="pre">server</span></code> messages to a different handler, the changes
will also apply to records logged to <code class="docutils literal"><span class="pre">server.auth</span></code> and <code class="docutils literal"><span class="pre">server.network</span></code>.
There&#8217;s also a root <code class="xref py py-class docutils literal"><span class="pre">Logger</span></code> that&#8217;s the parent of all other loggers.</p>
<p>For simple uses, the <a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> package contains some convenience functions
that always use the root log:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Debugging information&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Informational message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Warning:config file %s not found&#39;</span><span class="p">,</span> <span class="s">&#39;server.conf&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&#39;Error occurred&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s">&#39;Critical error -- shutting down&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>上記のコードは以下のような出力になります:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">WARNING</span><span class="p">:</span><span class="n">root</span><span class="p">:</span><span class="ne">Warning</span><span class="p">:</span><span class="n">config</span> <span class="n">file</span> <span class="n">server</span><span class="o">.</span><span class="n">conf</span> <span class="ow">not</span> <span class="n">found</span>
<span class="n">ERROR</span><span class="p">:</span><span class="n">root</span><span class="p">:</span><span class="n">Error</span> <span class="n">occurred</span>
<span class="n">CRITICAL</span><span class="p">:</span><span class="n">root</span><span class="p">:</span><span class="n">Critical</span> <span class="n">error</span> <span class="o">--</span> <span class="n">shutting</span> <span class="n">down</span>
</pre></div>
</div>
<p>In the default configuration, informational and debugging messages are
suppressed and the output is sent to standard error.  You can enable the display
of informational and debugging messages by calling the <code class="xref py py-meth docutils literal"><span class="pre">setLevel()</span></code> method
on the root logger.</p>
<p>Notice the <code class="xref py py-func docutils literal"><span class="pre">warning()</span></code> call&#8217;s use of string formatting operators; all of the
functions for logging messages take the arguments <code class="docutils literal"><span class="pre">(msg,</span> <span class="pre">arg1,</span> <span class="pre">arg2,</span> <span class="pre">...)</span></code> and
log the string resulting from <code class="docutils literal"><span class="pre">msg</span> <span class="pre">%</span> <span class="pre">(arg1,</span> <span class="pre">arg2,</span> <span class="pre">...)</span></code>.</p>
<p>There&#8217;s also an <code class="xref py py-func docutils literal"><span class="pre">exception()</span></code> function that records the most recent
traceback.  Any of the other functions will also record the traceback if you
specify a true value for the keyword argument <em>exc_info</em>.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>
    <span class="k">except</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s">&#39;Problem recorded&#39;</span><span class="p">)</span>

<span class="n">f</span><span class="p">()</span>
</pre></div>
</div>
<p>上記のコードは以下のような出力になります:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">ERROR</span><span class="p">:</span><span class="n">root</span><span class="p">:</span><span class="n">Problem</span> <span class="n">recorded</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">&quot;t.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">6</span><span class="p">,</span> <span class="ow">in</span> <span class="n">f</span>
    <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>
<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">integer</span> <span class="n">division</span> <span class="ow">or</span> <span class="n">modulo</span> <span class="n">by</span> <span class="n">zero</span>
</pre></div>
</div>
<p>Slightly more advanced programs will use a logger other than the root logger.
The <code class="docutils literal"><span class="pre">getLogger(name)</span></code> function is used to get a particular log, creating
it if it doesn&#8217;t exist yet. <code class="docutils literal"><span class="pre">getLogger(None)</span></code> returns the root logger.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;server&#39;</span><span class="p">)</span>
 <span class="o">...</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Listening on port %i&#39;</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
 <span class="o">...</span>
<span class="n">log</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s">&#39;Disk full&#39;</span><span class="p">)</span>
 <span class="o">...</span>
</pre></div>
</div>
<p>Log records are usually propagated up the hierarchy, so a message logged to
<code class="docutils literal"><span class="pre">server.auth</span></code> is also seen by <code class="docutils literal"><span class="pre">server</span></code> and <code class="docutils literal"><span class="pre">root</span></code>, but a <code class="xref py py-class docutils literal"><span class="pre">Logger</span></code>
can prevent this by setting its <code class="xref py py-attr docutils literal"><span class="pre">propagate</span></code> attribute to <a class="reference internal" href="../library/constants.html#False" title="False"><code class="xref py py-const docutils literal"><span class="pre">False</span></code></a>.</p>
<p>There are more classes provided by the <a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> package that can be
customized.  When a <code class="xref py py-class docutils literal"><span class="pre">Logger</span></code> instance is told to log a message, it
creates a <code class="xref py py-class docutils literal"><span class="pre">LogRecord</span></code> instance that is sent to any number of different
<code class="xref py py-class docutils literal"><span class="pre">Handler</span></code> instances.  Loggers and handlers can also have an attached list
of filters, and each filter can cause the <code class="xref py py-class docutils literal"><span class="pre">LogRecord</span></code> to be ignored or
can modify the record before passing it along.  When they&#8217;re finally output,
<code class="xref py py-class docutils literal"><span class="pre">LogRecord</span></code> instances are converted to text by a <code class="xref py py-class docutils literal"><span class="pre">Formatter</span></code>
class.  All of these classes can be replaced by your own specially-written
classes.</p>
<p>With all of these features the <a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> package should provide enough
flexibility for even the most complicated applications.  This is only an
incomplete overview of its features, so please see the package&#8217;s reference
documentation for all of the details.  Reading <span class="target" id="index-11"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0282"><strong>PEP 282</strong></a> will also be helpful.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-58"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0282"><strong>PEP 282</strong></a> - ログシステム</dt>
<dd>Written by Vinay Sajip and Trent Mick; implemented by Vinay Sajip.</dd>
</dl>
</div>
</div>
<div class="section" id="pep-285-a-boolean-type">
<span id="section-bool"></span><h2>PEP 285: Boolean 型<a class="headerlink" href="#pep-285-a-boolean-type" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>真偽値型 (Boolean) が Python 2.3 に追加されました。関連して 2 つの定数 <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> と <a class="reference internal" href="../library/constants.html#False" title="False"><code class="xref py py-const docutils literal"><span class="pre">False</span></code></a> が <code class="xref py py-mod docutils literal"><span class="pre">__builtin__</span></code> モジュールに追加されています。(定数 <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> と <a class="reference internal" href="../library/constants.html#False" title="False"><code class="xref py py-const docutils literal"><span class="pre">False</span></code></a> は Python 2.2.1 にはビルトインに追加されてはいたのですが、 2.2.1 版のものは単純に整数の 1 と 0 をセットしただけのもので、独立した真偽値型ではありませんでした。)</p>
<p>この新しい型の型オブジェクトの名前は <a class="reference internal" href="../library/functions.html#bool" title="bool"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> です; これのコンストラクタは任意の Python 値を取り、 <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> または <a class="reference internal" href="../library/constants.html#False" title="False"><code class="xref py py-const docutils literal"><span class="pre">False</span></code></a> に変換します:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">([])</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>標準ライブラリモジュールとビルトイン関数のほとんどが、そうすべきときには Boolean を返すように変更されました:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s">&#39;append&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Python の Boolean はコードを明快にすることを主たる目標として追加されました。例えばあなたがコードを読んでいて <code class="docutils literal"><span class="pre">return</span> <span class="pre">1</span></code> に出くわした場合、あなたは考えるはずです。この <code class="docutils literal"><span class="pre">1</span></code> は、真偽としての真値なのであろうか、それともインデクスだろうか、はたまた何かほかの数量に掛ける係数だろうか、と。 <code class="docutils literal"><span class="pre">return</span> <span class="pre">True</span></code> であればその意味するところはかなり明らかです。</p>
<p>Python の Boolean は、厳格な型チェックを目的として追加された <em>のではありません</em> 。Pascal のようなとても厳格な言語では、Boolean の数学演算も阻むでしょうし、 <a class="reference internal" href="../reference/compound_stmts.html#if"><code class="xref std std-keyword docutils literal"><span class="pre">if</span></code></a> ステートメントの式が必ず Boolean の結果に評価されなければならないことを要求するでしょう。 Python はこの厳しさを今持ちませんし、 <span class="target" id="index-59"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0285"><strong>PEP 285</strong></a> が名言するように、未来永劫持つことはありません。このことは、 <a class="reference internal" href="../reference/compound_stmts.html#if"><code class="xref std std-keyword docutils literal"><span class="pre">if</span></code></a> ステートメントにこれからも任意の式を書けることを意味しますし、リストやらタプルやら何かほかのデタラメなオブジェクトに評価されるものでも良いことを意味します。Boolean 型は <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> クラスのサブクラスであって、Boolean の算術演算はこれからも動作します:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">True</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">False</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">False</span> <span class="o">*</span> <span class="mi">75</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">True</span> <span class="o">*</span> <span class="mi">75</span>
<span class="go">75</span>
</pre></div>
</div>
<p><a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> と <a class="reference internal" href="../library/constants.html#False" title="False"><code class="xref py py-const docutils literal"><span class="pre">False</span></code></a> はぶっちゃけて言えば…: これらは整数値 1 と 0 の別名だけれども唯一異なるのは <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-func docutils literal"><span class="pre">str()</span></code></a> と <a class="reference internal" href="../library/functions.html#repr" title="repr"><code class="xref py py-func docutils literal"><span class="pre">repr()</span></code></a> が <code class="docutils literal"><span class="pre">'1'</span></code> と <code class="docutils literal"><span class="pre">'0'</span></code> ではなく <code class="docutils literal"><span class="pre">'True'</span></code> と <code class="docutils literal"><span class="pre">'False'</span></code> を返すことだけである。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-60"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0285"><strong>PEP 285</strong></a> - 真偽値型の追加</dt>
<dd><p class="first last">Guido van Rossum 著、実装</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-293-codec-error-handling-callbacks">
<h2>PEP 293: コーデックエラーを処理するコールバック<a class="headerlink" href="#pep-293-codec-error-handling-callbacks" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Unicode 文字列をバイト文字列にエンコードする際には、エンコード出来ない文字に出会うことがあります。いまのところ Python は、そのエラー処理として &#8220;strict&#8221; (<a class="reference internal" href="../library/exceptions.html#UnicodeError" title="UnicodeError"><code class="xref py py-exc docutils literal"><span class="pre">UnicodeError</span></code></a> を発生させる)、  &#8220;ignore&#8221; (その文字をスキップする)、 &#8220;replace&#8221; (出力文字列ではクエッションマークに置換する)、のいずれか一つを指定出来て、 &#8220;strict&#8221; がデフォルトの振る舞いになっています。その種のエラーのために、ほかの代わりとなる処理が望ましいかもしれません。例えば XML や HTML の実体参照に置き換えるなどの。</p>
<p>Python は今や、異なる処理戦略を追加する柔軟なフレームワークを手にしました。新しいエラーハンドラを <a class="reference internal" href="../library/codecs.html#codecs.register_error" title="codecs.register_error"><code class="xref py py-func docutils literal"><span class="pre">codecs.register_error()</span></code></a> で追加出来、コーデックは <a class="reference internal" href="../library/codecs.html#codecs.lookup_error" title="codecs.lookup_error"><code class="xref py py-func docutils literal"><span class="pre">codecs.lookup_error()</span></code></a> を使ってそのエラーハンドラにアクセス出来ます。等価な C API も C で書かれたコーデックのために追加されています。エラーハンドラは、変換すべき文字列、そのエラーが検出されたその文字列内での位置、ターゲットエンコーディングのような必要な状態情報を受け取ります。ハンドラは例外を投げるか、置換文字列を返せます。</p>
<p>このフレームワークを使って 2 つのエラーハンドラが実装されました: &#8220;backslashreplace&#8221; はエンコード出来ない文字をバックスラッシュで引用し、 &#8220;xmlcharrefreplace&#8221; は XML 文字参照を発行します。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-61"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0293"><strong>PEP 293</strong></a> - コーデックエラーを処理するコールバック</dt>
<dd><p class="first last">Walter Dörwald 著、実装</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-301-package-index-and-metadata-for-distutils">
<span id="section-pep301"></span><h2>PEP 301: Package Index and Metadata for Distutils<a class="headerlink" href="#pep-301-package-index-and-metadata-for-distutils" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Support for the long-requested Python catalog makes its first appearance in 2.3.</p>
<p>The heart of the catalog is the new Distutils <strong class="command">register</strong> command.
Running <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">register</span></code> will collect the metadata describing a
package, such as its name, version, maintainer, description, &amp;c., and send it to
a central catalog server.  The resulting catalog is available from
<a class="reference external" href="https://pypi.python.org/pypi">https://pypi.python.org/pypi</a>.</p>
<p>To make the catalog a bit more useful, a new optional <em>classifiers</em> keyword
argument has been added to the Distutils <code class="xref py py-func docutils literal"><span class="pre">setup()</span></code> function.  A list of
<a class="reference external" href="http://catb.org/~esr/trove/">Trove</a>-style strings can be supplied to help
classify the software.</p>
<p>Here&#8217;s an example <code class="file docutils literal"><span class="pre">setup.py</span></code> with classifiers, written to be compatible
with older versions of the Distutils:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">distutils</span> <span class="k">import</span> <span class="n">core</span>
<span class="n">kw</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&quot;Quixote&quot;</span><span class="p">,</span>
      <span class="s">&#39;version&#39;</span><span class="p">:</span> <span class="s">&quot;0.5.1&quot;</span><span class="p">,</span>
      <span class="s">&#39;description&#39;</span><span class="p">:</span> <span class="s">&quot;A highly Pythonic Web application framework&quot;</span><span class="p">,</span>
      <span class="c"># ...</span>
      <span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="s">&#39;setup_keywords&#39;</span><span class="p">)</span> <span class="ow">and</span>
    <span class="s">&#39;classifiers&#39;</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">setup_keywords</span><span class="p">):</span>
    <span class="n">kw</span><span class="p">[</span><span class="s">&#39;classifiers&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="p">[</span><span class="s">&#39;Topic :: Internet :: WWW/HTTP :: Dynamic Content&#39;</span><span class="p">,</span>
         <span class="s">&#39;Environment :: No Input/Output (Daemon)&#39;</span><span class="p">,</span>
         <span class="s">&#39;Intended Audience :: Developers&#39;</span><span class="p">],</span>

<span class="n">core</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</pre></div>
</div>
<p>The full list of classifiers can be obtained by running  <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span>
<span class="pre">register</span> <span class="pre">--list-classifiers</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-16"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0301"><strong>PEP 301</strong></a> - Package Index and Metadata for Distutils</dt>
<dd><p class="first last">Richard Jones 著、実装</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-302-new-import-hooks">
<span id="section-pep302"></span><h2>PEP 302: 新たなインポートフック<a class="headerlink" href="#pep-302-new-import-hooks" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>カスタムなインポートフックを書くことは、Python 1.3 で <code class="xref py py-mod docutils literal"><span class="pre">ihooks</span></code> モジュールが導入されたその日からずっと可能でした。それでも本当のところそれで幸せになった人は誰一人いません。それで新しいインポートフックを書くのが難しくてとっ散らかっていたからです。 <code class="xref py py-mod docutils literal"><span class="pre">imputil</span></code> と <code class="xref py py-mod docutils literal"><span class="pre">iu</span></code> モジュール のような代わりとなる色々な提案がありましたが、そのいずれも多くの賛同を得ることが出来たものはありませんし、そのいずれもが簡単に C コードから使うことが出来ませんでした。</p>
<p><span class="target" id="index-62"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0302"><strong>PEP 302</strong></a> はその先駆者、特に Gordon McMillan の <code class="xref py py-mod docutils literal"><span class="pre">iu</span></code> モジュールからアイディアを借りています。3 つの新たなアイテムが <a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal"><span class="pre">sys</span></code></a> モジュールに追加されています:</p>
<ul class="simple">
<li><p class="first"><code class="docutils literal"><span class="pre">sys.path_hooks</span></code> は呼び出し可能オブジェクトのリストです。ほとんどの場合クラスになるでしょう。それぞれの呼び出し可能オブジェクトは、パスを含む文字列を受け取って、このパスからインポートを処理するインポーターオブジェクトを返すか、このパスを処理出来なければ <a class="reference internal" href="../library/exceptions.html#ImportError" title="ImportError"><code class="xref py py-exc docutils literal"><span class="pre">ImportError</span></code></a> を送出します。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">sys.path_importer_cache</span></code> はそれぞれのパスごとのインポーターオブジェクトをキャッシュしますので、 <code class="docutils literal"><span class="pre">sys.path_hooks</span></code> は個々のパスを一回だけ横断すれば良いことになります。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">sys.meta_path</span></code> は <code class="docutils literal"><span class="pre">sys.path</span></code> がチェックされる前に横断させるインポーターオブジェクトのリストです(訳注: ここだけ読むとわかりにくいですがライブラリリファレンスを読めばわかります)。このリストは初期状態で空ですが、ユーザコードがオブジェクトをそれに追加出来ます。追加のビルトインと凍結モジュールを、このリストにオブジェクトを追加することによってインポートさせることが出来ます。</p>
</li>
</ul>
<p>インポーターオブジェクトは一つのメソッド <code class="docutils literal"><span class="pre">find_module(fullname,</span> <span class="pre">path=None)</span></code> を持たなければなりません。 <em>fullname</em> はモジュールかパッケージの名前です。例えば <code class="docutils literal"><span class="pre">string</span></code> や <code class="docutils literal"><span class="pre">distutils.core</span></code> です。 <code class="xref py py-meth docutils literal"><span class="pre">find_module()</span></code> メソッドは一つのメソッド <code class="docutils literal"><span class="pre">load_module(fullname)</span></code> を持つローダーオブジェクトを返さなければなりません。 <code class="docutils literal"><span class="pre">load_module(fullname)</span></code> では対応するモジュールオブジェクトを生成して返します。</p>
<p>Python の新しいインポートのロジックは、なので、擬似コードで示すとだいたいこんな感じです (少し単純化しています; 完全な詳細は <span class="target" id="index-63"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0302"><strong>PEP 302</strong></a> 参照):</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">for</span> <span class="n">mp</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">meta_path</span><span class="p">:</span>
    <span class="n">loader</span> <span class="o">=</span> <span class="n">mp</span><span class="p">(</span><span class="n">fullname</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">loader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="k">None</span><span class="p">:</span>
        <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="n">fullname</span><span class="p">)</span>

<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path_hooks</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">importer</span> <span class="o">=</span> <span class="n">hook</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c"># ImportError, so try the other path hooks</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loader</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="n">fullname</span><span class="p">)</span>
            <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="n">fullname</span><span class="p">)</span>

<span class="c"># Not found!</span>
<span class="k">raise</span> <span class="ne">ImportError</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-64"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0302"><strong>PEP 302</strong></a> - 新たなインポートフック</dt>
<dd><p class="first last">Just van Rossum、Paul Moore 著、実装 Just van Rossum。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-305-comma-separated-files">
<span id="section-pep305"></span><h2>PEP 305: Comma-separated Files<a class="headerlink" href="#pep-305-comma-separated-files" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Comma-separated files are a format frequently used for exporting data from
databases and spreadsheets.  Python 2.3 adds a parser for comma-separated files.</p>
<p>Comma-separated format is deceptively simple at first glance:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">Costs</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mf">3.95</span>
</pre></div>
</div>
<p>Read a line and call <code class="docutils literal"><span class="pre">line.split(',')</span></code>: what could be simpler? But toss in
string data that can contain commas, and things get more complicated:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="s">&quot;Costs&quot;</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mf">3.95</span><span class="p">,</span><span class="s">&quot;Includes taxes, shipping, and sundry items&quot;</span>
</pre></div>
</div>
<p>A big ugly regular expression can parse this, but using the new  <a class="reference internal" href="../library/csv.html#module-csv" title="csv: Write and read tabular data to and from delimited files."><code class="xref py py-mod docutils literal"><span class="pre">csv</span></code></a>
package is much simpler:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>

<span class="nb">input</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;datafile&#39;</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">line</span>
</pre></div>
</div>
<p>The <code class="xref py py-func docutils literal"><span class="pre">reader()</span></code> function takes a number of different options. The field
separator isn&#8217;t limited to the comma and can be changed to any character, and so
can the quoting and line-ending characters.</p>
<p>Different dialects of comma-separated files can be defined and registered;
currently there are two dialects, both used by Microsoft Excel. A separate
<a class="reference internal" href="../library/csv.html#csv.writer" title="csv.writer"><code class="xref py py-class docutils literal"><span class="pre">csv.writer</span></code></a> class will generate comma-separated files from a succession
of tuples or lists, quoting strings that contain the delimiter.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-20"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0305"><strong>PEP 305</strong></a> - CSV File API</dt>
<dd>Written and implemented  by Kevin Altis, Dave Cole, Andrew McNamara, Skip
Montanaro, Cliff Wells.</dd>
</dl>
</div>
</div>
<div class="section" id="pep-307-pickle-enhancements">
<span id="section-pep307"></span><h2>PEP 307: Pickle の機能拡張<a class="headerlink" href="#pep-307-pickle-enhancements" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The <a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal"><span class="pre">pickle</span></code></a> and <code class="xref py py-mod docutils literal"><span class="pre">cPickle</span></code> modules received some attention during the
2.3 development cycle.  In 2.2, new-style classes could be pickled without
difficulty, but they weren&#8217;t pickled very compactly; <span class="target" id="index-21"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0307"><strong>PEP 307</strong></a> quotes a trivial
example where a new-style class results in a pickled string three times longer
than that for a classic class.</p>
<p>The solution was to invent a new pickle protocol.  The <a class="reference internal" href="../library/pickle.html#pickle.dumps" title="pickle.dumps"><code class="xref py py-func docutils literal"><span class="pre">pickle.dumps()</span></code></a>
function has supported a text-or-binary flag  for a long time.  In 2.3, this
flag is redefined from a Boolean to an integer: 0 is the old text-mode pickle
format, 1 is the old binary format, and now 2 is a new 2.3-specific format.  A
new constant, <a class="reference internal" href="../library/pickle.html#pickle.HIGHEST_PROTOCOL" title="pickle.HIGHEST_PROTOCOL"><code class="xref py py-const docutils literal"><span class="pre">pickle.HIGHEST_PROTOCOL</span></code></a>, can be used to select the
fanciest protocol available.</p>
<p>Unpickling is no longer considered a safe operation.  2.2&#8217;s <a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal"><span class="pre">pickle</span></code></a>
provided hooks for trying to prevent unsafe classes from being unpickled
(specifically, a <code class="xref py py-attr docutils literal"><span class="pre">__safe_for_unpickling__</span></code> attribute), but none of this
code was ever audited and therefore it&#8217;s all been ripped out in 2.3.  You should
not unpickle untrusted data in any version of Python.</p>
<p>To reduce the pickling overhead for new-style classes, a new interface for
customizing pickling was added using three special methods:
<a class="reference internal" href="../library/pickle.html#object.__getstate__" title="object.__getstate__"><code class="xref py py-meth docutils literal"><span class="pre">__getstate__()</span></code></a>, <a class="reference internal" href="../library/pickle.html#object.__setstate__" title="object.__setstate__"><code class="xref py py-meth docutils literal"><span class="pre">__setstate__()</span></code></a>, and <a class="reference internal" href="../library/pickle.html#object.__getnewargs__" title="object.__getnewargs__"><code class="xref py py-meth docutils literal"><span class="pre">__getnewargs__()</span></code></a>.  Consult
<span class="target" id="index-22"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0307"><strong>PEP 307</strong></a> for the full semantics  of these methods.</p>
<p>As a way to compress pickles yet further, it&#8217;s now possible to use integer codes
instead of long strings to identify pickled classes. The Python Software
Foundation will maintain a list of standardized codes; there&#8217;s also a range of
codes for private use.  Currently no codes have been specified.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-65"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0307"><strong>PEP 307</strong></a> - pickle プロトコルの拡張</dt>
<dd><p class="first last">著、実装: Guido van Rossum と Tim Peters</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="extended-slices">
<span id="section-slices"></span><h2>拡張スライス<a class="headerlink" href="#extended-slices" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python 1.4 以来ずっと、スライシングの構文は省略可能な 3 つ目の引数 &#8220;step&#8221; またの名を &#8220;stride&#8221; 、をサポートしていたのです。例えばこれらは全て合法な Python 構文です: <code class="docutils literal"><span class="pre">L[1:10:2]</span></code>, <code class="docutils literal"><span class="pre">L[:-1:1]</span></code>, <code class="docutils literal"><span class="pre">L[::-1]</span></code> 。これはこの 3 つ目の引数を大々的に使う Numerical Python 開発者によって要望されたことで Python に追加されたものですが、Python ビルトインのリスト、タプル、文字列といったシーケンス型がこの機能をサポートすることはなく、これを試みると <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code></a> を起こしていました。Michael Hudson がこの不徹底を修正するパッチを寄稿しました。</p>
<p>例えば、今やリストの偶数番目要素を簡単に取り出せます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[0, 2, 4, 6, 8]</span>
</pre></div>
</div>
<p>負の値では、同じリストの逆順コピーを作るように動作します:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]</span>
</pre></div>
</div>
<p>これはタプル、配列、文字列に対しても使えます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="s">&#39;abcd&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&#39;ac&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&#39;dcba&#39;</span>
</pre></div>
</div>
<p>リストや配列のような <a class="reference internal" href="../glossary.html#term-mutable"><span class="xref std std-term">mutable</span></a> なシーケンスに対して、拡張スライスを代入や削除に使えますが、拡張スライスと普通のスライスではいくつかの違いがあります。普通のスライスで代入を行えば、シーケンスの長さを変更出来ます (&#8212;訳注: 念のため。Python 3 の range は list を直接返す関数ではなくジェネレータなので、以下例は <code class="docutils literal"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">list(range(3))</span></code> などとしないと動作しません。続く例でも同じです。&#8212;):</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">[0, 1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">[0, 4, 5, 6]</span>
</pre></div>
</div>
<p>拡張スライスにはこの柔軟性はありません。拡張スライスを代入に使う際は、ステートメントの右辺のリストは、置換されるスライスとしての要素数と同数でなければなりません:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[0, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">[0, 1, -1, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
<span class="gr">ValueError</span>: <span class="n">attempt to assign sequence of size 3 to extended slice of size 2</span>
</pre></div>
</div>
<p>削除はもっと素直です:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[0, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">[1, 3]</span>
</pre></div>
</div>
<p>ビルトインのシーケンスの <a class="reference internal" href="../reference/datamodel.html#object.__getitem__" title="object.__getitem__"><code class="xref py py-meth docutils literal"><span class="pre">__getitem__()</span></code></a> メソッドに slice オブジェクトを渡すことも出来るようになりました:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">[0, 2, 4]</span>
</pre></div>
</div>
<p>あるいは直接 slice オブジェクトを添え字に使えます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="go">[0, 2, 4]</span>
</pre></div>
</div>
<p>拡張スライスをサポートするシーケンスの実装を単純化するために、 slice オブジェクトに <code class="xref py py-meth docutils literal"><span class="pre">indices(length)()</span></code> メソッドが追加されています。これはシーケンスの長さを受け取って、タプル <code class="docutils literal"><span class="pre">(start,</span> <span class="pre">stop,</span> <span class="pre">step)</span></code> を返すことで直接 <a class="reference internal" href="../library/stdtypes.html#range" title="range"><code class="xref py py-func docutils literal"><span class="pre">range()</span></code></a> に渡せるようにしています。 <code class="xref py py-meth docutils literal"><span class="pre">indices()</span></code> は範囲外のインデクスを、標準のスライスと一貫した方法で処理します (そしてこの当たり障りのない言い回しは、ややこしい詳細の荒波を隠しているのですよ…!) このメソッドはこうやって使うのを意図したものです:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FakeSeq</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">calc_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="o">...</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">FakeSeq</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">indices</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>ところでこの例からは、ビルトインの <a class="reference internal" href="../library/functions.html#slice" title="slice"><code class="xref py py-class docutils literal"><span class="pre">slice</span></code></a> オブジェクトが今では slice 型という型オブジェクトで、もう関数ではないことがわかるでしょう。これは、Python 2.2 で <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>, <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> などに対して行われた同じ目的の修正と一貫しています。</p>
</div>
<div class="section" id="other-language-changes">
<h2>その他の言語の変更<a class="headerlink" href="#other-language-changes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>以下が、Python 2.3 言語コアに加えられた全ての変更点です。</p>
<ul>
<li><p class="first"><a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal"><span class="pre">yield</span></code></a> がこのドキュメントの <a class="reference internal" href="#section-generators"><span>PEP 255: 単純なジェネレータ</span></a> で述べた通り、キーワードになっています。</p>
</li>
<li><p class="first">新たなビルトイン関数 <a class="reference internal" href="../library/functions.html#enumerate" title="enumerate"><code class="xref py py-func docutils literal"><span class="pre">enumerate()</span></code></a> が追加されました。このドキュメントの <a class="reference internal" href="#section-enumerate"><span>PEP 279: enumerate()</span></a> で述べた通りです。</p>
</li>
<li><p class="first">Two new constants, <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> and <a class="reference internal" href="../library/constants.html#False" title="False"><code class="xref py py-const docutils literal"><span class="pre">False</span></code></a> were added along with the
built-in <a class="reference internal" href="../library/functions.html#bool" title="bool"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> type, as described in section <a class="reference internal" href="#section-bool"><span>PEP 285: Boolean 型</span></a> of this
document.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-func docutils literal"><span class="pre">int()</span></code></a> type constructor will now return a long integer instead of
raising an <a class="reference internal" href="../library/exceptions.html#OverflowError" title="OverflowError"><code class="xref py py-exc docutils literal"><span class="pre">OverflowError</span></code></a> when a string or floating-point number is too
large to fit into an integer.  This can lead to the paradoxical result that
<code class="docutils literal"><span class="pre">isinstance(int(expression),</span> <span class="pre">int)</span></code> is false, but that seems unlikely to cause
problems in practice.</p>
</li>
<li><p class="first">Built-in types now support the extended slicing syntax, as described in
section <a class="reference internal" href="#section-slices"><span>拡張スライス</span></a> of this document.</p>
</li>
<li><p class="first">A new built-in function, <code class="docutils literal"><span class="pre">sum(iterable,</span> <span class="pre">start=0)</span></code>,  adds up the numeric
items in the iterable object and returns their sum.  <a class="reference internal" href="../library/functions.html#sum" title="sum"><code class="xref py py-func docutils literal"><span class="pre">sum()</span></code></a> only accepts
numbers, meaning that you can&#8217;t use it to concatenate a bunch of strings.
(Contributed by Alex Martelli.)</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">list.insert(pos,</span> <span class="pre">value)</span></code> used to  insert <em>value</em> at the front of the list
when <em>pos</em> was negative.  The behaviour has now been changed to be consistent
with slice indexing, so when <em>pos</em> is -1 the value will be inserted before the
last element, and so forth.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">list.index(value)</span></code>, which searches for <em>value</em>  within the list and returns
its index, now takes optional  <em>start</em> and <em>stop</em> arguments to limit the search
to  only part of the list.</p>
</li>
<li><p class="first">Dictionaries have a new method, <code class="docutils literal"><span class="pre">pop(key[,</span> <span class="pre">*default*])</span></code>, that returns
the value corresponding to <em>key</em> and removes that key/value pair from the
dictionary.  If the requested key isn&#8217;t present in the dictionary, <em>default</em> is
returned if it&#8217;s specified and <a class="reference internal" href="../library/exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> raised if it isn&#8217;t.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">{1: 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;stdin&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
<span class="gr">KeyError</span>: <span class="n">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;stdin&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
<span class="gr">KeyError</span>: <span class="n">&#39;pop(): dictionary is empty&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">{}</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>There&#8217;s also a new class method,  <code class="docutils literal"><span class="pre">dict.fromkeys(iterable,</span> <span class="pre">value)</span></code>, that
creates a dictionary with keys taken from the supplied iterator <em>iterable</em> and
all values set to <em>value</em>, defaulting to <code class="docutils literal"><span class="pre">None</span></code>.</p>
<p>(Patches contributed by Raymond Hettinger.)</p>
<p>Also, the <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-func docutils literal"><span class="pre">dict()</span></code></a> constructor now accepts keyword arguments to simplify
creating small dictionaries:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">dict</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">black</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">{&#39;blue&#39;: 2, &#39;black&#39;: 4, &#39;green&#39;: 3, &#39;red&#39;: 1}</span>
</pre></div>
</div>
<p>(Contributed by Just van Rossum.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../reference/simple_stmts.html#assert"><code class="xref std std-keyword docutils literal"><span class="pre">assert</span></code></a> statement no longer checks the <code class="docutils literal"><span class="pre">__debug__</span></code> flag, so
you can no longer disable assertions by assigning to <code class="docutils literal"><span class="pre">__debug__</span></code>. Running
Python with the <a class="reference internal" href="../using/cmdline.html#cmdoption-O"><code class="xref std std-option docutils literal"><span class="pre">-O</span></code></a> switch will still generate code that doesn&#8217;t
execute any assertions.</p>
</li>
<li><p class="first">Most type objects are now callable, so you can use them to create new objects
such as functions, classes, and modules.  (This means that the <code class="xref py py-mod docutils literal"><span class="pre">new</span></code> module
can be deprecated in a future Python version, because you can now use the type
objects available in the <a class="reference internal" href="../library/types.html#module-types" title="types: Names for built-in types."><code class="xref py py-mod docutils literal"><span class="pre">types</span></code></a> module.) For example, you can create a new
module object with the following code:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span><span class="s">&#39;docstring&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span>
<span class="go">&lt;module &#39;abc&#39; (built-in)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">__doc__</span>
<span class="go">&#39;docstring&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">A new warning, <a class="reference internal" href="../library/exceptions.html#PendingDeprecationWarning" title="PendingDeprecationWarning"><code class="xref py py-exc docutils literal"><span class="pre">PendingDeprecationWarning</span></code></a> was added to indicate features
which are in the process of being deprecated.  The warning will <em>not</em> be printed
by default.  To check for use of features that will be deprecated in the future,
supply <code class="xref std std-option docutils literal"><span class="pre">-Walways::PendingDeprecationWarning::</span></code> on the command line or
use <a class="reference internal" href="../library/warnings.html#warnings.filterwarnings" title="warnings.filterwarnings"><code class="xref py py-func docutils literal"><span class="pre">warnings.filterwarnings()</span></code></a>.</p>
</li>
<li><p class="first">The process of deprecating string-based exceptions, as in <code class="docutils literal"><span class="pre">raise</span> <span class="pre">&quot;Error</span>
<span class="pre">occurred&quot;</span></code>, has begun.  Raising a string will now trigger
<a class="reference internal" href="../library/exceptions.html#PendingDeprecationWarning" title="PendingDeprecationWarning"><code class="xref py py-exc docutils literal"><span class="pre">PendingDeprecationWarning</span></code></a>.</p>
</li>
<li><p class="first">Using <code class="docutils literal"><span class="pre">None</span></code> as a variable name will now result in a <a class="reference internal" href="../library/exceptions.html#SyntaxWarning" title="SyntaxWarning"><code class="xref py py-exc docutils literal"><span class="pre">SyntaxWarning</span></code></a>
warning.  In a future version of Python, <code class="docutils literal"><span class="pre">None</span></code> may finally become a keyword.</p>
</li>
<li><p class="first">The <code class="xref py py-meth docutils literal"><span class="pre">xreadlines()</span></code> method of file objects, introduced in Python 2.1, is no
longer necessary because files now behave as their own iterator.
<code class="xref py py-meth docutils literal"><span class="pre">xreadlines()</span></code> was originally introduced as a faster way to loop over all
the lines in a file, but now you can simply write <code class="docutils literal"><span class="pre">for</span> <span class="pre">line</span> <span class="pre">in</span> <span class="pre">file_obj</span></code>.
File objects also have a new read-only <code class="xref py py-attr docutils literal"><span class="pre">encoding</span></code> attribute that gives the
encoding used by the file; Unicode strings written to the file will be
automatically  converted to bytes using the given encoding.</p>
</li>
<li><p class="first">The method resolution order used by new-style classes has changed, though
you&#8217;ll only notice the difference if you have a really complicated inheritance
hierarchy.  Classic classes are unaffected by this change.  Python 2.2
originally used a topological sort of a class&#8217;s ancestors, but 2.3 now uses the
C3 algorithm as described in the paper <a class="reference external" href="http://www.webcom.com/haahr/dylan/linearization-oopsla96.html">&#8220;A Monotonic Superclass Linearization
for Dylan&#8221;</a>. To
understand the motivation for this change,  read Michele Simionato&#8217;s article
<a class="reference external" href="https://www.python.org/2.3/mro.html">&#8220;Python 2.3 Method Resolution Order&#8221;</a>, or
read the thread on python-dev starting with the message at
<a class="reference external" href="https://mail.python.org/pipermail/python-dev/2002-October/029035.html">https://mail.python.org/pipermail/python-dev/2002-October/029035.html</a>. Samuele
Pedroni first pointed out the problem and also implemented the fix by coding the
C3 algorithm.</p>
</li>
<li><p class="first">Python runs multithreaded programs by switching between threads after
executing N bytecodes.  The default value for N has been increased from 10 to
100 bytecodes, speeding up single-threaded applications by reducing the
switching overhead.  Some multithreaded applications may suffer slower response
time, but that&#8217;s easily fixed by setting the limit back to a lower number using
<code class="docutils literal"><span class="pre">sys.setcheckinterval(N)</span></code>. The limit can be retrieved with the new
<a class="reference internal" href="../library/sys.html#sys.getcheckinterval" title="sys.getcheckinterval"><code class="xref py py-func docutils literal"><span class="pre">sys.getcheckinterval()</span></code></a> function.</p>
</li>
<li><p class="first">One minor but far-reaching change is that the names of extension types defined
by the modules included with Python now contain the module and a <code class="docutils literal"><span class="pre">'.'</span></code> in
front of the type name.  For example, in Python 2.2, if you created a socket and
printed its <code class="xref py py-attr docutils literal"><span class="pre">__class__</span></code>, you&#8217;d get this output:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">__class__</span>
<span class="go">&lt;type &#39;socket&#39;&gt;</span>
</pre></div>
</div>
<p>In 2.3, you get this:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">__class__</span>
<span class="go">&lt;type &#39;_socket.socket&#39;&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">One of the noted incompatibilities between old- and new-style classes has been
removed: you can now assign to the <a class="reference internal" href="../reference/import.html#__name__" title="__name__"><code class="xref py py-attr docutils literal"><span class="pre">__name__</span></code></a> and <code class="xref py py-attr docutils literal"><span class="pre">__bases__</span></code>
attributes of new-style classes.  There are some restrictions on what can be
assigned to <code class="xref py py-attr docutils literal"><span class="pre">__bases__</span></code> along the lines of those relating to assigning to
an instance&#8217;s <code class="xref py py-attr docutils literal"><span class="pre">__class__</span></code> attribute.</p>
</li>
</ul>
<div class="section" id="string-changes">
<h3>String Changes<a class="headerlink" href="#string-changes" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul>
<li><p class="first">The <a class="reference internal" href="../reference/expressions.html#in"><code class="xref std std-keyword docutils literal"><span class="pre">in</span></code></a> operator now works differently for strings. Previously, when
evaluating <code class="docutils literal"><span class="pre">X</span> <span class="pre">in</span> <span class="pre">Y</span></code> where <em>X</em> and <em>Y</em> are strings, <em>X</em> could only be a single
character. That&#8217;s now changed; <em>X</em> can be a string of any length, and <code class="docutils literal"><span class="pre">X</span> <span class="pre">in</span> <span class="pre">Y</span></code>
will return <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> if <em>X</em> is a substring of <em>Y</em>.  If <em>X</em> is the empty
string, the result is always <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a>.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;ab&#39;</span> <span class="ow">in</span> <span class="s">&#39;abcd&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;ad&#39;</span> <span class="ow">in</span> <span class="s">&#39;abcd&#39;</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;&#39;</span> <span class="ow">in</span> <span class="s">&#39;abcd&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that this doesn&#8217;t tell you where the substring starts; if you need that
information, use the <code class="xref py py-meth docutils literal"><span class="pre">find()</span></code> string method.</p>
</li>
<li><p class="first">The <code class="xref py py-meth docutils literal"><span class="pre">strip()</span></code>, <code class="xref py py-meth docutils literal"><span class="pre">lstrip()</span></code>, and <code class="xref py py-meth docutils literal"><span class="pre">rstrip()</span></code> string methods now have
an optional argument for specifying the characters to strip.  The default is
still to remove all whitespace characters:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;   abc &#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="go">&#39;abc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;&gt;&lt;&gt;&lt;abc&lt;&gt;&lt;&gt;&lt;&gt;&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;&lt;&gt;&#39;</span><span class="p">)</span>
<span class="go">&#39;abc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;&gt;&lt;&gt;&lt;abc&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;&lt;&gt;&#39;</span><span class="p">)</span>
<span class="go">&#39;abc&lt;&gt;&lt;&gt;&lt;&gt;\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">u&#39;</span><span class="se">\u4000\u4001</span><span class="s">abc</span><span class="se">\u4000</span><span class="s">&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\u4000</span><span class="s">&#39;</span><span class="p">)</span>
<span class="go">u&#39;\u4001abc&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>(Suggested by Simon Brunning and implemented by Walter Dörwald.)</p>
</li>
<li><p class="first">The <code class="xref py py-meth docutils literal"><span class="pre">startswith()</span></code> and <code class="xref py py-meth docutils literal"><span class="pre">endswith()</span></code> string methods now accept negative
numbers for the <em>start</em> and <em>end</em> parameters.</p>
</li>
<li><p class="first">Another new string method is <code class="xref py py-meth docutils literal"><span class="pre">zfill()</span></code>, originally a function in the
<a class="reference internal" href="../library/string.html#module-string" title="string: Common string operations."><code class="xref py py-mod docutils literal"><span class="pre">string</span></code></a> module.  <code class="xref py py-meth docutils literal"><span class="pre">zfill()</span></code> pads a numeric string with zeros on the
left until it&#8217;s the specified width. Note that the <code class="docutils literal"><span class="pre">%</span></code> operator is still more
flexible and powerful than <code class="xref py py-meth docutils literal"><span class="pre">zfill()</span></code>.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;45&#39;</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;0045&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;12345&#39;</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;12345&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;goofy&#39;</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">&#39;0goofy&#39;</span>
</pre></div>
</div>
<p>(Contributed by Walter Dörwald.)</p>
</li>
<li><p class="first">A new type object, <code class="xref py py-class docutils literal"><span class="pre">basestring</span></code>, has been added. Both 8-bit strings and
Unicode strings inherit from this type, so <code class="docutils literal"><span class="pre">isinstance(obj,</span> <span class="pre">basestring)</span></code> will
return <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> for either kind of string.  It&#8217;s a completely abstract
type, so you can&#8217;t create <code class="xref py py-class docutils literal"><span class="pre">basestring</span></code> instances.</p>
</li>
<li><p class="first">Interned strings are no longer immortal and will now be garbage-collected in
the usual way when the only reference to them is from the internal dictionary of
interned strings.  (Implemented by Oren Tirosh.)</p>
</li>
</ul>
</div>
<div class="section" id="optimizations">
<h3>最適化<a class="headerlink" href="#optimizations" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>The creation of new-style class instances has been made much faster; they&#8217;re
now faster than classic classes!</li>
<li>The <code class="xref py py-meth docutils literal"><span class="pre">sort()</span></code> method of list objects has been extensively rewritten by Tim
Peters, and the implementation is significantly faster.</li>
<li>Multiplication of large long integers is now much faster thanks to an
implementation of Karatsuba multiplication, an algorithm that scales better than
the O(n*n) required for the grade-school multiplication algorithm.  (Original
patch by Christopher A. Craig, and significantly reworked by Tim Peters.)</li>
<li>The <code class="docutils literal"><span class="pre">SET_LINENO</span></code> opcode is now gone.  This may provide a small speed
increase, depending on your compiler&#8217;s idiosyncrasies. See section
<a class="reference internal" href="#section-other"><span>その他の変更と修正</span></a> for a longer explanation. (Removed by Michael Hudson.)</li>
<li><code class="xref py py-func docutils literal"><span class="pre">xrange()</span></code> objects now have their own iterator, making <code class="docutils literal"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span>
<span class="pre">xrange(n)</span></code> slightly faster than <code class="docutils literal"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(n)</span></code>.  (Patch by Raymond
Hettinger.)</li>
<li>A number of small rearrangements have been made in various hotspots to improve
performance, such as inlining a function or removing some code.  (Implemented
mostly by GvR, but lots of people have contributed single changes.)</li>
</ul>
<p>The net result of the 2.3 optimizations is that Python 2.3 runs the  pystone
benchmark around 25% faster than Python 2.2.</p>
</div>
</div>
<div class="section" id="new-improved-and-deprecated-modules">
<h2>新たなモジュール、改良されたモジュール、非推奨のモジュール<a class="headerlink" href="#new-improved-and-deprecated-modules" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>As usual, Python&#8217;s standard library received a number of enhancements and bug
fixes.  Here&#8217;s a partial list of the most notable changes, sorted alphabetically
by module name. Consult the <code class="file docutils literal"><span class="pre">Misc/NEWS</span></code> file in the source tree for a more
complete list of changes, or look through the CVS logs for all the details.</p>
<ul>
<li><p class="first">The <a class="reference internal" href="../library/array.html#module-array" title="array: Space efficient arrays of uniformly typed numeric values."><code class="xref py py-mod docutils literal"><span class="pre">array</span></code></a> module now supports arrays of Unicode characters using the
<code class="docutils literal"><span class="pre">'u'</span></code> format character.  Arrays also now support using the <code class="docutils literal"><span class="pre">+=</span></code> assignment
operator to add another array&#8217;s contents, and the <code class="docutils literal"><span class="pre">*=</span></code> assignment operator to
repeat an array. (Contributed by Jason Orendorff.)</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">bsddb</span></code> module has been replaced by version 4.1.6 of the <a class="reference external" href="http://pybsddb.sourceforge.net">PyBSDDB</a> package, providing a more complete interface
to the transactional features of the BerkeleyDB library.</p>
<p>The old version of the module has been renamed to  <code class="xref py py-mod docutils literal"><span class="pre">bsddb185</span></code> and is no
longer built automatically; you&#8217;ll  have to edit <code class="file docutils literal"><span class="pre">Modules/Setup</span></code> to enable
it.  Note that the new <code class="xref py py-mod docutils literal"><span class="pre">bsddb</span></code> package is intended to be compatible with
the  old module, so be sure to file bugs if you discover any incompatibilities.
When upgrading to Python 2.3, if the new interpreter is compiled with a new
version of  the underlying BerkeleyDB library, you will almost certainly have to
convert your database files to the new version.  You can do this fairly easily
with the new scripts <code class="file docutils literal"><span class="pre">db2pickle.py</span></code> and <code class="file docutils literal"><span class="pre">pickle2db.py</span></code> which you
will find in the distribution&#8217;s <code class="file docutils literal"><span class="pre">Tools/scripts</span></code> directory.  If you&#8217;ve
already been using the PyBSDDB package and importing it as <code class="xref py py-mod docutils literal"><span class="pre">bsddb3</span></code>, you
will have to change your <code class="docutils literal"><span class="pre">import</span></code> statements to import it as <code class="xref py py-mod docutils literal"><span class="pre">bsddb</span></code>.</p>
</li>
<li><p class="first">The new <a class="reference internal" href="../library/bz2.html#module-bz2" title="bz2: Interfaces for bzip2 compression and decompression."><code class="xref py py-mod docutils literal"><span class="pre">bz2</span></code></a> module is an interface to the bz2 data compression library.
bz2-compressed data is usually smaller than  corresponding <a class="reference internal" href="../library/zlib.html#module-zlib" title="zlib: Low-level interface to compression and decompression routines compatible with gzip."><code class="xref py py-mod docutils literal"><span class="pre">zlib</span></code></a>-compressed data. (Contributed by Gustavo Niemeyer.)</p>
</li>
<li><p class="first">A set of standard date/time types has been added in the new <a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-mod docutils literal"><span class="pre">datetime</span></code></a>
module.  See the following section for more details.</p>
</li>
<li><p class="first">The Distutils <code class="xref py py-class docutils literal"><span class="pre">Extension</span></code> class now supports an extra constructor
argument named <em>depends</em> for listing additional source files that an extension
depends on.  This lets Distutils recompile the module if any of the dependency
files are modified.  For example, if <code class="file docutils literal"><span class="pre">sampmodule.c</span></code> includes the header
file <code class="file docutils literal"><span class="pre">sample.h</span></code>, you would create the <code class="xref py py-class docutils literal"><span class="pre">Extension</span></code> object like
this:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">ext</span> <span class="o">=</span> <span class="n">Extension</span><span class="p">(</span><span class="s">&quot;samp&quot;</span><span class="p">,</span>
                <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;sampmodule.c&quot;</span><span class="p">],</span>
                <span class="n">depends</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;sample.h&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Modifying <code class="file docutils literal"><span class="pre">sample.h</span></code> would then cause the module to be recompiled.
(Contributed by Jeremy Hylton.)</p>
</li>
<li><p class="first">Other minor changes to Distutils: it now checks for the <span class="target" id="index-24"></span><code class="xref std std-envvar docutils literal"><span class="pre">CC</span></code>,
<span class="target" id="index-25"></span><code class="xref std std-envvar docutils literal"><span class="pre">CFLAGS</span></code>, <span class="target" id="index-26"></span><code class="xref std std-envvar docutils literal"><span class="pre">CPP</span></code>, <span class="target" id="index-27"></span><code class="xref std std-envvar docutils literal"><span class="pre">LDFLAGS</span></code>, and <span class="target" id="index-28"></span><code class="xref std std-envvar docutils literal"><span class="pre">CPPFLAGS</span></code>
environment variables, using them to override the settings in Python&#8217;s
configuration (contributed by Robert Weber).</p>
</li>
<li><p class="first">Previously the <a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal"><span class="pre">doctest</span></code></a> module would only search the docstrings of
public methods and functions for test cases, but it now also examines private
ones as well.  The <code class="xref py py-func docutils literal"><span class="pre">DocTestSuite()</span></code> function creates a
<a class="reference internal" href="../library/unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal"><span class="pre">unittest.TestSuite</span></code></a> object from a set of <a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal"><span class="pre">doctest</span></code></a> tests.</p>
</li>
<li><p class="first">The new <code class="docutils literal"><span class="pre">gc.get_referents(object)</span></code> function returns a list of all the
objects referenced by <em>object</em>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/getopt.html#module-getopt" title="getopt: Portable parser for command line options; support both short and long option names."><code class="xref py py-mod docutils literal"><span class="pre">getopt</span></code></a> module gained a new function, <code class="xref py py-func docutils literal"><span class="pre">gnu_getopt()</span></code>, that
supports the same arguments as the existing <a class="reference internal" href="../library/getopt.html#module-getopt" title="getopt: Portable parser for command line options; support both short and long option names."><code class="xref py py-func docutils literal"><span class="pre">getopt()</span></code></a> function but uses
GNU-style scanning mode. The existing <a class="reference internal" href="../library/getopt.html#module-getopt" title="getopt: Portable parser for command line options; support both short and long option names."><code class="xref py py-func docutils literal"><span class="pre">getopt()</span></code></a> stops processing options as
soon as a non-option argument is encountered, but in GNU-style mode processing
continues, meaning that options and arguments can be mixed.  For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">getopt</span><span class="o">.</span><span class="n">getopt</span><span class="p">([</span><span class="s">&#39;-f&#39;</span><span class="p">,</span> <span class="s">&#39;filename&#39;</span><span class="p">,</span> <span class="s">&#39;output&#39;</span><span class="p">,</span> <span class="s">&#39;-v&#39;</span><span class="p">],</span> <span class="s">&#39;f:v&#39;</span><span class="p">)</span>
<span class="go">([(&#39;-f&#39;, &#39;filename&#39;)], [&#39;output&#39;, &#39;-v&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getopt</span><span class="o">.</span><span class="n">gnu_getopt</span><span class="p">([</span><span class="s">&#39;-f&#39;</span><span class="p">,</span> <span class="s">&#39;filename&#39;</span><span class="p">,</span> <span class="s">&#39;output&#39;</span><span class="p">,</span> <span class="s">&#39;-v&#39;</span><span class="p">],</span> <span class="s">&#39;f:v&#39;</span><span class="p">)</span>
<span class="go">([(&#39;-f&#39;, &#39;filename&#39;), (&#39;-v&#39;, &#39;&#39;)], [&#39;output&#39;])</span>
</pre></div>
</div>
<p>(Contributed by Peter Åstrand.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/grp.html#module-grp" title="grp: The group database (getgrnam() and friends). (Unix)"><code class="xref py py-mod docutils literal"><span class="pre">grp</span></code></a>, <a class="reference internal" href="../library/pwd.html#module-pwd" title="pwd: The password database (getpwnam() and friends). (Unix)"><code class="xref py py-mod docutils literal"><span class="pre">pwd</span></code></a>, and <a class="reference internal" href="../library/resource.html#module-resource" title="resource: An interface to provide resource usage information on the current process. (Unix)"><code class="xref py py-mod docutils literal"><span class="pre">resource</span></code></a> modules now return enhanced
tuples:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">grp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">grp</span><span class="o">.</span><span class="n">getgrnam</span><span class="p">(</span><span class="s">&#39;amk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">gr_name</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">gr_gid</span>
<span class="go">(&#39;amk&#39;, 500)</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference internal" href="../library/gzip.html#module-gzip" title="gzip: Interfaces for gzip compression and decompression using file objects."><code class="xref py py-mod docutils literal"><span class="pre">gzip</span></code></a> モジュールが 2 GiB を超えるファイルを扱えるようになっています。</p>
</li>
<li><p class="first">The new <a class="reference internal" href="../library/heapq.html#module-heapq" title="heapq: Heap queue algorithm (a.k.a. priority queue)."><code class="xref py py-mod docutils literal"><span class="pre">heapq</span></code></a> module contains an implementation of a heap queue
algorithm.  A heap is an array-like data structure that keeps items in a
partially sorted order such that, for every index <em>k</em>, <code class="docutils literal"><span class="pre">heap[k]</span> <span class="pre">&lt;=</span>
<span class="pre">heap[2*k+1]</span></code> and <code class="docutils literal"><span class="pre">heap[k]</span> <span class="pre">&lt;=</span> <span class="pre">heap[2*k+2]</span></code>.  This makes it quick to remove the
smallest item, and inserting a new item while maintaining the heap property is
O(lg n).  (See <a class="reference external" href="http://www.nist.gov/dads/HTML/priorityque.html">http://www.nist.gov/dads/HTML/priorityque.html</a> for more
information about the priority queue data structure.)</p>
<p>The <a class="reference internal" href="../library/heapq.html#module-heapq" title="heapq: Heap queue algorithm (a.k.a. priority queue)."><code class="xref py py-mod docutils literal"><span class="pre">heapq</span></code></a> module provides <code class="xref py py-func docutils literal"><span class="pre">heappush()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">heappop()</span></code> functions
for adding and removing items while maintaining the heap property on top of some
other mutable Python sequence type.  Here&#8217;s an example that uses a Python list:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">heapq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">heap</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
<span class="gp">... </span>   <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">heap</span>
<span class="go">[1, 3, 5, 11, 7]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">heap</span>
<span class="go">[5, 7, 11]</span>
</pre></div>
</div>
<p>(Contributed by Kevin O&#8217;Connor.)</p>
</li>
<li><p class="first">The IDLE integrated development environment has been updated using the code
from the IDLEfork project (<a class="reference external" href="http://idlefork.sourceforge.net">http://idlefork.sourceforge.net</a>).  The most notable feature is
that the code being developed is now executed in a subprocess, meaning that
there&#8217;s no longer any need for manual <code class="docutils literal"><span class="pre">reload()</span></code> operations. IDLE&#8217;s core code
has been incorporated into the standard library as the <code class="xref py py-mod docutils literal"><span class="pre">idlelib</span></code> package.</p>
</li>
<li><p class="first"><a class="reference internal" href="../library/imaplib.html#module-imaplib" title="imaplib: IMAP4 protocol client (requires sockets)."><code class="xref py py-mod docutils literal"><span class="pre">imaplib</span></code></a> モジュールが  IMAP over SSL をサポートするようになりました. (Contributed by Piers Lauder and Tino Lange.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/itertools.html#module-itertools" title="itertools: Functions creating iterators for efficient looping."><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a> contains a number of useful functions for use with
iterators, inspired by various functions provided by the ML and Haskell
languages.  For example, <code class="docutils literal"><span class="pre">itertools.ifilter(predicate,</span> <span class="pre">iterator)</span></code> returns all
elements in the iterator for which the function <code class="xref py py-func docutils literal"><span class="pre">predicate()</span></code> returns
<a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a>, and <code class="docutils literal"><span class="pre">itertools.repeat(obj,</span> <span class="pre">N)</span></code> returns <code class="docutils literal"><span class="pre">obj</span></code> <em>N</em> times.
There are a number of other functions in the module; see the package&#8217;s reference
documentation for details.
(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">Two new functions in the <a class="reference internal" href="../library/math.html#module-math" title="math: Mathematical functions (sin() etc.)."><code class="xref py py-mod docutils literal"><span class="pre">math</span></code></a> module, <code class="docutils literal"><span class="pre">degrees(rads)</span></code> and
<code class="docutils literal"><span class="pre">radians(degs)</span></code>, convert between radians and degrees.  Other functions in
the <a class="reference internal" href="../library/math.html#module-math" title="math: Mathematical functions (sin() etc.)."><code class="xref py py-mod docutils literal"><span class="pre">math</span></code></a> module such as <a class="reference internal" href="../library/math.html#math.sin" title="math.sin"><code class="xref py py-func docutils literal"><span class="pre">math.sin()</span></code></a> and <a class="reference internal" href="../library/math.html#math.cos" title="math.cos"><code class="xref py py-func docutils literal"><span class="pre">math.cos()</span></code></a> have always
required input values measured in radians.  Also, an optional <em>base</em> argument
was added to <a class="reference internal" href="../library/math.html#math.log" title="math.log"><code class="xref py py-func docutils literal"><span class="pre">math.log()</span></code></a> to make it easier to compute logarithms for bases
other than <code class="docutils literal"><span class="pre">e</span></code> and <code class="docutils literal"><span class="pre">10</span></code>.  (Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">Several new POSIX functions (<code class="xref py py-func docutils literal"><span class="pre">getpgid()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">killpg()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">lchown()</span></code>,
<code class="xref py py-func docutils literal"><span class="pre">loadavg()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">major()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">makedev()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">minor()</span></code>, and
<code class="xref py py-func docutils literal"><span class="pre">mknod()</span></code>) were added to the <a class="reference internal" href="../library/posix.html#module-posix" title="posix: The most common POSIX system calls (normally used via module os). (Unix)"><code class="xref py py-mod docutils literal"><span class="pre">posix</span></code></a> module that underlies the
<a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal"><span class="pre">os</span></code></a> module. (Contributed by Gustavo Niemeyer, Geert Jansen, and Denis S.
Otkidach.)</p>
</li>
<li><p class="first">In the <a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal"><span class="pre">os</span></code></a> module, the <code class="xref py py-func docutils literal"><span class="pre">*stat()</span></code> family of functions can now report
fractions of a second in a timestamp.  Such time stamps are represented as
floats, similar to the value returned by <a class="reference internal" href="../library/time.html#time.time" title="time.time"><code class="xref py py-func docutils literal"><span class="pre">time.time()</span></code></a>.</p>
<p>During testing, it was found that some applications will break if time stamps
are floats.  For compatibility, when using the tuple interface of the
<code class="xref py py-class docutils literal"><span class="pre">stat_result</span></code> time stamps will be represented as integers. When using
named fields (a feature first introduced in Python 2.2), time stamps are still
represented as integers, unless <a class="reference internal" href="../library/os.html#os.stat_float_times" title="os.stat_float_times"><code class="xref py py-func docutils literal"><span class="pre">os.stat_float_times()</span></code></a> is invoked to enable
float return values:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="s">&quot;/tmp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">st_mtime</span>
<span class="go">1034791200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">stat_float_times</span><span class="p">(</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="s">&quot;/tmp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">st_mtime</span>
<span class="go">1034791200.6335014</span>
</pre></div>
</div>
<p>In Python 2.4, the default will change to always returning floats.</p>
<p>Application developers should enable this feature only if all their libraries
work properly when confronted with floating point time stamps, or if they use
the tuple API. If used, the feature should be activated on an application level
instead of trying to enable it on a per-use basis.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/optparse.html#module-optparse" title="optparse: Command-line option parsing library. (撤廃)"><code class="xref py py-mod docutils literal"><span class="pre">optparse</span></code></a> module contains a new parser for command-line arguments
that can convert option values to a particular Python type  and will
automatically generate a usage message.  See the following section for  more
details.</p>
</li>
<li><p class="first">The old and never-documented <code class="xref py py-mod docutils literal"><span class="pre">linuxaudiodev</span></code> module has been deprecated,
and a new version named <a class="reference internal" href="../library/ossaudiodev.html#module-ossaudiodev" title="ossaudiodev: Access to OSS-compatible audio devices. (Linux, FreeBSD)"><code class="xref py py-mod docutils literal"><span class="pre">ossaudiodev</span></code></a> has been added.  The module was
renamed because the OSS sound drivers can be used on platforms other than Linux,
and the interface has also been tidied and brought up to date in various ways.
(Contributed by Greg Ward and Nicholas FitzRoy-Dale.)</p>
</li>
<li><p class="first">The new <a class="reference internal" href="../library/platform.html#module-platform" title="platform: Retrieves as much platform identifying data as possible."><code class="xref py py-mod docutils literal"><span class="pre">platform</span></code></a> module contains a number of functions that try to
determine various properties of the platform you&#8217;re running on.  There are
functions for getting the architecture, CPU type, the Windows OS version, and
even the Linux distribution version. (Contributed by Marc-André Lemburg.)</p>
</li>
<li><p class="first">The parser objects provided by the <code class="xref py py-mod docutils literal"><span class="pre">pyexpat</span></code> module can now optionally
buffer character data, resulting in fewer calls to your character data handler
and therefore faster performance.  Setting the parser object&#8217;s
<code class="xref py py-attr docutils literal"><span class="pre">buffer_text</span></code> attribute to <a class="reference internal" href="../library/constants.html#True" title="True"><code class="xref py py-const docutils literal"><span class="pre">True</span></code></a> will enable buffering.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">sample(population,</span> <span class="pre">k)</span></code> function was added to the <a class="reference internal" href="../library/random.html#module-random" title="random: Generate pseudo-random numbers with various common distributions."><code class="xref py py-mod docutils literal"><span class="pre">random</span></code></a>
module.  <em>population</em> is a sequence or <code class="xref py py-class docutils literal"><span class="pre">xrange</span></code> object containing the
elements of a population, and <code class="xref py py-func docutils literal"><span class="pre">sample()</span></code> chooses <em>k</em> elements from the
population without replacing chosen elements.  <em>k</em> can be any value up to
<code class="docutils literal"><span class="pre">len(population)</span></code>. For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">days</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Mo&#39;</span><span class="p">,</span> <span class="s">&#39;Tu&#39;</span><span class="p">,</span> <span class="s">&#39;We&#39;</span><span class="p">,</span> <span class="s">&#39;Th&#39;</span><span class="p">,</span> <span class="s">&#39;Fr&#39;</span><span class="p">,</span> <span class="s">&#39;St&#39;</span><span class="p">,</span> <span class="s">&#39;Sn&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>      <span class="c"># Choose 3 elements</span>
<span class="go">[&#39;St&#39;, &#39;Sn&#39;, &#39;Th&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>      <span class="c"># Choose 7 elements</span>
<span class="go">[&#39;Tu&#39;, &#39;Th&#39;, &#39;Mo&#39;, &#39;We&#39;, &#39;St&#39;, &#39;Fr&#39;, &#39;Sn&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>      <span class="c"># Choose 7 again</span>
<span class="go">[&#39;We&#39;, &#39;Mo&#39;, &#39;Sn&#39;, &#39;Fr&#39;, &#39;Tu&#39;, &#39;St&#39;, &#39;Th&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>      <span class="c"># Can&#39;t choose eight</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
  File <span class="nb">&quot;random.py&quot;</span>, line <span class="m">414</span>, in <span class="n">sample</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="s">&quot;sample larger than population&quot;</span>
<span class="gr">ValueError</span>: <span class="n">sample larger than population</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>   <span class="c"># Choose ten odd nos. under 10000</span>
<span class="go">[3407, 3805, 1505, 7023, 2401, 2267, 9733, 3151, 8083, 9195]</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../library/random.html#module-random" title="random: Generate pseudo-random numbers with various common distributions."><code class="xref py py-mod docutils literal"><span class="pre">random</span></code></a> module now uses a new algorithm, the Mersenne Twister,
implemented in C.  It&#8217;s faster and more extensively studied than the previous
algorithm.</p>
<p>(All changes contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/readline.html#module-readline" title="readline: GNU readline support for Python. (Unix)"><code class="xref py py-mod docutils literal"><span class="pre">readline</span></code></a> module also gained a number of new functions:
<code class="xref py py-func docutils literal"><span class="pre">get_history_item()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">get_current_history_length()</span></code>, and
<code class="xref py py-func docutils literal"><span class="pre">redisplay()</span></code>.</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">rexec</span></code> and <code class="xref py py-mod docutils literal"><span class="pre">Bastion</span></code> modules have been declared dead, and
attempts to import them will fail with a <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal"><span class="pre">RuntimeError</span></code></a>.  New-style classes
provide new ways to break out of the restricted execution environment provided
by <code class="xref py py-mod docutils literal"><span class="pre">rexec</span></code>, and no one has interest in fixing them or time to do so.  If
you have applications using <code class="xref py py-mod docutils literal"><span class="pre">rexec</span></code>, rewrite them to use something else.</p>
<p>(Sticking with Python 2.2 or 2.1 will not make your applications any safer
because there are known bugs in the <code class="xref py py-mod docutils literal"><span class="pre">rexec</span></code> module in those versions.  To
repeat: if you&#8217;re using <code class="xref py py-mod docutils literal"><span class="pre">rexec</span></code>, stop using it immediately.)</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">rotor</span></code> module has been deprecated because the  algorithm it uses for
encryption is not believed to be secure.  If you need encryption, use one of the
several AES Python modules that are available separately.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/shutil.html#module-shutil" title="shutil: High-level file operations, including copying."><code class="xref py py-mod docutils literal"><span class="pre">shutil</span></code></a> module gained a <code class="docutils literal"><span class="pre">move(src,</span> <span class="pre">dest)</span></code> function that
recursively moves a file or directory to a new location.</p>
</li>
<li><p class="first">Support for more advanced POSIX signal handling was added to the <a class="reference internal" href="../library/signal.html#module-signal" title="signal: Set handlers for asynchronous events."><code class="xref py py-mod docutils literal"><span class="pre">signal</span></code></a>
but then removed again as it proved impossible to make it work reliably across
platforms.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/socket.html#module-socket" title="socket: Low-level networking interface."><code class="xref py py-mod docutils literal"><span class="pre">socket</span></code></a> module now supports timeouts.  You can call the
<code class="docutils literal"><span class="pre">settimeout(t)</span></code> method on a socket object to set a timeout of <em>t</em> seconds.
Subsequent socket operations that take longer than <em>t</em> seconds to complete will
abort and raise a <a class="reference internal" href="../library/socket.html#socket.timeout" title="socket.timeout"><code class="xref py py-exc docutils literal"><span class="pre">socket.timeout</span></code></a> exception.</p>
<p>The original timeout implementation was by Tim O&#8217;Malley.  Michael Gilfix
integrated it into the Python <a class="reference internal" href="../library/socket.html#module-socket" title="socket: Low-level networking interface."><code class="xref py py-mod docutils literal"><span class="pre">socket</span></code></a> module and shepherded it through a
lengthy review.  After the code was checked in, Guido van Rossum rewrote parts
of it.  (This is a good example of a collaborative development process in
action.)</p>
</li>
<li><p class="first">Windows での <a class="reference internal" href="../library/socket.html#module-socket" title="socket: Low-level networking interface."><code class="xref py py-mod docutils literal"><span class="pre">socket</span></code></a> モジュールの Secure  Sockets Layer (SSL) サポートが始まりました。</p>
</li>
<li><p class="first">The value of the C <code class="xref py py-const docutils literal"><span class="pre">PYTHON_API_VERSION</span></code> macro is now exposed at the
Python level as <code class="docutils literal"><span class="pre">sys.api_version</span></code>.  The current exception can be cleared by
calling the new <code class="xref py py-func docutils literal"><span class="pre">sys.exc_clear()</span></code> function.</p>
</li>
<li><p class="first">The new <a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal"><span class="pre">tarfile</span></code></a> module  allows reading from and writing to
<strong class="program">tar</strong>-format archive files. (Contributed by Lars Gustäbel.)</p>
</li>
<li><p class="first">The new <a class="reference internal" href="../library/textwrap.html#module-textwrap" title="textwrap: Text wrapping and filling"><code class="xref py py-mod docutils literal"><span class="pre">textwrap</span></code></a> module contains functions for wrapping strings
containing paragraphs of text.  The <code class="docutils literal"><span class="pre">wrap(text,</span> <span class="pre">width)</span></code> function takes a
string and returns a list containing the text split into lines of no more than
the chosen width.  The <code class="docutils literal"><span class="pre">fill(text,</span> <span class="pre">width)</span></code> function returns a single
string, reformatted to fit into lines no longer than the chosen width. (As you
can guess, <code class="xref py py-func docutils literal"><span class="pre">fill()</span></code> is built on top of <code class="xref py py-func docutils literal"><span class="pre">wrap()</span></code>.  For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">textwrap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paragraph</span> <span class="o">=</span> <span class="s">&quot;Not a whit, we defy augury: ... more text ...&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">paragraph</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="go">[&quot;Not a whit, we defy augury: there&#39;s a special providence in&quot;,</span>
<span class="go"> &quot;the fall of a sparrow. If it be now, &#39;tis not to come; if it&quot;,</span>
<span class="go"> ...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">paragraph</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
<span class="go">Not a whit, we defy augury: there&#39;s</span>
<span class="go">a special providence in the fall of</span>
<span class="go">a sparrow. If it be now, &#39;tis not</span>
<span class="go">to come; if it be not to come, it</span>
<span class="go">will be now; if it be not now, yet</span>
<span class="go">it will come: the readiness is all.</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>The module also contains a <code class="xref py py-class docutils literal"><span class="pre">TextWrapper</span></code> class that actually implements
the text wrapping strategy.   Both the <code class="xref py py-class docutils literal"><span class="pre">TextWrapper</span></code> class and the
<code class="xref py py-func docutils literal"><span class="pre">wrap()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">fill()</span></code> functions support a number of additional keyword
arguments for fine-tuning the formatting; consult the module&#8217;s documentation
for details. (Contributed by Greg Ward.)</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">thread</span></code> and <a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal"><span class="pre">threading</span></code></a> modules now have companion modules,
<code class="xref py py-mod docutils literal"><span class="pre">dummy_thread</span></code> and <a class="reference internal" href="../library/dummy_threading.html#module-dummy_threading" title="dummy_threading: Drop-in replacement for the threading module."><code class="xref py py-mod docutils literal"><span class="pre">dummy_threading</span></code></a>, that provide a do-nothing
implementation of the <code class="xref py py-mod docutils literal"><span class="pre">thread</span></code> module&#8217;s interface for platforms where
threads are not supported.  The intention is to simplify thread-aware modules
(ones that <em>don&#8217;t</em> rely on threads to run) by putting the following code at the
top:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">threading</span> <span class="k">as</span> <span class="nn">_threading</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dummy_threading</span> <span class="k">as</span> <span class="nn">_threading</span>
</pre></div>
</div>
<p>In this example, <code class="xref py py-mod docutils literal"><span class="pre">_threading</span></code> is used as the module name to make it clear
that the module being used is not necessarily the actual <a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal"><span class="pre">threading</span></code></a>
module. Code can call functions and use classes in <code class="xref py py-mod docutils literal"><span class="pre">_threading</span></code> whether or
not threads are supported, avoiding an <a class="reference internal" href="../reference/compound_stmts.html#if"><code class="xref std std-keyword docutils literal"><span class="pre">if</span></code></a> statement and making the
code slightly clearer.  This module will not magically make multithreaded code
run without threads; code that waits for another thread to return or to do
something will simply hang forever.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/time.html#module-time" title="time: Time access and conversions."><code class="xref py py-mod docutils literal"><span class="pre">time</span></code></a> module&#8217;s <code class="xref py py-func docutils literal"><span class="pre">strptime()</span></code> function has long been an annoyance
because it uses the platform C library&#8217;s <code class="xref py py-func docutils literal"><span class="pre">strptime()</span></code> implementation, and
different platforms sometimes have odd bugs.  Brett Cannon contributed a
portable implementation that&#8217;s written in pure Python and should behave
identically on all platforms.</p>
</li>
<li><p class="first">The new <a class="reference internal" href="../library/timeit.html#module-timeit" title="timeit: Measure the execution time of small code snippets."><code class="xref py py-mod docutils literal"><span class="pre">timeit</span></code></a> module helps measure how long snippets of Python code
take to execute.  The <code class="file docutils literal"><span class="pre">timeit.py</span></code> file can be run directly from the
command line, or the module&#8217;s <code class="xref py py-class docutils literal"><span class="pre">Timer</span></code> class can be imported and used
directly.  Here&#8217;s a short example that figures out whether it&#8217;s faster to
convert an 8-bit string to Unicode by appending an empty Unicode string to it or
by using the <code class="xref py py-func docutils literal"><span class="pre">unicode()</span></code> function:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">timeit</span>

<span class="n">timer1</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s">&#39;unicode(&quot;abc&quot;)&#39;</span><span class="p">)</span>
<span class="n">timer2</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s">&#39;&quot;abc&quot; + u&quot;&quot;&#39;</span><span class="p">)</span>

<span class="c"># Run three trials</span>
<span class="nb">print</span> <span class="n">timer1</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">timer2</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>

<span class="c"># On my laptop this outputs:</span>
<span class="c"># [0.36831796169281006, 0.37441694736480713, 0.35304892063140869]</span>
<span class="c"># [0.17574405670166016, 0.18193507194519043, 0.17565798759460449]</span>
</pre></div>
</div>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">Tix</span></code> module has received various bug fixes and updates for the
current version of the Tix package.</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">Tkinter</span></code> module now works with a thread-enabled  version of Tcl.
Tcl&#8217;s threading model requires that widgets only be accessed from the thread in
which they&#8217;re created; accesses from another thread can cause Tcl to panic.  For
certain Tcl interfaces, <code class="xref py py-mod docutils literal"><span class="pre">Tkinter</span></code> will now automatically avoid this  when a
widget is accessed from a different thread by marshalling a command, passing it
to the correct thread, and waiting for the results.  Other interfaces can&#8217;t be
handled automatically but <code class="xref py py-mod docutils literal"><span class="pre">Tkinter</span></code> will now raise an exception on such an
access so that you can at least find out about the problem.  See
<a class="reference external" href="https://mail.python.org/pipermail/python-dev/2002-December/031107.html">https://mail.python.org/pipermail/python-dev/2002-December/031107.html</a> for a more
detailed explanation of this change.  (Implemented by Martin von Löwis.)</p>
</li>
<li><p class="first">Calling Tcl methods through <code class="xref py py-mod docutils literal"><span class="pre">_tkinter</span></code> no longer  returns only strings.
Instead, if Tcl returns other objects those objects are converted to their
Python equivalent, if one exists, or wrapped with a <code class="xref py py-class docutils literal"><span class="pre">_tkinter.Tcl_Obj</span></code>
object if no Python equivalent exists. This behavior can be controlled through
the <code class="xref py py-meth docutils literal"><span class="pre">wantobjects()</span></code> method of <code class="xref py py-class docutils literal"><span class="pre">tkapp</span></code> objects.</p>
<p>When using <code class="xref py py-mod docutils literal"><span class="pre">_tkinter</span></code> through the <code class="xref py py-mod docutils literal"><span class="pre">Tkinter</span></code> module (as most Tkinter
applications will), this feature is always activated. It should not cause
compatibility problems, since Tkinter would always convert string results to
Python types where possible.</p>
<p>If any incompatibilities are found, the old behavior can be restored by setting
the <code class="xref py py-attr docutils literal"><span class="pre">wantobjects</span></code> variable in the <code class="xref py py-mod docutils literal"><span class="pre">Tkinter</span></code> module to false before
creating the first <code class="xref py py-class docutils literal"><span class="pre">tkapp</span></code> object.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">Tkinter</span>
<span class="n">Tkinter</span><span class="o">.</span><span class="n">wantobjects</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Any breakage caused by this change should be reported as a bug.</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">UserDict</span></code> module has a new <code class="xref py py-class docutils literal"><span class="pre">DictMixin</span></code> class which defines
all dictionary methods for classes that already have a minimum mapping
interface.  This greatly simplifies writing classes that need to be
substitutable for dictionaries, such as the classes in  the <a class="reference internal" href="../library/shelve.html#module-shelve" title="shelve: Python object persistence."><code class="xref py py-mod docutils literal"><span class="pre">shelve</span></code></a>
module.</p>
<p>Adding the mix-in as a superclass provides the full dictionary interface
whenever the class defines <a class="reference internal" href="../reference/datamodel.html#object.__getitem__" title="object.__getitem__"><code class="xref py py-meth docutils literal"><span class="pre">__getitem__()</span></code></a>, <a class="reference internal" href="../reference/datamodel.html#object.__setitem__" title="object.__setitem__"><code class="xref py py-meth docutils literal"><span class="pre">__setitem__()</span></code></a>,
<a class="reference internal" href="../reference/datamodel.html#object.__delitem__" title="object.__delitem__"><code class="xref py py-meth docutils literal"><span class="pre">__delitem__()</span></code></a>, and <code class="xref py py-meth docutils literal"><span class="pre">keys()</span></code>. For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">UserDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SeqDict</span><span class="p">(</span><span class="n">UserDict</span><span class="o">.</span><span class="n">DictMixin</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;Dictionary lookalike implemented with lists.&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">keylist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">valuelist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keylist</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="ne">KeyError</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keylist</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">valuelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="gp">... </span>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">keylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">valuelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keylist</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="ne">KeyError</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">keylist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">valuelist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keylist</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">SeqDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>      <span class="c"># See that other dictionary methods are implemented</span>
<span class="go">[&#39;__cmp__&#39;, &#39;__contains__&#39;, &#39;__delitem__&#39;, &#39;__doc__&#39;, &#39;__getitem__&#39;,</span>
<span class="go"> &#39;__init__&#39;, &#39;__iter__&#39;, &#39;__len__&#39;, &#39;__module__&#39;, &#39;__repr__&#39;,</span>
<span class="go"> &#39;__setitem__&#39;, &#39;clear&#39;, &#39;get&#39;, &#39;has_key&#39;, &#39;items&#39;, &#39;iteritems&#39;,</span>
<span class="go"> &#39;iterkeys&#39;, &#39;itervalues&#39;, &#39;keylist&#39;, &#39;keys&#39;, &#39;pop&#39;, &#39;popitem&#39;,</span>
<span class="go"> &#39;setdefault&#39;, &#39;update&#39;, &#39;valuelist&#39;, &#39;values&#39;]</span>
</pre></div>
</div>
<p>(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The DOM implementation in <a class="reference internal" href="../library/xml.dom.minidom.html#module-xml.dom.minidom" title="xml.dom.minidom: Minimal Document Object Model (DOM) implementation."><code class="xref py py-mod docutils literal"><span class="pre">xml.dom.minidom</span></code></a> can now generate XML output
in a particular encoding by providing an optional encoding argument to the
<code class="xref py py-meth docutils literal"><span class="pre">toxml()</span></code> and <code class="xref py py-meth docutils literal"><span class="pre">toprettyxml()</span></code> methods of DOM nodes.</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></code> module now supports an XML-RPC extension for handling nil
data values such as Python&#8217;s <code class="docutils literal"><span class="pre">None</span></code>.  Nil values are always supported on
unmarshalling an XML-RPC response.  To generate requests containing <code class="docutils literal"><span class="pre">None</span></code>,
you must supply a true value for the <em>allow_none</em> parameter when creating a
<code class="xref py py-class docutils literal"><span class="pre">Marshaller</span></code> instance.</p>
</li>
<li><p class="first">The new <code class="xref py py-mod docutils literal"><span class="pre">DocXMLRPCServer</span></code> module allows writing self-documenting XML-RPC
servers. Run it in demo mode (as a program) to see it in action.   Pointing the
Web browser to the RPC server produces pydoc-style documentation; pointing
xmlrpclib to the server allows invoking the actual methods. (Contributed by
Brian Quinlan.)</p>
</li>
<li><p class="first">Support for internationalized domain names (RFCs 3454, 3490, 3491, and 3492)
has been added. The &#8220;idna&#8221; encoding can be used to convert between a Unicode
domain name and the ASCII-compatible encoding (ACE) of that name.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="o">&gt;</span><span class="p">{}</span><span class="o">&gt;</span><span class="p">{}</span><span class="o">&gt;</span> <span class="s">u&quot;www.Alliancefrançaise.nu&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;idna&quot;</span><span class="p">)</span>
<span class="s">&#39;www.xn--alliancefranaise-npb.nu&#39;</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../library/socket.html#module-socket" title="socket: Low-level networking interface."><code class="xref py py-mod docutils literal"><span class="pre">socket</span></code></a> module has also been extended to transparently convert
Unicode hostnames to the ACE version before passing them to the C library.
Modules that deal with hostnames such as <code class="xref py py-mod docutils literal"><span class="pre">httplib</span></code> and <a class="reference internal" href="../library/ftplib.html#module-ftplib" title="ftplib: FTP protocol client (requires sockets)."><code class="xref py py-mod docutils literal"><span class="pre">ftplib</span></code></a>)
also support Unicode host names; <code class="xref py py-mod docutils literal"><span class="pre">httplib</span></code> also sends HTTP <code class="docutils literal"><span class="pre">Host</span></code>
headers using the ACE version of the domain name.  <a class="reference internal" href="../library/urllib.html#module-urllib" title="urllib"><code class="xref py py-mod docutils literal"><span class="pre">urllib</span></code></a> supports
Unicode URLs with non-ASCII host names as long as the <code class="docutils literal"><span class="pre">path</span></code> part of the URL
is ASCII only.</p>
<p>To implement this change, the <a class="reference internal" href="../library/stringprep.html#module-stringprep" title="stringprep: String preparation, as per RFC 3453"><code class="xref py py-mod docutils literal"><span class="pre">stringprep</span></code></a> module, the  <code class="docutils literal"><span class="pre">mkstringprep</span></code>
tool and the <code class="docutils literal"><span class="pre">punycode</span></code> encoding have been added.</p>
</li>
</ul>
<div class="section" id="date-time-type">
<h3>日付時刻型<a class="headerlink" href="#date-time-type" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Date and time types suitable for expressing timestamps were added as the
<a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-mod docutils literal"><span class="pre">datetime</span></code></a> module.  The types don&#8217;t support different calendars or many
fancy features, and just stick to the basics of representing time.</p>
<p>The three primary types are: <code class="xref py py-class docutils literal"><span class="pre">date</span></code>, representing a day, month, and year;
<a class="reference internal" href="../library/time.html#module-time" title="time: Time access and conversions."><code class="xref py py-class docutils literal"><span class="pre">time</span></code></a>, consisting of hour, minute, and second; and <a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-class docutils literal"><span class="pre">datetime</span></code></a>,
which contains all the attributes of both <code class="xref py py-class docutils literal"><span class="pre">date</span></code> and <a class="reference internal" href="../library/time.html#module-time" title="time: Time access and conversions."><code class="xref py py-class docutils literal"><span class="pre">time</span></code></a>.
There&#8217;s also a <code class="xref py py-class docutils literal"><span class="pre">timedelta</span></code> class representing differences between two
points in time, and time zone logic is implemented by classes inheriting from
the abstract <code class="xref py py-class docutils literal"><span class="pre">tzinfo</span></code> class.</p>
<p>You can create instances of <code class="xref py py-class docutils literal"><span class="pre">date</span></code> and <a class="reference internal" href="../library/time.html#module-time" title="time: Time access and conversions."><code class="xref py py-class docutils literal"><span class="pre">time</span></code></a> by either supplying
keyword arguments to the appropriate constructor, e.g.
<code class="docutils literal"><span class="pre">datetime.date(year=1972,</span> <span class="pre">month=10,</span> <span class="pre">day=15)</span></code>, or by using one of a number of
class methods.  For example, the <code class="xref py py-meth docutils literal"><span class="pre">date.today()</span></code> class method returns the
current local date.</p>
<p>Once created, instances of the date/time classes are all immutable. There are a
number of methods for producing formatted strings from objects:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">now</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<span class="go">&#39;2002-12-30T21:27:03.994956&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">now</span><span class="o">.</span><span class="n">ctime</span><span class="p">()</span>  <span class="c"># Only available on date, datetime</span>
<span class="go">&#39;Mon Dec 30 21:27:03 2002&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y %d %b&#39;</span><span class="p">)</span>
<span class="go">&#39;2002 30 Dec&#39;</span>
</pre></div>
</div>
<p>The <code class="xref py py-meth docutils literal"><span class="pre">replace()</span></code> method allows modifying one or more fields  of a
<code class="xref py py-class docutils literal"><span class="pre">date</span></code> or <a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-class docutils literal"><span class="pre">datetime</span></code></a> instance, returning a new instance:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">datetime.datetime(2002, 12, 30, 22, 15, 38, 827738)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2001</span><span class="p">,</span> <span class="n">hour</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="go">datetime.datetime(2001, 12, 30, 12, 15, 38, 827738)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Instances can be compared, hashed, and converted to strings (the result is the
same as that of <code class="xref py py-meth docutils literal"><span class="pre">isoformat()</span></code>).  <code class="xref py py-class docutils literal"><span class="pre">date</span></code> and <a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-class docutils literal"><span class="pre">datetime</span></code></a>
instances can be subtracted from each other, and added to <code class="xref py py-class docutils literal"><span class="pre">timedelta</span></code>
instances.  The largest missing feature is that there&#8217;s no standard library
support for parsing strings and getting back a <code class="xref py py-class docutils literal"><span class="pre">date</span></code> or
<a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-class docutils literal"><span class="pre">datetime</span></code></a>.</p>
<p>For more information, refer to the module&#8217;s reference documentation.
(Contributed by Tim Peters.)</p>
</div>
<div class="section" id="the-optparse-module">
<h3>optparse モジュール<a class="headerlink" href="#the-optparse-module" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The <a class="reference internal" href="../library/getopt.html#module-getopt" title="getopt: Portable parser for command line options; support both short and long option names."><code class="xref py py-mod docutils literal"><span class="pre">getopt</span></code></a> module provides simple parsing of command-line arguments.  The
new <a class="reference internal" href="../library/optparse.html#module-optparse" title="optparse: Command-line option parsing library. (撤廃)"><code class="xref py py-mod docutils literal"><span class="pre">optparse</span></code></a> module (originally named Optik) provides more elaborate
command-line parsing that follows the Unix conventions, automatically creates
the output for <a class="reference internal" href="../using/cmdline.html#cmdoption--help"><code class="xref std std-option docutils literal"><span class="pre">--help</span></code></a>, and can perform different actions for different
options.</p>
<p>You start by creating an instance of <code class="xref py py-class docutils literal"><span class="pre">OptionParser</span></code> and telling it what
your program&#8217;s options are.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">optparse</span> <span class="k">import</span> <span class="n">OptionParser</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
<span class="n">op</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&#39;-i&#39;</span><span class="p">,</span> <span class="s">&#39;--input&#39;</span><span class="p">,</span>
              <span class="n">action</span><span class="o">=</span><span class="s">&#39;store&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;string&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;input&#39;</span><span class="p">,</span>
              <span class="n">help</span><span class="o">=</span><span class="s">&#39;set input filename&#39;</span><span class="p">)</span>
<span class="n">op</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&#39;-l&#39;</span><span class="p">,</span> <span class="s">&#39;--length&#39;</span><span class="p">,</span>
              <span class="n">action</span><span class="o">=</span><span class="s">&#39;store&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;length&#39;</span><span class="p">,</span>
              <span class="n">help</span><span class="o">=</span><span class="s">&#39;set maximum length of output&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Parsing a command line is then done by calling the <code class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></code> method.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">options</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="nb">print</span> <span class="n">options</span>
<span class="nb">print</span> <span class="n">args</span>
</pre></div>
</div>
<p>This returns an object containing all of the option values, and a list of
strings containing the remaining arguments.</p>
<p>Invoking the script with the various arguments now works as you&#8217;d expect it to.
Note that the length argument is automatically converted to an integer.</p>
<div class="highlight-python3"><div class="highlight"><pre>$ ./python opt.py -i data arg1
&lt;Values at 0x400cad4c: {&#39;input&#39;: &#39;data&#39;, &#39;length&#39;: None}&gt;
[&#39;arg1&#39;]
$ ./python opt.py --input=data --length=4
&lt;Values at 0x400cad2c: {&#39;input&#39;: &#39;data&#39;, &#39;length&#39;: 4}&gt;
[]
$
</pre></div>
</div>
<p>The help message is automatically generated for you:</p>
<div class="highlight-python3"><div class="highlight"><pre>$ ./python opt.py --help
usage: opt.py [options]

options:
  -h, --help            show this help message and exit
  -iINPUT, --input=INPUT
                        set input filename
  -lLENGTH, --length=LENGTH
                        set maximum length of output
$
</pre></div>
</div>
<p>See the module&#8217;s documentation for more details.</p>
<p>Optik was written by Greg Ward, with suggestions from the readers of the Getopt
SIG.</p>
</div>
</div>
<div class="section" id="pymalloc-a-specialized-object-allocator">
<span id="section-pymalloc"></span><h2>Pymalloc: A Specialized Object Allocator<a class="headerlink" href="#pymalloc-a-specialized-object-allocator" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Pymalloc, a specialized object allocator written by Vladimir Marangozov, was a
feature added to Python 2.1.  Pymalloc is intended to be faster than the system
<code class="xref c c-func docutils literal"><span class="pre">malloc()</span></code> and to have less memory overhead for allocation patterns typical
of Python programs. The allocator uses C&#8217;s <code class="xref c c-func docutils literal"><span class="pre">malloc()</span></code> function to get large
pools of memory and then fulfills smaller memory requests from these pools.</p>
<p>In 2.1 and 2.2, pymalloc was an experimental feature and wasn&#8217;t enabled by
default; you had to explicitly enable it when compiling Python by providing the
<code class="xref std std-option docutils literal"><span class="pre">--with-pymalloc</span></code> option to the <strong class="program">configure</strong> script.  In 2.3,
pymalloc has had further enhancements and is now enabled by default; you&#8217;ll have
to supply <code class="xref std std-option docutils literal"><span class="pre">--without-pymalloc</span></code> to disable it.</p>
<p>This change is transparent to code written in Python; however, pymalloc may
expose bugs in C extensions.  Authors of C extension modules should test their
code with pymalloc enabled, because some incorrect code may cause core dumps at
runtime.</p>
<p>There&#8217;s one particularly common error that causes problems.  There are a number
of memory allocation functions in Python&#8217;s C API that have previously just been
aliases for the C library&#8217;s <code class="xref c c-func docutils literal"><span class="pre">malloc()</span></code> and <code class="xref c c-func docutils literal"><span class="pre">free()</span></code>, meaning that if
you accidentally called mismatched functions the error wouldn&#8217;t be noticeable.
When the object allocator is enabled, these functions aren&#8217;t aliases of
<code class="xref c c-func docutils literal"><span class="pre">malloc()</span></code> and <code class="xref c c-func docutils literal"><span class="pre">free()</span></code> any more, and calling the wrong function to
free memory may get you a core dump.  For example, if memory was allocated using
<code class="xref c c-func docutils literal"><span class="pre">PyObject_Malloc()</span></code>, it has to be freed using <code class="xref c c-func docutils literal"><span class="pre">PyObject_Free()</span></code>, not
<code class="xref c c-func docutils literal"><span class="pre">free()</span></code>.  A few modules included with Python fell afoul of this and had to
be fixed; doubtless there are more third-party modules that will have the same
problem.</p>
<p>As part of this change, the confusing multiple interfaces for allocating memory
have been consolidated down into two API families. Memory allocated with one
family must not be manipulated with functions from the other family.  There is
one family for allocating chunks of memory and another family of functions
specifically for allocating Python objects.</p>
<ul class="simple">
<li>To allocate and free an undistinguished chunk of memory use the &#8220;raw memory&#8221;
family: <a class="reference internal" href="../c-api/memory.html#c.PyMem_Malloc" title="PyMem_Malloc"><code class="xref c c-func docutils literal"><span class="pre">PyMem_Malloc()</span></code></a>, <a class="reference internal" href="../c-api/memory.html#c.PyMem_Realloc" title="PyMem_Realloc"><code class="xref c c-func docutils literal"><span class="pre">PyMem_Realloc()</span></code></a>, and <a class="reference internal" href="../c-api/memory.html#c.PyMem_Free" title="PyMem_Free"><code class="xref c c-func docutils literal"><span class="pre">PyMem_Free()</span></code></a>.</li>
<li>The &#8220;object memory&#8221; family is the interface to the pymalloc facility described
above and is biased towards a large number of &#8220;small&#8221; allocations:
<code class="xref c c-func docutils literal"><span class="pre">PyObject_Malloc()</span></code>, <code class="xref c c-func docutils literal"><span class="pre">PyObject_Realloc()</span></code>, and <code class="xref c c-func docutils literal"><span class="pre">PyObject_Free()</span></code>.</li>
<li>To allocate and free Python objects, use the &#8220;object&#8221; family
<a class="reference internal" href="../c-api/allocation.html#c.PyObject_New" title="PyObject_New"><code class="xref c c-func docutils literal"><span class="pre">PyObject_New()</span></code></a>, <a class="reference internal" href="../c-api/allocation.html#c.PyObject_NewVar" title="PyObject_NewVar"><code class="xref c c-func docutils literal"><span class="pre">PyObject_NewVar()</span></code></a>, and <a class="reference internal" href="../c-api/allocation.html#c.PyObject_Del" title="PyObject_Del"><code class="xref c c-func docutils literal"><span class="pre">PyObject_Del()</span></code></a>.</li>
</ul>
<p>Thanks to lots of work by Tim Peters, pymalloc in 2.3 also provides debugging
features to catch memory overwrites and doubled frees in both extension modules
and in the interpreter itself.  To enable this support, compile a debugging
version of the Python interpreter by running <strong class="program">configure</strong> with
<code class="xref std std-option docutils literal"><span class="pre">--with-pydebug</span></code>.</p>
<p>To aid extension writers, a header file <code class="file docutils literal"><span class="pre">Misc/pymemcompat.h</span></code> is
distributed with the source to Python 2.3 that allows Python extensions to use
the 2.3 interfaces to memory allocation while compiling against any version of
Python since 1.5.2.  You would copy the file from Python&#8217;s source distribution
and bundle it with the source of your extension.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><a class="reference external" href="https://svn.python.org/view/python/trunk/Objects/obmalloc.c">https://svn.python.org/view/python/trunk/Objects/obmalloc.c</a></dt>
<dd>For the full details of the pymalloc implementation, see the comments at
the top of the file <code class="file docutils literal"><span class="pre">Objects/obmalloc.c</span></code> in the Python source code.
The above link points to the file within the python.org SVN browser.</dd>
</dl>
</div>
</div>
<div class="section" id="build-and-c-api-changes">
<h2>ビルドならびに C API の変更<a class="headerlink" href="#build-and-c-api-changes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python のビルド過程と C API の変更は以下の通りです:</p>
<ul class="simple">
<li>The cycle detection implementation used by the garbage collection has proven
to be stable, so it&#8217;s now been made mandatory.  You can no longer compile Python
without it, and the <code class="xref std std-option docutils literal"><span class="pre">--with-cycle-gc</span></code> switch to <strong class="program">configure</strong> has
been removed.</li>
<li>Python can now optionally be built as a shared library
(<code class="file docutils literal"><span class="pre">libpython2.3.so</span></code>) by supplying <code class="xref std std-option docutils literal"><span class="pre">--enable-shared</span></code> when running
Python&#8217;s <strong class="program">configure</strong> script.  (Contributed by Ondrej Palkovsky.)</li>
<li>The <code class="xref c c-macro docutils literal"><span class="pre">DL_EXPORT</span></code> and <code class="xref c c-macro docutils literal"><span class="pre">DL_IMPORT</span></code> macros are now deprecated.
Initialization functions for Python extension modules should now be declared
using the new macro <code class="xref c c-macro docutils literal"><span class="pre">PyMODINIT_FUNC</span></code>, while the Python core will
generally use the <code class="xref c c-macro docutils literal"><span class="pre">PyAPI_FUNC</span></code> and <code class="xref c c-macro docutils literal"><span class="pre">PyAPI_DATA</span></code> macros.</li>
<li>The interpreter can be compiled without any docstrings for the built-in
functions and modules by supplying <code class="xref std std-option docutils literal"><span class="pre">--without-doc-strings</span></code> to the
<strong class="program">configure</strong> script. This makes the Python executable about 10% smaller,
but will also mean that you can&#8217;t get help for Python&#8217;s built-ins.  (Contributed
by Gustavo Niemeyer.)</li>
<li>The <code class="xref c c-func docutils literal"><span class="pre">PyArg_NoArgs()</span></code> macro is now deprecated, and code that uses it
should be changed.  For Python 2.2 and later, the method definition table can
specify the <a class="reference internal" href="../c-api/structures.html#METH_NOARGS" title="METH_NOARGS"><code class="xref py py-const docutils literal"><span class="pre">METH_NOARGS</span></code></a> flag, signalling that there are no arguments,
and the argument checking can then be removed.  If compatibility with pre-2.2
versions of Python is important, the code could use <code class="docutils literal"><span class="pre">PyArg_ParseTuple(args,</span>
<span class="pre">&quot;&quot;)</span></code> instead, but this will be slower than using <a class="reference internal" href="../c-api/structures.html#METH_NOARGS" title="METH_NOARGS"><code class="xref py py-const docutils literal"><span class="pre">METH_NOARGS</span></code></a>.</li>
<li><a class="reference internal" href="../c-api/arg.html#c.PyArg_ParseTuple" title="PyArg_ParseTuple"><code class="xref c c-func docutils literal"><span class="pre">PyArg_ParseTuple()</span></code></a> accepts new format characters for various sizes of
unsigned integers: <code class="docutils literal"><span class="pre">B</span></code> for <code class="xref c c-type docutils literal"><span class="pre">unsigned</span> <span class="pre">char</span></code>, <code class="docutils literal"><span class="pre">H</span></code> for <code class="xref c c-type docutils literal"><span class="pre">unsigned</span>
<span class="pre">short</span> <span class="pre">int</span></code>,  <code class="docutils literal"><span class="pre">I</span></code> for <code class="xref c c-type docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span></code>,  and <code class="docutils literal"><span class="pre">K</span></code> for <code class="xref c c-type docutils literal"><span class="pre">unsigned</span>
<span class="pre">long</span> <span class="pre">long</span></code>.</li>
<li>A new function, <code class="docutils literal"><span class="pre">PyObject_DelItemString(mapping,</span> <span class="pre">char</span> <span class="pre">*key)</span></code> was added
as shorthand for <code class="docutils literal"><span class="pre">PyObject_DelItem(mapping,</span> <span class="pre">PyString_New(key))</span></code>.</li>
<li>File objects now manage their internal string buffer differently, increasing
it exponentially when needed.  This results in the benchmark tests in
<code class="file docutils literal"><span class="pre">Lib/test/test_bufio.py</span></code> speeding up considerably (from 57 seconds to 1.7
seconds, according to one measurement).</li>
<li>It&#8217;s now possible to define class and static methods for a C extension type by
setting either the <a class="reference internal" href="../c-api/structures.html#METH_CLASS" title="METH_CLASS"><code class="xref py py-const docutils literal"><span class="pre">METH_CLASS</span></code></a> or <a class="reference internal" href="../c-api/structures.html#METH_STATIC" title="METH_STATIC"><code class="xref py py-const docutils literal"><span class="pre">METH_STATIC</span></code></a> flags in a
method&#8217;s <a class="reference internal" href="../c-api/structures.html#c.PyMethodDef" title="PyMethodDef"><code class="xref c c-type docutils literal"><span class="pre">PyMethodDef</span></code></a> structure.</li>
<li>Python now includes a copy of the Expat XML parser&#8217;s source code, removing any
dependence on a system version or local installation of Expat.</li>
<li>If you dynamically allocate type objects in your extension, you should be
aware of a change in the rules relating to the <code class="xref py py-attr docutils literal"><span class="pre">__module__</span></code> and
<a class="reference internal" href="../reference/import.html#__name__" title="__name__"><code class="xref py py-attr docutils literal"><span class="pre">__name__</span></code></a> attributes.  In summary, you will want to ensure the type&#8217;s
dictionary contains a <code class="docutils literal"><span class="pre">'__module__'</span></code> key; making the module name the part of
the type name leading up to the final period will no longer have the desired
effect.  For more detail, read the API reference documentation or the  source.</li>
</ul>
<div class="section" id="port-specific-changes">
<h3>ポート特有の変更<a class="headerlink" href="#port-specific-changes" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Support for a port to IBM&#8217;s OS/2 using the EMX runtime environment was merged
into the main Python source tree.  EMX is a POSIX emulation layer over the OS/2
system APIs.  The Python port for EMX tries to support all the POSIX-like
capability exposed by the EMX runtime, and mostly succeeds; <code class="xref py py-func docutils literal"><span class="pre">fork()</span></code> and
<a class="reference internal" href="../library/fcntl.html#module-fcntl" title="fcntl: The fcntl() and ioctl() system calls. (Unix)"><code class="xref py py-func docutils literal"><span class="pre">fcntl()</span></code></a> are restricted by the limitations of the underlying emulation
layer.  The standard OS/2 port, which uses IBM&#8217;s Visual Age compiler, also
gained support for case-sensitive import semantics as part of the integration of
the EMX port into CVS.  (Contributed by Andrew MacIntyre.)</p>
<p>On MacOS, most toolbox modules have been weaklinked to improve backward
compatibility.  This means that modules will no longer fail to load if a single
routine is missing on the current OS version. Instead calling the missing
routine will raise an exception. (Contributed by Jack Jansen.)</p>
<p>The RPM spec files, found in the <code class="file docutils literal"><span class="pre">Misc/RPM/</span></code> directory in the Python
source distribution, were updated for 2.3.  (Contributed by Sean Reifschneider.)</p>
<p>Other new platforms now supported by Python include AtheOS
(<a class="reference external" href="http://www.atheos.cx/">http://www.atheos.cx/</a>), GNU/Hurd, and OpenVMS.</p>
</div>
</div>
<div class="section" id="other-changes-and-fixes">
<span id="section-other"></span><h2>その他の変更と修正<a class="headerlink" href="#other-changes-and-fixes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>いつものように、たくさんのほかの改善とバグフィックスがソースツリー全体に渡って散らばっています。CVS 変更ログを検索すると、Python 2.2 から 2.3 にかけて適用されたパッチは 523、バグ修正は 514 ありました。いずれも少なく見積もって、です。</p>
<p>ほかの、さらに特筆すべき変更のいくつかを挙げます:</p>
<ul>
<li><p class="first">If the <span class="target" id="index-29"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONINSPECT"><code class="xref std std-envvar docutils literal"><span class="pre">PYTHONINSPECT</span></code></a> environment variable is set, the Python
interpreter will enter the interactive prompt after running a Python program, as
if Python had been invoked with the <a class="reference internal" href="../using/cmdline.html#cmdoption-i"><code class="xref std std-option docutils literal"><span class="pre">-i</span></code></a> option. The environment
variable can be set before running the Python interpreter, or it can be set by
the Python program as part of its execution.</p>
</li>
<li><p class="first">The <code class="file docutils literal"><span class="pre">regrtest.py</span></code> script now provides a way to allow &#8220;all resources
except <em>foo</em>.&#8221;  A resource name passed to the <a class="reference internal" href="../using/cmdline.html#cmdoption-u"><code class="xref std std-option docutils literal"><span class="pre">-u</span></code></a> option can now be
prefixed with a hyphen (<code class="docutils literal"><span class="pre">'-'</span></code>) to mean &#8220;remove this resource.&#8221;  For example,
the option &#8216;<code class="docutils literal"><span class="pre">-uall,-bsddb</span></code>&#8216; could be used to enable the use of all resources
except <code class="docutils literal"><span class="pre">bsddb</span></code>.</p>
</li>
<li><p class="first">The tools used to build the documentation now work under Cygwin as well as
Unix.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">SET_LINENO</span></code> opcode has been removed.  Back in the mists of time, this
opcode was needed to produce line numbers in tracebacks and support trace
functions (for, e.g., <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal"><span class="pre">pdb</span></code></a>). Since Python 1.5, the line numbers in
tracebacks have been computed using a different mechanism that works with
&#8220;python -O&#8221;.  For Python 2.3 Michael Hudson implemented a similar scheme to
determine when to call the trace function, removing the need for <code class="docutils literal"><span class="pre">SET_LINENO</span></code>
entirely.</p>
<p>It would be difficult to detect any resulting difference from Python code, apart
from a slight speed up when Python is run without <a class="reference internal" href="../using/cmdline.html#cmdoption-O"><code class="xref std std-option docutils literal"><span class="pre">-O</span></code></a>.</p>
<p>C extensions that access the <code class="xref py py-attr docutils literal"><span class="pre">f_lineno</span></code> field of frame objects should
instead call <code class="docutils literal"><span class="pre">PyCode_Addr2Line(f-&gt;f_code,</span> <span class="pre">f-&gt;f_lasti)</span></code>. This will have the
added effect of making the code work as desired under &#8220;python -O&#8221; in earlier
versions of Python.</p>
<p>A nifty new feature is that trace functions can now assign to the
<code class="xref py py-attr docutils literal"><span class="pre">f_lineno</span></code> attribute of frame objects, changing the line that will be
executed next.  A <code class="docutils literal"><span class="pre">jump</span></code> command has been added to the <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal"><span class="pre">pdb</span></code></a> debugger
taking advantage of this new feature. (Implemented by Richie Hindle.)</p>
</li>
</ul>
</div>
<div class="section" id="porting-to-python-2-3">
<h2>Python 2.3 への移植<a class="headerlink" href="#porting-to-python-2-3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>このセクションでは前述の変更により必要となるかもしれないコードの変更を列挙します:</p>
<ul>
<li><p class="first"><a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal"><span class="pre">yield</span></code></a> is now always a keyword; if it&#8217;s used as a variable name in
your code, a different name must be chosen.</p>
</li>
<li><p class="first">For strings <em>X</em> and <em>Y</em>, <code class="docutils literal"><span class="pre">X</span> <span class="pre">in</span> <span class="pre">Y</span></code> now works if <em>X</em> is more than one
character long.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-func docutils literal"><span class="pre">int()</span></code></a> type constructor will now return a long integer instead of
raising an <a class="reference internal" href="../library/exceptions.html#OverflowError" title="OverflowError"><code class="xref py py-exc docutils literal"><span class="pre">OverflowError</span></code></a> when a string or floating-point number is too
large to fit into an integer.</p>
</li>
<li><p class="first">If you have Unicode strings that contain 8-bit characters, you must declare
the file&#8217;s encoding (UTF-8, Latin-1, or whatever) by adding a comment to the top
of the file.  See section <a class="reference internal" href="#section-encodings"><span>PEP 263: ソースコードのエンコーディング</span></a> for more information.</p>
</li>
<li><p class="first">Calling Tcl methods through <code class="xref py py-mod docutils literal"><span class="pre">_tkinter</span></code> no longer  returns only strings.
Instead, if Tcl returns other objects those objects are converted to their
Python equivalent, if one exists, or wrapped with a <code class="xref py py-class docutils literal"><span class="pre">_tkinter.Tcl_Obj</span></code>
object if no Python equivalent exists.</p>
</li>
<li><p class="first">Large octal and hex literals such as <code class="docutils literal"><span class="pre">0xffffffff</span></code> now trigger a
<a class="reference internal" href="../library/exceptions.html#FutureWarning" title="FutureWarning"><code class="xref py py-exc docutils literal"><span class="pre">FutureWarning</span></code></a>. Currently they&#8217;re stored as 32-bit numbers and result in a
negative value, but in Python 2.4 they&#8217;ll become positive long integers.</p>
<p>There are a few ways to fix this warning.  If you really need a positive number,
just add an <code class="docutils literal"><span class="pre">L</span></code> to the end of the literal.  If you&#8217;re trying to get a 32-bit
integer with low bits set and have previously used an expression such as <code class="docutils literal"><span class="pre">~(1</span>
<span class="pre">&lt;&lt;</span> <span class="pre">31)</span></code>, it&#8217;s probably clearest to start with all bits set and clear the
desired upper bits. For example, to clear just the top bit (bit 31), you could
write <code class="docutils literal"><span class="pre">0xffffffffL</span> <span class="pre">&amp;~(1L&lt;&lt;31)</span></code>.</p>
</li>
<li><p class="first">You can no longer disable assertions by assigning to <code class="docutils literal"><span class="pre">__debug__</span></code>.</p>
</li>
<li><p class="first">The Distutils <code class="xref py py-func docutils literal"><span class="pre">setup()</span></code> function has gained various new keyword arguments
such as <em>depends</em>.  Old versions of the Distutils will abort if passed unknown
keywords.  A solution is to check for the presence of the new
<code class="xref py py-func docutils literal"><span class="pre">get_distutil_options()</span></code> function in your <code class="file docutils literal"><span class="pre">setup.py</span></code> and only uses the
new keywords with a version of the Distutils that supports them:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">distutils</span> <span class="k">import</span> <span class="n">core</span>

<span class="n">kw</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sources&#39;</span><span class="p">:</span> <span class="s">&#39;foo.c&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="s">&#39;get_distutil_options&#39;</span><span class="p">):</span>
    <span class="n">kw</span><span class="p">[</span><span class="s">&#39;depends&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;foo.h&#39;</span><span class="p">]</span>
<span class="n">ext</span> <span class="o">=</span> <span class="n">Extension</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Using <code class="docutils literal"><span class="pre">None</span></code> as a variable name will now result in a <a class="reference internal" href="../library/exceptions.html#SyntaxWarning" title="SyntaxWarning"><code class="xref py py-exc docutils literal"><span class="pre">SyntaxWarning</span></code></a>
warning.</p>
</li>
<li><p class="first">Names of extension types defined by the modules included with Python now
contain the module and a <code class="docutils literal"><span class="pre">'.'</span></code> in front of the type name.</p>
</li>
</ul>
</div>
<div class="section" id="acknowledgements">
<span id="acks"></span><h2>謝辞<a class="headerlink" href="#acknowledgements" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>著者は提案の申し出や修正、様々なこの記事の草稿の助けをしてくれた以下の人々に感謝します:  Jeff Bauer, Simon Brunning, Brett Cannon, Michael Chermside, Andrew Dalke, Scott David Daniels, Fred L. Drake, Jr., David Fraser, Kelly Gerber, Raymond Hettinger, Michael Hudson, Chris Lambert, Detlef Lannert, Martin von Löwis, Andrew MacIntyre, Lalo Martins, Chad Netzer, Gustavo Niemeyer, Neal Norwitz, Hans Nowak, Chris Reedy, Francesco Ricciardi, Vinay Sajip, Neil Schemenauer, Roman Suzi, Jason Tishler, Just van Rossum.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">What&#8217;s New in Python 2.3</a><ul>
<li><a class="reference internal" href="#pep-218-a-standard-set-datatype">PEP 218: 標準の集合データ型</a></li>
<li><a class="reference internal" href="#pep-255-simple-generators">PEP 255: 単純なジェネレータ</a></li>
<li><a class="reference internal" href="#pep-263-source-code-encodings">PEP 263: ソースコードのエンコーディング</a></li>
<li><a class="reference internal" href="#pep-273-importing-modules-from-zip-archives">PEP 273: Zip アーカイブからモジュールをインポートする</a></li>
<li><a class="reference internal" href="#pep-277-unicode-file-name-support-for-windows-nt">PEP 277: Windows NT での Unicode ファイル名サポート</a></li>
<li><a class="reference internal" href="#pep-278-universal-newline-support">PEP 278: Universal Newline サポート</a></li>
<li><a class="reference internal" href="#pep-279-enumerate">PEP 279: enumerate()</a></li>
<li><a class="reference internal" href="#pep-282-the-logging-package">PEP 282: ロギングパッケージ</a></li>
<li><a class="reference internal" href="#pep-285-a-boolean-type">PEP 285: Boolean 型</a></li>
<li><a class="reference internal" href="#pep-293-codec-error-handling-callbacks">PEP 293: コーデックエラーを処理するコールバック</a></li>
<li><a class="reference internal" href="#pep-301-package-index-and-metadata-for-distutils">PEP 301: Package Index and Metadata for Distutils</a></li>
<li><a class="reference internal" href="#pep-302-new-import-hooks">PEP 302: 新たなインポートフック</a></li>
<li><a class="reference internal" href="#pep-305-comma-separated-files">PEP 305: Comma-separated Files</a></li>
<li><a class="reference internal" href="#pep-307-pickle-enhancements">PEP 307: Pickle の機能拡張</a></li>
<li><a class="reference internal" href="#extended-slices">拡張スライス</a></li>
<li><a class="reference internal" href="#other-language-changes">その他の言語の変更</a><ul>
<li><a class="reference internal" href="#string-changes">String Changes</a></li>
<li><a class="reference internal" href="#optimizations">最適化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-improved-and-deprecated-modules">新たなモジュール、改良されたモジュール、非推奨のモジュール</a><ul>
<li><a class="reference internal" href="#date-time-type">日付時刻型</a></li>
<li><a class="reference internal" href="#the-optparse-module">optparse モジュール</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pymalloc-a-specialized-object-allocator">Pymalloc: A Specialized Object Allocator</a></li>
<li><a class="reference internal" href="#build-and-c-api-changes">ビルドならびに C API の変更</a><ul>
<li><a class="reference internal" href="#port-specific-changes">ポート特有の変更</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-changes-and-fixes">その他の変更と修正</a></li>
<li><a class="reference internal" href="#porting-to-python-2-3">Python 2.3 への移植</a></li>
<li><a class="reference internal" href="#acknowledgements">謝辞</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="2.4.html"
                        title="前の章へ">What&#8217;s New in Python 2.4</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="2.2.html"
                        title="次の章へ">What&#8217;s New in Python 2.2</a></p>
<h3>このページ</h3>
<ul class="this-page-menu">
  <li><a href="../bugs.html">Report a Bug</a></li>
  <li><a href="../_sources/whatsnew/2.3.txt"
         rel="nofollow">Show Source</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="2.2.html" title="What’s New in Python 2.2"
             >次へ</a> |</li>
        <li class="right" >
          <a href="2.4.html" title="What’s New in Python 2.4"
             >前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &raquo;</li>
        <li>
          <span class="version_switcher_placeholder">3.4.3</span>
          <a href="../index.html">Documentation</a> &raquo;
        </li>

          <li class="nav-item nav-item-1"><a href="index.html" >What&#8217;s New in Python</a> &raquo;</li> 
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 1990-2015, Python Software Foundation.
    <br />
    The Python Software Foundation is a non-profit corporation.
    <a href="https://www.python.org/psf/donations/">Please donate.</a>
    <br />
    Last updated on Dec 28, 2015.
    <a href="../bugs.html">Found a bug</a>?
    <br />
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    <br />
    <a href="https://github.com/python-doc-ja/python-doc-ja">Pythonドキュメント日本語翻訳プロジェクト</a>
    によって翻訳されました。
    <a href="https://github.com/python-doc-ja/python-doc-ja/issues">誤訳を報告する。</a>
    </div>

  </body>
</html>