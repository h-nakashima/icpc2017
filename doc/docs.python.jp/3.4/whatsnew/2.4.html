<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>What’s New in Python 2.4 &mdash; Python 3.4.3 ドキュメント</title>
    
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.4.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 3.4.3 ドキュメント 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="top" title="Python 3.4.3 ドキュメント" href="../contents.html" />
    <link rel="up" title="What’s New in Python" href="index.html" />
    <link rel="next" title="What’s New in Python 2.3" href="2.3.html" />
    <link rel="prev" title="What’s New in Python 2.5" href="2.5.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/_jp.js"></script>
    <script type="text/javascript" src="../_static/version_switch.js"></script>
    
 

  <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-34175846-1', 'python.jp');
        ga('send', 'pageview');

      </script>
  <body role="document">  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="2.3.html" title="What’s New in Python 2.3"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="2.5.html" title="What’s New in Python 2.5"
             accesskey="P">前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &raquo;</li>
        <li>
          <span class="version_switcher_placeholder">3.4.3</span>
          <a href="../index.html">Documentation</a> &raquo;
        </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">What&#8217;s New in Python</a> &raquo;</li> 
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="what-s-new-in-python-2-4">
<h1>What&#8217;s New in Python 2.4<a class="headerlink" href="#what-s-new-in-python-2-4" title="このヘッドラインへのパーマリンク">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">A.M. Kuchling</td>
</tr>
</tbody>
</table>
<p>この文書は 2005 年 3 月 30 日にリリースされた Python 2.4.1 の新機能について解説します。</p>
<p>Python 2.4 は、真ん中サイズ、のリリースです。急進的だった Python 2.2 ほどには多くの変更をしていませんが、保守的だった 2.3 よりは多くの機能を導入しています。新しい言語機能で最も重要なのが、関数デコレータとジェネレータ式です。ほかのほとんどの変更は標準ライブラリに対するものです。</p>
<p>Python 2.3 から 2.4 の CVS 変更ログによれば、適用されたパッチは 481、フィックスされたバグは 502 ありました。ともに、少なく見積もって、です。</p>
<p>このドキュメントは個々の新機能の完全な詳細を提供するのではなくて、簡易な概要を提供することを目的にしています。完全な詳細が知りたければ、 Python ライブラリリファレンス、Python リファレンスマニュアルのような Python 2.4 のドキュメントを参照してください。多くの場合個別の新機能についての実装の説明やデザインの根拠については PEP に託されています。</p>
<div class="section" id="pep-218-built-in-set-objects">
<h2>PEP 218: ビルトインの集合オブジェクト<a class="headerlink" href="#pep-218-built-in-set-objects" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python 2.3 では <code class="xref py py-mod docutils literal"><span class="pre">sets</span></code> を導入しました。集合データ型の C 実装が Python コアに新たに、2 つの新しいビルトイン型 <code class="xref py py-func docutils literal"><span class="pre">set(iterable)()</span></code> と <code class="xref py py-func docutils literal"><span class="pre">frozenset(iterable)()</span></code> として追加されています。これらは要素が集合に属しているかのメンバシップテスト、シーケンスからの重複の削除、それに和集合 (union)、共通集合 (intersection)、 差 (difference)、対称差 (symmetric difference) といった数学演算を高速に行います:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s">&#39;abracadabra&#39;</span><span class="p">)</span>              <span class="c"># form a set from a string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;z&#39;</span> <span class="ow">in</span> <span class="n">a</span>                            <span class="c"># fast membership testing</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>                                   <span class="c"># unique letters in a</span>
<span class="go">set([&#39;a&#39;, &#39;r&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                          <span class="c"># convert back into a string</span>
<span class="go">&#39;arbcd&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s">&#39;alacazam&#39;</span><span class="p">)</span>                 <span class="c"># form a second set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span>                               <span class="c"># letters in a but not in b</span>
<span class="go">set([&#39;r&#39;, &#39;d&#39;, &#39;b&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">|</span> <span class="n">b</span>                               <span class="c"># letters in either a or b</span>
<span class="go">set([&#39;a&#39;, &#39;c&#39;, &#39;r&#39;, &#39;d&#39;, &#39;b&#39;, &#39;m&#39;, &#39;z&#39;, &#39;l&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span>                               <span class="c"># letters in both a and b</span>
<span class="go">set([&#39;a&#39;, &#39;c&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span>                               <span class="c"># letters in a or b but not both</span>
<span class="go">set([&#39;r&#39;, &#39;d&#39;, &#39;b&#39;, &#39;m&#39;, &#39;z&#39;, &#39;l&#39;])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">)</span>                          <span class="c"># add a new element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s">&#39;wxy&#39;</span><span class="p">)</span>                     <span class="c"># add multiple new elements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">set([&#39;a&#39;, &#39;c&#39;, &#39;b&#39;, &#39;d&#39;, &#39;r&#39;, &#39;w&#39;, &#39;y&#39;, &#39;x&#39;, &#39;z&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>                       <span class="c"># take one element out</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">set([&#39;a&#39;, &#39;c&#39;, &#39;b&#39;, &#39;d&#39;, &#39;r&#39;, &#39;w&#39;, &#39;y&#39;, &#39;z&#39;])</span>
</pre></div>
</div>
<p><a class="reference internal" href="../library/stdtypes.html#frozenset" title="frozenset"><code class="xref py py-func docutils literal"><span class="pre">frozenset()</span></code></a> 型は <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-func docutils literal"><span class="pre">set()</span></code></a> の <a class="reference internal" href="../glossary.html#term-immutable"><span class="xref std std-term">immutable</span></a> 版です。 immutable かつハッシュ可能なので、辞書のキーやほかの set のメンバとして使えるでしょう。</p>
<p>2.3 で追加された <code class="xref py py-mod docutils literal"><span class="pre">sets</span></code> モジュールは標準ライブラリに残されていて、 <code class="xref py py-class docutils literal"><span class="pre">Set</span></code> や <code class="xref py py-class docutils literal"><span class="pre">ImmutableSet</span></code> をサブクラス化したければ便利かもしれません。今のところこれを撤廃する予定はありません。(&#8212;訳注: <code class="xref py py-mod docutils literal"><span class="pre">sets</span></code> モジュールは 2.6 で非推奨となっています。&#8212;)</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-27"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0218"><strong>PEP 218</strong></a> - 集合オブジェクト型をビルトインに追加する</dt>
<dd><p class="first last">元々は Greg Wilson によって提案され、完全な実装は Raymond Hettinger によってなされました。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-237-unifying-long-integers-and-integers">
<h2>PEP 237: 長整数と整数を一体化していく<a class="headerlink" href="#pep-237-unifying-long-integers-and-integers" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>この PEP の非常に長期に渡る移行は Python 2.2 に始まり、Python 2.4 でさらにもう一歩前進しています。2.3 では int/long の一体化後に異なる振る舞いをする整数演算をすると <a class="reference internal" href="../library/exceptions.html#FutureWarning" title="FutureWarning"><code class="xref py py-exc docutils literal"><span class="pre">FutureWarning</span></code></a> 警告を出して、結果の値は (プラットフォーム依存で) 32 ビットまたは 64 ビットに制限していました。2.4 ではこれらの式はもう警告は出さず、代わりにいつでも(2.3 とは違った)長整数となる結果をはじき出します。</p>
<p>問題を起こしうる式は主として左シフトで、そして長い 16 進リテラルと 8 進リテラルです。例えば <code class="docutils literal"><span class="pre">2</span> <span class="pre">&lt;&lt;</span> <span class="pre">32</span></code> は 2.3 では警告とともに 32 ビットプラットフォームでは結果は 0 になります。Python 2.4 ではこの式は正しい答えの 8589934592 になります。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-28"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0237"><strong>PEP 237</strong></a> - 長整数と整数を一体化していく</dt>
<dd><p class="first last">オリジナルの PEP は Moshe Zadka と GvR (Guido van Rossum) によって書かれました。.2.4 での変更については Kalle Svensson によって実装されました。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-289-generator-expressions">
<h2>PEP 289: ジェネレータ式<a class="headerlink" href="#pep-289-generator-expressions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python 2.2 で導入されたイテレータ機能と 2.3 で追加された <a class="reference internal" href="../library/itertools.html#module-itertools" title="itertools: Functions creating iterators for efficient looping."><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a> モジュールによって、一度に全てをメモリに持つことなく大きなデータセットを回すループ処理を書くのが簡単になりました。全てのアイテムを含む Python リストを生成してしまうので、リスト内包表記はこの考えにはうまく馴染みません。これによる不可避のメモリへのオブジェクト全展開は、データセットが巨大な場合は問題です。関数型スタイルのプログラムを書こうとして、このように書くのは自然かもしれません:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">links</span> <span class="o">=</span> <span class="p">[</span><span class="n">link</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">get_all_links</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">link</span><span class="o">.</span><span class="n">followed</span><span class="p">]</span>
<span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>こうではなく</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">get_all_links</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">followed</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>最初の形の方が簡潔でおそらく読みやすいですが、扱っているのがとても多くのリンクオブジェクトであるならば、全てのリンクオブジェクトが一気にメモリに載らないように二つ目の形で書く必要がありました。</p>
<p>ジェネレータ式はリスト内包と似た動作をしますが、リスト全体を実体化しません; 代わりにそれは、要素を一つずつ返すジェネレータを返します。上述の例はこう書けます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">links</span> <span class="o">=</span> <span class="p">(</span><span class="n">link</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">get_all_links</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">link</span><span class="o">.</span><span class="n">followed</span><span class="p">)</span>
<span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>上の例でのように、ジェネレータ式は常に括弧の中に書かなければなりません。関数呼び出しを囲む括弧もそれに含まれるので、関数にそのまま渡すイテレータを作りたければこれで良いです:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="nb">print</span> <span class="nb">sum</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">count</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">list_all_objects</span><span class="p">())</span>
</pre></div>
</div>
<p>ジェネレータ式はリスト内包とは色々小さい点で違います。最も顕著なのはループ変数 (上の例での <em>obj</em>) がジェネレータ式の外からアクセス不能なことです。リスト内包はループの制御変数が最後に代入された値で残ります; 将来のバージョンの Python では、この振る舞いはリスト内包がこの点でジェネレータ式と同じになるように変更されます。 (&#8212;訳注: Python 2.7 でもリスト内包のこの振る舞いは変わっておらず、警告ともなりません。制御変数が内包のスコープ外で可視でなくなったのは Python 3.0 からです。&#8212;)</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-29"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0289"><strong>PEP 289</strong></a> - ジェネレータ式</dt>
<dd><p class="first last">Raymond Hettinger によって提案され、Hye-Shik Chang に導かれた早期の尽力によって Jiwon Seo により実装されました。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-292-simpler-string-substitutions">
<h2>PEP 292: Simpler String Substitutions<a class="headerlink" href="#pep-292-simpler-string-substitutions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Some new classes in the standard library provide an alternative mechanism for
substituting variables into strings; this style of substitution may be better
for applications where untrained users need to edit templates.</p>
<p>The usual way of substituting variables by name is the <code class="docutils literal"><span class="pre">%</span></code> operator:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;%(page)i: %(title)s&#39;</span> <span class="o">%</span> <span class="p">{</span><span class="s">&#39;page&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&#39;The Best of Times&#39;</span><span class="p">}</span>
<span class="go">&#39;2: The Best of Times&#39;</span>
</pre></div>
</div>
<p>When writing the template string, it can be easy to forget the <code class="docutils literal"><span class="pre">i</span></code> or <code class="docutils literal"><span class="pre">s</span></code>
after the closing parenthesis.  This isn&#8217;t a big problem if the template is in a
Python module, because you run the code, get an &#8220;Unsupported format character&#8221;
<a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code></a>, and fix the problem.  However, consider an application such
as Mailman where template strings or translations are being edited by users who
aren&#8217;t aware of the Python language.  The format string&#8217;s syntax is complicated
to explain to such users, and if they make a mistake, it&#8217;s difficult to provide
helpful feedback to them.</p>
<p>PEP 292 adds a <code class="xref py py-class docutils literal"><span class="pre">Template</span></code> class to the <a class="reference internal" href="../library/string.html#module-string" title="string: Common string operations."><code class="xref py py-mod docutils literal"><span class="pre">string</span></code></a> module that uses
<code class="docutils literal"><span class="pre">$</span></code> to indicate a substitution:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">Template</span><span class="p">(</span><span class="s">&#39;$page: $title&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">substitute</span><span class="p">({</span><span class="s">&#39;page&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&#39;The Best of Times&#39;</span><span class="p">})</span>
<span class="go">&#39;2: The Best of Times&#39;</span>
</pre></div>
</div>
<p>If a key is missing from the dictionary, the <code class="xref py py-meth docutils literal"><span class="pre">substitute()</span></code> method will
raise a <a class="reference internal" href="../library/exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a>.  There&#8217;s also a <code class="xref py py-meth docutils literal"><span class="pre">safe_substitute()</span></code> method that
ignores missing keys:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">Template</span><span class="p">(</span><span class="s">&#39;$page: $title&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">safe_substitute</span><span class="p">({</span><span class="s">&#39;page&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
<span class="go">&#39;3: $title&#39;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-3"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0292"><strong>PEP 292</strong></a> - Simpler String Substitutions</dt>
<dd>Written and implemented  by Barry Warsaw.</dd>
</dl>
</div>
</div>
<div class="section" id="pep-318-decorators-for-functions-and-methods">
<h2>PEP 318: 関数とメソッドのためのデコレータ<a class="headerlink" href="#pep-318-decorators-for-functions-and-methods" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python 2.2 は Python オブジェクトモデルを静的メソッド、クラスメソッドを追加することで拡張はしましたが、それらを定義する新たな手段を提供するような Python 構文の拡張はしませんでした。このため、 <a class="reference internal" href="../reference/compound_stmts.html#def"><code class="xref std std-keyword docutils literal"><span class="pre">def</span></code></a> でメソッドは普通に書いたのち、新型メソッドとしての関数へ仕立て上げる <a class="reference internal" href="../library/functions.html#staticmethod" title="staticmethod"><code class="xref py py-func docutils literal"><span class="pre">staticmethod()</span></code></a> または <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-func docutils literal"><span class="pre">classmethod()</span></code></a> にその結果のメソッドを渡す、という手順を取る必要がありました。このような具合でした:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">meth</span> <span class="p">(</span><span class="n">cls</span><span class="p">):</span>
       <span class="o">...</span>

   <span class="n">meth</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">meth</span><span class="p">)</span>   <span class="c"># Rebind name to wrapped-up class method</span>
</pre></div>
</div>
<p>メソッドがとても長かったりすると、関数のボディの後ろの <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-func docutils literal"><span class="pre">classmethod()</span></code></a> 呼び出しは見失ったり忘れたりしやすいものでした。</p>
<p>そのような定義をもっと読みやすくするために何か構文を追加する、という意図は常にありましたが、2.2 のリリース時点では良い構文は明らかではありませんでした。本日時点でさえ <em>いまだ</em> 明らかとは言えませんが、ユーザは静的メソッドとクラスメソッドを簡単に手にする手段を注文し続けています; 新たな構文的機能はこの要求に合うように追加されました。</p>
<p>この新たな機能は「関数デコレータ (function decorators)」と呼ばれます。この名前は <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-func docutils literal"><span class="pre">classmethod()</span></code></a>, <a class="reference internal" href="../library/functions.html#staticmethod" title="staticmethod"><code class="xref py py-func docutils literal"><span class="pre">staticmethod()</span></code></a>, とその仲間たちが関数オブジェクトに追加的な情報を保存することから着想を得たものです; それらは関数をより多くの詳細で <em>デコレート (修飾) している</em> というわけです。</p>
<p>記法は Java より拝借して <code class="docutils literal"><span class="pre">'&#64;'</span></code> 文字を指示子として使います。この新たな構文を使うと、上記の例はこのように書けます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>

   <span class="nd">@classmethod</span>
   <span class="k">def</span> <span class="nf">meth</span> <span class="p">(</span><span class="n">cls</span><span class="p">):</span>
       <span class="o">...</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&#64;classmethod</span></code> は <code class="docutils literal"><span class="pre">meth=classmethod(meth)</span></code> 代入の速記法です。より一般的には、このように書けば…:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="nd">@A</span>
<span class="nd">@B</span>
<span class="nd">@C</span>
<span class="k">def</span> <span class="nf">f</span> <span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>これはデコレータ前史の以下コードと等価です:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">():</span> <span class="o">...</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
</pre></div>
</div>
<p>デコレータは関数定義の前になければなりません。一行ごとに一つのデコレータです。 def ステートメントと同じ行にあってはダメです。つまり <code class="docutils literal"><span class="pre">&#64;A</span> <span class="pre">def</span> <span class="pre">f():</span> <span class="pre">...</span></code> は不正です。モジュールレベルかクラス内の関数定義のみをデコレート出来ます; クラス定義はデコレート出来ません。(&#8212; 訳注: クラス定義のデコレータは Python 2.6 で追加されました (PEP 3129) 。&#8212;)</p>
<p>デコレータはただの関数です。引数としてデコレートされる関数を取り、同じ関数か何か新しいオブジェクトを返すだけの。結果がほかのデコレータ適用されるの出ない限りは、デコレータの戻り値は呼び出し可能である必要はありません (普通はそうですが)。あなた自身のデコレータを書くのは簡単です。続く単純な例は、関数オブジェクトに単に属性をセットするだけのものです:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">deco</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">func</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="s">&#39;decorated&#39;</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">func</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@deco</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">f</span><span class="p">():</span> <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">&lt;function f at 0x402ef0d4&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">attr</span>
<span class="go">&#39;decorated&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>もう少しだけ現実的な例として、続く例ではデコレータに、与えられた引数が整数かどうかチェックさせてみます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">require_int</span> <span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span> <span class="p">(</span><span class="n">arg</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@require_int</span>
<span class="k">def</span> <span class="nf">p1</span> <span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="nb">print</span> <span class="n">arg</span>

<span class="nd">@require_int</span>
<span class="k">def</span> <span class="nf">p2</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="nb">print</span> <span class="n">arg</span><span class="o">*</span><span class="mi">2</span>
</pre></div>
</div>
<p><span class="target" id="index-30"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0318"><strong>PEP 318</strong></a> にある例はこのアイディアのもっと凝った版が含まれていて、それは要求型の指定と戻り値のチェックの両方が出来ます。</p>
<p>デコレータ関数は引数を取ることが出来ます。引数が与えられた場合、あなたのデコレータ関数はそれら引数のみで呼び出され、そして新しいデコレータを返さなければなりません; この関数は単一の関数を取らなければならず、前述のように関数を返さなければなりません。言い換えると、 <code class="docutils literal"><span class="pre">&#64;A</span> <span class="pre">&#64;B</span> <span class="pre">&#64;C(args)</span></code> はこうなります:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">():</span> <span class="o">...</span>
<span class="n">_deco</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">_deco</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
</pre></div>
</div>
<p>これが正しいと理解するには少しばかり頭をひねる必要がありますが、難しすぎることはありません。</p>
<p>デコレータに関係した小さな変更は、関数の <code class="xref py py-attr docutils literal"><span class="pre">func_name</span></code> 属性が書き込み可能になったことです。この属性はトレースバックでの関数名表示に使われますので、デコレータは構築して返却する新しい関数の名前を変更すべきです。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-31"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0318"><strong>PEP 318</strong></a> - 関数、メソッド、クラスのためのデコレータ</dt>
<dd><p class="first last">Kevin D. Smith, Jim Jewett, Skip Montanaro により著されました。数多くの人々が関数デコレータ実装のパッチを書きましたが、実際にチェックインされたものは Mark Russell が書いた #979728 でした。</p>
</dd>
<dt><a class="reference external" href="https://www.python.org/moin/PythonDecoratorLibrary">https://www.python.org/moin/PythonDecoratorLibrary</a></dt>
<dd><p class="first last">数多くのデコレータ例を含む Wiki ページ。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-322-reverse-iteration">
<h2>PEP 322: Reverse Iteration<a class="headerlink" href="#pep-322-reverse-iteration" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A new built-in function, <code class="docutils literal"><span class="pre">reversed(seq)</span></code>, takes a sequence and returns an
iterator that loops over the elements of the sequence  in reverse order.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">i</span>
<span class="gp">...</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Compared to extended slicing, such as <code class="docutils literal"><span class="pre">range(1,4)[::-1]</span></code>, <a class="reference internal" href="../library/functions.html#reversed" title="reversed"><code class="xref py py-func docutils literal"><span class="pre">reversed()</span></code></a> is
easier to read, runs faster, and uses substantially less memory.</p>
<p>Note that <a class="reference internal" href="../library/functions.html#reversed" title="reversed"><code class="xref py py-func docutils literal"><span class="pre">reversed()</span></code></a> only accepts sequences, not arbitrary iterators.  If
you want to reverse an iterator, first convert it to  a list with <a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-func docutils literal"><span class="pre">list()</span></code></a>.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;/etc/passwd&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">input</span><span class="p">)):</span>
<span class="gp">... </span>  <span class="nb">print</span> <span class="n">line</span>
<span class="gp">...</span>
<span class="go">root:*:0:0:System Administrator:/var/root:/bin/tcsh</span>
<span class="go">  ...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-6"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0322"><strong>PEP 322</strong></a> - Reverse Iteration</dt>
<dd>Written and implemented by Raymond Hettinger.</dd>
</dl>
</div>
</div>
<div class="section" id="pep-324-new-subprocess-module">
<h2>PEP 324: 新しい subprocess モジュール<a class="headerlink" href="#pep-324-new-subprocess-module" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The standard library provides a number of ways to execute a subprocess, offering
different features and different levels of complexity.
<code class="docutils literal"><span class="pre">os.system(command)</span></code> is easy to use, but slow (it runs a shell process
which executes the command) and dangerous (you have to be careful about escaping
the shell&#8217;s metacharacters).  The <code class="xref py py-mod docutils literal"><span class="pre">popen2</span></code> module offers classes that can
capture standard output and standard error from the subprocess, but the naming
is confusing.  The <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal"><span class="pre">subprocess</span></code></a> module cleans  this up, providing a unified
interface that offers all the features you might need.</p>
<p>Instead of <code class="xref py py-mod docutils literal"><span class="pre">popen2</span></code>&#8216;s collection of classes, <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal"><span class="pre">subprocess</span></code></a> contains a
single class called <code class="xref py py-class docutils literal"><span class="pre">Popen</span></code>  whose constructor supports a number of
different keyword arguments.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Popen</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">bufsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">executable</span><span class="o">=</span><span class="k">None</span><span class="p">,</span>
            <span class="n">stdin</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="k">None</span><span class="p">,</span>
            <span class="n">preexec_fn</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">close_fds</span><span class="o">=</span><span class="k">False</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="k">False</span><span class="p">,</span>
            <span class="n">cwd</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="k">False</span><span class="p">,</span>
            <span class="n">startupinfo</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">creationflags</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</pre></div>
</div>
<p><em>args</em> is commonly a sequence of strings that will be the arguments to the
program executed as the subprocess.  (If the <em>shell</em> argument is true, <em>args</em>
can be a string which will then be passed on to the shell for interpretation,
just as <a class="reference internal" href="../library/os.html#os.system" title="os.system"><code class="xref py py-func docutils literal"><span class="pre">os.system()</span></code></a> does.)</p>
<p><em>stdin</em>, <em>stdout</em>, and <em>stderr</em> specify what the subprocess&#8217;s input, output, and
error streams will be.  You can provide a file object or a file descriptor, or
you can use the constant <code class="docutils literal"><span class="pre">subprocess.PIPE</span></code> to create a pipe between the
subprocess and the parent.</p>
<p id="index-7">The constructor has a number of handy options:</p>
<ul class="simple">
<li><em>close_fds</em> requests that all file descriptors be closed before running the
subprocess.</li>
<li><em>cwd</em> specifies the working directory in which the subprocess will be executed
(defaulting to whatever the parent&#8217;s working directory is).</li>
<li><em>env</em> is a dictionary specifying environment variables.</li>
<li><em>preexec_fn</em> is a function that gets called before the child is started.</li>
<li><em>universal_newlines</em> opens the child&#8217;s input and output using Python&#8217;s
<a class="reference internal" href="../glossary.html#term-universal-newlines"><span class="xref std std-term">universal newlines</span></a> feature.</li>
</ul>
<p>Once you&#8217;ve created the <code class="xref py py-class docutils literal"><span class="pre">Popen</span></code> instance,  you can call its <code class="xref py py-meth docutils literal"><span class="pre">wait()</span></code>
method to pause until the subprocess has exited, <code class="xref py py-meth docutils literal"><span class="pre">poll()</span></code> to check if it&#8217;s
exited without pausing,  or <code class="docutils literal"><span class="pre">communicate(data)</span></code> to send the string <em>data</em>
to the subprocess&#8217;s standard input.   <code class="docutils literal"><span class="pre">communicate(data)</span></code>  then reads any
data that the subprocess has sent to its standard output  or standard error,
returning a tuple <code class="docutils literal"><span class="pre">(stdout_data,</span> <span class="pre">stderr_data)</span></code>.</p>
<p><code class="xref py py-func docutils literal"><span class="pre">call()</span></code> is a shortcut that passes its arguments along to the <code class="xref py py-class docutils literal"><span class="pre">Popen</span></code>
constructor, waits for the command to complete, and returns the status code of
the subprocess.  It can serve as a safer analog to <a class="reference internal" href="../library/os.html#os.system" title="os.system"><code class="xref py py-func docutils literal"><span class="pre">os.system()</span></code></a>:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">sts</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s">&#39;dpkg&#39;</span><span class="p">,</span> <span class="s">&#39;-i&#39;</span><span class="p">,</span> <span class="s">&#39;/tmp/new-package.deb&#39;</span><span class="p">])</span>
<span class="k">if</span> <span class="n">sts</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="c"># Success</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c"># dpkg returned an error</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The command is invoked without use of the shell.  If you really do want to  use
the shell, you can add <code class="docutils literal"><span class="pre">shell=True</span></code> as a keyword argument and provide a string
instead of a sequence:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">sts</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;dpkg -i /tmp/new-package.deb&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The PEP takes various examples of shell and Python code and shows how they&#8217;d be
translated into Python code that uses <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal"><span class="pre">subprocess</span></code></a>.  Reading this section
of the PEP is highly recommended.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-8"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0324"><strong>PEP 324</strong></a> - subprocess - New process module</dt>
<dd>Written and implemented by Peter Åstrand, with assistance from Fredrik Lundh and
others.</dd>
</dl>
</div>
</div>
<div class="section" id="pep-327-decimal-data-type">
<h2>PEP 327: Decimal データ型<a class="headerlink" href="#pep-327-decimal-data-type" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python は常に根底となる C <code class="xref c c-type docutils literal"><span class="pre">double</span></code> に基く浮動小数点(FP=floating-point)数をデータ型としてサポートします。しかしながら、ほとんどのプログラミングが浮動小数点数を提供する一方で、多くの人々 (プログラマでさえも) は浮動小数点数が小数をいくらか正確には表現出来ないことを知りません。新しい <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> 型はこれら小数を、ユーザが指定する精度限界まで正確に表現出来ます。</p>
<div class="section" id="why-is-decimal-needed">
<h3>なぜ Decimal が必要なのか?<a class="headerlink" href="#why-is-decimal-needed" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>浮動小数点数が使う表現方法に起因する制約があります。浮動小数点数は 3 つの構成要素から成ります:</p>
<ul class="simple">
<li><p class="first">符号(sign)。正または負。</p>
</li>
<li><p class="first">仮数部(mantissa)。一桁の 2 進値に端数部が続きます。例えば 2 進数で <code class="docutils literal"><span class="pre">1.01</span></code> は <code class="docutils literal"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">0/2</span> <span class="pre">+</span> <span class="pre">1/4</span></code> で 10 進表記で 1.25 です。</p>
</li>
<li><p class="first">指数部(exponent)。小数点がその数値のどこに位置するかを表します。</p>
</li>
</ul>
<p>例えば 1.25 は、正の符号を持ち、仮数部の値は (2 進数で) 1.01 で、指数部は 0 です (小数点は移動の必要がありません)。5 は同じ符号と仮数部を持ち、指数部は、仮数部が 4 倍なので 2 (2 を底とする 2 の 冪乗) です; 1.25 * 4 は 5 です。</p>
<p>現代的なシステムでは普通、浮動小数点数のサポートは IEEE 754 と名付けられた標準に従っています。 C の <code class="xref c c-type docutils literal"><span class="pre">double</span></code> 型は普通は 64 ビットの IEEE 754 数として実装され、これは仮数部として 52 ビットを使います。つまり数値は 52 ビットで記述される精度しか持てません。展開が循環に続く数値を表現しようと試みると、展開は 52 ビットより後ろは打ち切られます (訳注: expansion(展開) は 1/2 + 1/2**2 + ... 形式の級数展開を踏まえた表現。わかると思いますが一応)。不幸にもほとんどのソフトウェアは出力を 10 進数で行い、しばしば 10 進数でそうでないのに 2 進数では循環小数になります。例えば 10 進での 1.1 は 2 進で <code class="docutils literal"><span class="pre">1.0001100110011</span> <span class="pre">...</span></code> です; .1 = 1/16 + 1/32 + 1/256 プラスこれの無限繰り返し。IEEE 754 は 52 桁以降を切り落とす必要があるので、表現が少し不正確になります。</p>
<p>ときどきあなたはこの不正確さを、数値を表示する際に目にするでしょう:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="mf">1.1</span>
<span class="go">1.1000000000000001</span>
</pre></div>
</div>
<p>この不正確さは数値を表示する際にいつでも目に見えるわけではありません。浮動小数点数から文字列への変換が C ライブラリによって提供されていて、C ライブラリのほとんどが賢明な出力を生成しようと頑張っているからです。それが表示されないにしても、不正確さはそれでも存在していて、後続の計算への誤差が大きくなりえます。</p>
<p>多くのアプリケーションではこれは重要ではありません。モニタにプロットして表示するのに 1.1 と 1.1000000000000001 の差は小さすぎて見えません。大抵は出力を一定の桁位置までに制限して出力するものですし、2 やら 3 やら 8 桁などの位置で丸めたりすれば誤差は決して露わにはなりません。ですがそれが重要なアプリケーションにとっては、あなた自身のカスタム数学ルーチンのための実装作業は膨大になります。</p>
<p>こうして <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> 型が作られました。</p>
</div>
<div class="section" id="the-decimal-type">
<h3><code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> 型<a class="headerlink" href="#the-decimal-type" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>新しいモジュール <a class="reference internal" href="../library/decimal.html#module-decimal" title="decimal: Implementation of the General Decimal Arithmetic  Specification."><code class="xref py py-mod docutils literal"><span class="pre">decimal</span></code></a> が Python 標準ライブラリに追加されました。これには 2 つのクラス <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Context</span></code> を含みます。 <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> インスタンスは数値を表現し、 <code class="xref py py-class docutils literal"><span class="pre">Context</span></code> インスタンスは、精度やデフォルトの丸めモードなどのさまざまな設定をまとめるのに使われます。</p>
<p><code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> のインスタンスは普通の Python 整数や浮動小数点数のように <a class="reference internal" href="../glossary.html#term-immutable"><span class="xref std std-term">immutable</span></a> です。 <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> のインスタンスは整数や文字列から構築出来ます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">decimal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1972</span><span class="p">)</span>
<span class="go">Decimal(&quot;1972&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;1.1&quot;</span><span class="p">)</span>
<span class="go">Decimal(&quot;1.1&quot;)</span>
</pre></div>
</div>
<p>符号(sign)、10進数値のタプルで表した仮数部(mantissa)、指数部(exponent)を含んだタプルを渡すことも出来ます:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Decimal(&quot;-14.75&quot;)</span>
</pre></div>
</div>
<p>注意: 符号ビットは負符号の有無なので、 0 が正、1  が負です。</p>
<p>浮動小数点数からの変換は少々問題です: 1.1 を表現する浮動小数点数は 10 進数値の正確な 1.1 に変換すべきでしょうか、それとも 1.1 が持つどんな不正確さもそのまま持ち込むべきでしょうか? 決定は、問題をはぐらかして、その種の変換を API の範疇外とする、というものでした。代わりにあなたは浮動小数点数を望みの精度で文字列に変換して、その文字列を <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> コンストラクタに渡す必要があります:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mf">1.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">Decimal(&quot;1.1&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;%.12f&#39;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
<span class="go">Decimal(&quot;1.100000000000&quot;)</span>
</pre></div>
</div>
<p>いったん <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> を手にしてしまえばあとは普通の数学演算が使えます。制約の一つ: べき乗には整数の指数しか使えません:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;35.72&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;1.73&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">+</span><span class="n">b</span>
<span class="go">Decimal(&quot;37.45&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">-</span><span class="n">b</span>
<span class="go">Decimal(&quot;33.99&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">*</span><span class="n">b</span>
<span class="go">Decimal(&quot;61.7956&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">/</span><span class="n">b</span>
<span class="go">Decimal(&quot;20.64739884393063583815028902&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">**</span> <span class="mi">2</span>
<span class="go">Decimal(&quot;1275.9184&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">**</span><span class="n">b</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">decimal.InvalidOperation</span>: <span class="n">x ** (non-integer)</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> インスタンスと整数は混ぜて使えますが、浮動小数点数とは出来ません:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span>
<span class="go">Decimal(&quot;39.72&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="mf">4.5</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">You can interact Decimal only with int, long or Decimal data types.</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> 数を <a class="reference internal" href="../library/math.html#module-math" title="math: Mathematical functions (sin() etc.)."><code class="xref py py-mod docutils literal"><span class="pre">math</span></code></a>, <a class="reference internal" href="../library/cmath.html#module-cmath" title="cmath: Mathematical functions for complex numbers."><code class="xref py py-mod docutils literal"><span class="pre">cmath</span></code></a> モジュールで使うことは出来ますが、演算実行前にその場で浮動小数点数に変換されて、結果精度と正確性を失う可能性があります。戻り値は普通の浮動小数点数であって <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> ではありません:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">cmath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;123456789012.345&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">351364.18288201344</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmath</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">)</span>
<span class="go">351364.18288201344j</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> インスタンスは <code class="xref py py-class docutils literal"><span class="pre">Decimal</span></code> インスタンスを返す <code class="xref py py-meth docutils literal"><span class="pre">sqrt()</span></code> メソッドを持っていますが、三角関数のようななにかほかのことが必要な場合は、それらを実装する必要があるでしょう。:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">Decimal(&quot;351364.1828820134592177245001&quot;)</span>
</pre></div>
</div>
</div>
<div class="section" id="the-context-type">
<h3><code class="xref py py-class docutils literal"><span class="pre">Context</span></code> 型<a class="headerlink" href="#the-context-type" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><code class="xref py py-class docutils literal"><span class="pre">Context</span></code> クラスのインスタンスは decimal 演算についてのいくつかの設定をカプセル化しています:</p>
<ul class="simple">
<li><p class="first"><code class="xref py py-attr docutils literal"><span class="pre">prec</span></code> は精度で、小数桁数です。</p>
</li>
<li><p class="first"><code class="xref py py-attr docutils literal"><span class="pre">rounding</span></code> は丸めのモードを指定します。 <a class="reference internal" href="../library/decimal.html#module-decimal" title="decimal: Implementation of the General Decimal Arithmetic  Specification."><code class="xref py py-mod docutils literal"><span class="pre">decimal</span></code></a> にはこの値に渡せる定数が定義されています: <code class="xref py py-const docutils literal"><span class="pre">ROUND_DOWN</span></code>, <code class="xref py py-const docutils literal"><span class="pre">ROUND_CEILING</span></code>, <code class="xref py py-const docutils literal"><span class="pre">ROUND_HALF_EVEN</span></code>, それに色々。</p>
</li>
<li><p class="first"><code class="xref py py-attr docutils literal"><span class="pre">traps</span></code> は特定のエラー状態に出会った場合に何が起こるべきかを指定する辞書です: 例外を発生させるか値を返すかどちらかです。いくつかのエラー状態の例としては、ゼロ除算、精度損失、オーバーフローがあります。</p>
</li>
</ul>
<p>スレッドローカルなデフォルトのコンテキストを、 <code class="xref py py-func docutils literal"><span class="pre">getcontext()</span></code> を呼び出すことで利用出来ます; デフォルトの精度、丸めモード、トラップ処理に代えてこのコンテキストのプロパティを変更出来ます。続く例はデフォルトコンテキストの精度を変更する効果についてお見せします:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span>
<span class="go">28</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Decimal(&quot;0.1428571428571428571428571429&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Decimal(&quot;0.142857143&quot;)</span>
</pre></div>
</div>
<p>エラー状態の場合のデフォルトアクションを選択出来ます; モジュールは無限大(infinity)あるいは非数(not-a-number: NaN)を返すか、例外を投げるかです:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">decimal.DivisionByZero</span>: <span class="n">x / 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">traps</span><span class="p">[</span><span class="n">decimal</span><span class="o">.</span><span class="n">DivisionByZero</span><span class="p">]</span> <span class="o">=</span> <span class="k">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Decimal(&quot;Infinity&quot;)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal"><span class="pre">Context</span></code> インスタンスは <code class="xref py py-meth docutils literal"><span class="pre">to_eng_string()</span></code>, <code class="xref py py-meth docutils literal"><span class="pre">to_sci_string()</span></code> のような、数値の書式化のための色々なメソッドも持っています。</p>
<p>さらに詳しく知りたければ <a class="reference internal" href="../library/decimal.html#module-decimal" title="decimal: Implementation of the General Decimal Arithmetic  Specification."><code class="xref py py-mod docutils literal"><span class="pre">decimal</span></code></a> モジュールのドキュメントを読んで下さい。これには簡単に始められるチュートリアルとリファレンスが入っています。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-32"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0327"><strong>PEP 327</strong></a> - Decimal データ型</dt>
<dd><p class="first last">Facundo Batista によって著され、Facundo Batista, Eric Price, Raymond Hettinger, Aahz,  Tim Peters らによって実装されました。</p>
</dd>
<dt><a class="reference external" href="http://www.lahey.com/float.htm">http://www.lahey.com/float.htm</a></dt>
<dd><p class="first last">この記事は浮動小数点数の不正確さが起こりうるたくさんの問題について、Fortran コードを使って解説しています。</p>
</dd>
<dt><a class="reference external" href="http://www2.hursley.ibm.com/decimal/">http://www2.hursley.ibm.com/decimal/</a></dt>
<dd><p class="first last">10 進数ベースの表現についての記述です(訳注: decimal-based は小数ベースとも 10 進数ベースとも取れるのですが、後者にしておきました)。この表現方法は標準として提案されていて、この Python の decimal 型の基礎になっています。この題材の多くが Rexx 言語設計者である Mike Cowlishaw によって著されました。</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="pep-328-multi-line-imports">
<h2>PEP 328: マルチラインインポート<a class="headerlink" href="#pep-328-multi-line-imports" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>言語の変更の一つは小さな文法的な微調整で、モジュールからたくさんの名前をインポートするのを簡単にするためのものです。 <code class="docutils literal"><span class="pre">from</span> <span class="pre">module</span> <span class="pre">import</span> <span class="pre">names</span></code> 文において、 <em>names</em> はカンマ区切りのシーケンスです。シーケンスがとても長くなった場合、同じモジュールからのインポート文を何度も書くか、行末をバックスラッシュでエスケープするかするでしょう、このように:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">SimpleXMLRPCServer</span> <span class="k">import</span> <span class="n">SimpleXMLRPCServer</span><span class="p">,</span>\
            <span class="n">SimpleXMLRPCRequestHandler</span><span class="p">,</span>\
            <span class="n">CGIXMLRPCRequestHandler</span><span class="p">,</span>\
            <span class="n">resolve_dotted_attribute</span>
</pre></div>
</div>
<p>Python 2.4 での文法的な変更は、単純に names を丸括弧で囲んでも良い、とするだけのものです。Python は丸括弧内の改行を無視しますので、バックスラッシュはもう必要ありません:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">SimpleXMLRPCServer</span> <span class="k">import</span> <span class="p">(</span><span class="n">SimpleXMLRPCServer</span><span class="p">,</span>
                                <span class="n">SimpleXMLRPCRequestHandler</span><span class="p">,</span>
                                <span class="n">CGIXMLRPCRequestHandler</span><span class="p">,</span>
                                <span class="n">resolve_dotted_attribute</span><span class="p">)</span>
</pre></div>
</div>
<p>その PEP は、全ての <a class="reference internal" href="../reference/simple_stmts.html#import"><code class="xref std std-keyword docutils literal"><span class="pre">import</span></code></a> 文が絶対インポートであること、相対インポートであることを示すには <code class="docutils literal"><span class="pre">.</span></code> 文字で開始すること、の提案もしています。PEP のこの部分は Python 2.4 では実装されていませんが、 Python 2.5 向けには完了しています。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-33"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0328"><strong>PEP 328</strong></a> - マルチラインインポートと、絶対/相対インポート</dt>
<dd><p class="first last">Aahz 著.  Multi-line imports は Dima Dorfman により実装。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="pep-331-locale-independent-float-string-conversions">
<h2>PEP 331: Locale に依存しない Float/String 変換<a class="headerlink" href="#pep-331-locale-independent-float-string-conversions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference internal" href="../library/locale.html#module-locale" title="locale: Internationalization services."><code class="xref py py-mod docutils literal"><span class="pre">locale</span></code></a> モジュールにより、Python ソフトウェアは特定の国や言語の地域化をする色々な変換や表示の変換を選択出来ます。ところがこのモジュールは、数値ロケールを変更しないように気を配らなければなりませんでした。というのも Python 内の色んな関数実装が、数値ロケールが <code class="docutils literal"><span class="pre">'C'</span></code> ロケールにセットされたままであることを必要としていたからです。しばしばこれは、コードが C ライブラリの <code class="xref c c-func docutils literal"><span class="pre">atof()</span></code> 関数を使っていることに原因がありました。</p>
<p>ところが、数値ロケールをセットしないことはサードパーティの C ライブラリを使う拡張で問題を起こしました。それらが正しいロケールをセットしようとしないからです。動機となった例が GTK+ でした。そのユーザインターフェイスウィジットが、数値を現在のロケールに従って表示していませんでした。</p>
<p>この PEP に記述された解法は、ロケール設定を無視して ASCII のみの変換を実施する 3 つの新しい Python API 関数を追加することです:</p>
<ul class="simple">
<li><p class="first"><code class="docutils literal"><span class="pre">PyOS_ascii_strtod(str,</span> <span class="pre">ptr)</span></code>  と <code class="docutils literal"><span class="pre">PyOS_ascii_atof(str,</span> <span class="pre">ptr)</span></code> はともに、文字列を C の <code class="xref c c-type docutils literal"><span class="pre">double</span></code> に変換します。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">PyOS_ascii_formatd(buffer,</span> <span class="pre">buf_len,</span> <span class="pre">format,</span> <span class="pre">d)</span></code>  は <code class="xref c c-type docutils literal"><span class="pre">double</span></code> を ASCII 文字列に変換します。</p>
</li>
</ul>
<p>これら関数のコードは GLib ライブラリ (<a class="reference external" href="http://library.gnome.org/devel/glib/stable/">http://library.gnome.org/devel/glib/stable/</a>) に由来しています。GLib ライブラリの開発者たちは気前よく関連する関数をライセンス変更の上で Python Software Foundation に寄贈してくれました。 <a class="reference internal" href="../library/locale.html#module-locale" title="locale: Internationalization services."><code class="xref py py-mod docutils literal"><span class="pre">locale</span></code></a> モジュールは今では数値ロケールを変更することが出来るので、GTK+ を使うような拡張が正しい結果を生成します。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-34"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0331"><strong>PEP 331</strong></a> - Locale に依存しない Float/String 変換</dt>
<dd><p class="first last">Christian R. Reis 著, 実装 Gustavo Carneiro.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="other-language-changes">
<h2>その他の言語の変更<a class="headerlink" href="#other-language-changes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>以下が、Python 2.4 言語コアに加えられた全ての変更点です。</p>
<ul>
<li><p class="first">関数とメソッドのためのデコレータが追加されました。 (<span class="target" id="index-35"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0318"><strong>PEP 318</strong></a>).</p>
</li>
<li><p class="first">Built-in <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-func docutils literal"><span class="pre">set()</span></code></a> and <a class="reference internal" href="../library/stdtypes.html#frozenset" title="frozenset"><code class="xref py py-func docutils literal"><span class="pre">frozenset()</span></code></a> types were  added (<span class="target" id="index-13"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0218"><strong>PEP 218</strong></a>).
Other new built-ins include the <code class="docutils literal"><span class="pre">reversed(seq)</span></code> function (<span class="target" id="index-14"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0322"><strong>PEP 322</strong></a>).</p>
</li>
<li><p class="first">Generator expressions were added (<span class="target" id="index-15"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0289"><strong>PEP 289</strong></a>).</p>
</li>
<li><p class="first">Certain numeric expressions no longer return values restricted to 32 or 64
bits (<span class="target" id="index-16"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0237"><strong>PEP 237</strong></a>).</p>
</li>
<li><p class="first">You can now put parentheses around the list of names in a <code class="docutils literal"><span class="pre">from</span> <span class="pre">module</span> <span class="pre">import</span>
<span class="pre">names</span></code> statement (<span class="target" id="index-17"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0328"><strong>PEP 328</strong></a>).</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/stdtypes.html#dict.update" title="dict.update"><code class="xref py py-meth docutils literal"><span class="pre">dict.update()</span></code></a> method now accepts the same argument forms as the
<a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> constructor.  This includes any mapping, any iterable of key/value
pairs, and keyword arguments. (Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The string methods <code class="xref py py-meth docutils literal"><span class="pre">ljust()</span></code>, <code class="xref py py-meth docutils literal"><span class="pre">rjust()</span></code>, and <code class="xref py py-meth docutils literal"><span class="pre">center()</span></code> now take
an optional argument for specifying a fill character other than a space.
(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">Strings also gained an <code class="xref py py-meth docutils literal"><span class="pre">rsplit()</span></code> method that works like the <code class="xref py py-meth docutils literal"><span class="pre">split()</span></code>
method but splits from the end of the string.   (Contributed by Sean
Reifschneider.)</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;www.python.org&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[&#39;www&#39;, &#39;python.org&#39;]</span>
<span class="go">&#39;www.python.org&#39;.rsplit(&#39;.&#39;, 1)</span>
<span class="go">[&#39;www.python&#39;, &#39;org&#39;]</span>
</pre></div>
</div>
</li>
<li><p class="first">Three keyword parameters, <em>cmp</em>, <em>key</em>, and <em>reverse</em>, were added to the
<code class="xref py py-meth docutils literal"><span class="pre">sort()</span></code> method of lists. These parameters make some common usages of
<code class="xref py py-meth docutils literal"><span class="pre">sort()</span></code> simpler. All of these parameters are optional.</p>
<p>For the <em>cmp</em> parameter, the value should be a comparison function that takes
two parameters and returns -1, 0, or +1 depending on how the parameters compare.
This function will then be used to sort the list.  Previously this was the only
parameter that could be provided to <code class="xref py py-meth docutils literal"><span class="pre">sort()</span></code>.</p>
<p><em>key</em> should be a single-parameter function that takes a list element and
returns a comparison key for the element.  The list is then sorted using the
comparison keys.  The following example sorts a list case-insensitively:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>                 <span class="c"># Case-sensitive sort</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span>
<span class="go">[&#39;A&#39;, &#39;D&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Using &#39;key&#39; parameter to sort list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span>
<span class="go">[&#39;A&#39;, &#39;b&#39;, &#39;c&#39;, &#39;D&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Old-fashioned way</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="nb">cmp</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="nb">cmp</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span>
<span class="go">[&#39;A&#39;, &#39;b&#39;, &#39;c&#39;, &#39;D&#39;]</span>
</pre></div>
</div>
<p>The last example, which uses the <em>cmp</em> parameter, is the old way to perform a
case-insensitive sort.  It works but is slower than using a <em>key</em> parameter.
Using <em>key</em> calls <code class="xref py py-meth docutils literal"><span class="pre">lower()</span></code> method once for each element in the list while
using <em>cmp</em> will call it twice for each comparison, so using <em>key</em> saves on
invocations of the <code class="xref py py-meth docutils literal"><span class="pre">lower()</span></code> method.</p>
<p>For simple key functions and comparison functions, it is often possible to avoid
a <a class="reference internal" href="../reference/expressions.html#lambda"><code class="xref std std-keyword docutils literal"><span class="pre">lambda</span></code></a> expression by using an unbound method instead.  For example,
the above case-insensitive sort is best written as:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span>
<span class="go">[&#39;A&#39;, &#39;b&#39;, &#39;c&#39;, &#39;D&#39;]</span>
</pre></div>
</div>
<p>Finally, the <em>reverse</em> parameter takes a Boolean value.  If the value is true,
the list will be sorted into reverse order. Instead of <code class="docutils literal"><span class="pre">L.sort();</span>
<span class="pre">L.reverse()</span></code>, you can now write <code class="docutils literal"><span class="pre">L.sort(reverse=True)</span></code>.</p>
<p>The results of sorting are now guaranteed to be stable.  This means that two
entries with equal keys will be returned in the same order as they were input.
For example, you can sort a list of people by name, and then sort the list by
age, resulting in a list sorted by age where people with the same age are in
name-sorted order.</p>
<p>(All changes to <code class="xref py py-meth docutils literal"><span class="pre">sort()</span></code> contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">There is a new built-in function <code class="docutils literal"><span class="pre">sorted(iterable)</span></code> that works like the
in-place <a class="reference internal" href="../library/stdtypes.html#list.sort" title="list.sort"><code class="xref py py-meth docutils literal"><span class="pre">list.sort()</span></code></a> method but can be used in expressions.  The
differences are:</p>
</li>
<li><p class="first">the input may be any iterable;</p>
</li>
<li><p class="first">a newly formed copy is sorted, leaving the original intact; and</p>
</li>
<li><p class="first">the expression returns the new sorted copy</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="p">)]</span>       <span class="c"># usable in a list comprehension</span>
<span class="go">[11, 12, 13, 14, 15, 16, 17, 18, 19]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span>                               <span class="c"># original is left unchanged</span>
<span class="go">[9,7,8,3,2,4,1,6,5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="s">&#39;Monty Python&#39;</span><span class="p">)</span>          <span class="c"># any iterable may be an input</span>
<span class="go">[&#39; &#39;, &#39;M&#39;, &#39;P&#39;, &#39;h&#39;, &#39;n&#39;, &#39;n&#39;, &#39;o&#39;, &#39;o&#39;, &#39;t&#39;, &#39;t&#39;, &#39;y&#39;, &#39;y&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># List the contents of a dict sorted by key values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colormap</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">black</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">yellow</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">colormap</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span>
<span class="gp">...</span>
<span class="go">black 4</span>
<span class="go">blue 2</span>
<span class="go">green 3</span>
<span class="go">red 1</span>
<span class="go">yellow 5</span>
</pre></div>
</div>
<p>(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">整数演算はもはや <code class="xref py py-exc docutils literal"><span class="pre">OverflowWarning</span></code> は引き起こしません。 <code class="xref py py-exc docutils literal"><span class="pre">OverflowWarning</span></code> 警告は Python 2.5 で撤廃されます。</p>
</li>
<li><p class="first">インタプリタに新たに <a class="reference internal" href="../using/cmdline.html#cmdoption-m"><code class="xref std std-option docutils literal"><span class="pre">-m</span></code></a> スイッチが加わりました。これは名前を取り、 <code class="docutils literal"><span class="pre">sys.path</span></code> にある対応するモジュールを検索し、そしてそのモジュールをスクリプトとして実行します。たとえば Python プロファイラを <code class="docutils literal"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">profile</span></code> で起動することが出来るようになりました。 (Contributed by Nick Coghlan.)</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">eval(expr,</span> <span class="pre">globals,</span> <span class="pre">locals)</span></code> and <code class="docutils literal"><span class="pre">execfile(filename,</span> <span class="pre">globals,</span>
<span class="pre">locals)</span></code> functions and the <code class="docutils literal"><span class="pre">exec</span></code> statement now accept any mapping type
for the <em>locals</em> parameter.  Previously this had to be a regular Python
dictionary.  (Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/functions.html#zip" title="zip"><code class="xref py py-func docutils literal"><span class="pre">zip()</span></code></a> built-in function and <code class="xref py py-func docutils literal"><span class="pre">itertools.izip()</span></code> now return an
empty list if called with no arguments. Previously they raised a
<a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code></a> exception.  This makes them more suitable for use with variable
length argument lists:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">array</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)])</span>
<span class="go">[(1, 4), (2, 5), (3, 6)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose</span><span class="p">([])</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">Encountering a failure while importing a module no longer leaves a partially-
initialized module object in <code class="docutils literal"><span class="pre">sys.modules</span></code>.  The incomplete module object left
behind would fool further imports of the same module into succeeding, leading to
confusing errors.   (Fixed by Tim Peters.)</p>
</li>
<li><p class="first"><a class="reference internal" href="../library/constants.html#None" title="None"><code class="xref py py-const docutils literal"><span class="pre">None</span></code></a> is now a constant; code that binds a new value to  the name
<code class="docutils literal"><span class="pre">None</span></code> is now a syntax error. (Contributed by Raymond Hettinger.)</p>
</li>
</ul>
<div class="section" id="optimizations">
<h3>最適化<a class="headerlink" href="#optimizations" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>The inner loops for list and tuple slicing were optimized and now run about
one-third faster.  The inner loops for dictionaries were also optimized,
resulting in performance boosts for <code class="xref py py-meth docutils literal"><span class="pre">keys()</span></code>, <code class="xref py py-meth docutils literal"><span class="pre">values()</span></code>, <code class="xref py py-meth docutils literal"><span class="pre">items()</span></code>,
<code class="xref py py-meth docutils literal"><span class="pre">iterkeys()</span></code>, <code class="xref py py-meth docutils literal"><span class="pre">itervalues()</span></code>, and <code class="xref py py-meth docutils literal"><span class="pre">iteritems()</span></code>. (Contributed by
Raymond Hettinger.)</li>
<li>The machinery for growing and shrinking lists was optimized for speed and for
space efficiency.  Appending and popping from lists now runs faster due to more
efficient code paths and less frequent use of the underlying system
<code class="xref c c-func docutils literal"><span class="pre">realloc()</span></code>.  List comprehensions also benefit.   <code class="xref py py-meth docutils literal"><span class="pre">list.extend()</span></code> was
also optimized and no longer converts its argument into a temporary list before
extending the base list.  (Contributed by Raymond Hettinger.)</li>
<li><a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-func docutils literal"><span class="pre">list()</span></code></a>, <a class="reference internal" href="../library/stdtypes.html#tuple" title="tuple"><code class="xref py py-func docutils literal"><span class="pre">tuple()</span></code></a>, <a class="reference internal" href="../library/functions.html#map" title="map"><code class="xref py py-func docutils literal"><span class="pre">map()</span></code></a>, <a class="reference internal" href="../library/functions.html#filter" title="filter"><code class="xref py py-func docutils literal"><span class="pre">filter()</span></code></a>, and <a class="reference internal" href="../library/functions.html#zip" title="zip"><code class="xref py py-func docutils literal"><span class="pre">zip()</span></code></a> now
run several times faster with non-sequence arguments that supply a
<a class="reference internal" href="../reference/datamodel.html#object.__len__" title="object.__len__"><code class="xref py py-meth docutils literal"><span class="pre">__len__()</span></code></a> method.  (Contributed by Raymond Hettinger.)</li>
<li>The methods <code class="xref py py-meth docutils literal"><span class="pre">list.__getitem__()</span></code>, <code class="xref py py-meth docutils literal"><span class="pre">dict.__getitem__()</span></code>, and
<code class="xref py py-meth docutils literal"><span class="pre">dict.__contains__()</span></code> are now implemented as <code class="xref py py-class docutils literal"><span class="pre">method_descriptor</span></code>
objects rather than <code class="xref py py-class docutils literal"><span class="pre">wrapper_descriptor</span></code> objects.  This form of  access
doubles their performance and makes them more suitable for use as arguments to
functionals: <code class="docutils literal"><span class="pre">map(mydict.__getitem__,</span> <span class="pre">keylist)</span></code>. (Contributed by Raymond
Hettinger.)</li>
<li>Added a new opcode, <code class="docutils literal"><span class="pre">LIST_APPEND</span></code>, that simplifies the generated bytecode
for list comprehensions and speeds them up by about a third.  (Contributed by
Raymond Hettinger.)</li>
<li>The peephole bytecode optimizer has been improved to  produce shorter, faster
bytecode; remarkably, the resulting bytecode is  more readable.  (Enhanced by
Raymond Hettinger.)</li>
<li>String concatenations in statements of the form <code class="docutils literal"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">s</span> <span class="pre">+</span> <span class="pre">&quot;abc&quot;</span></code> and <code class="docutils literal"><span class="pre">s</span> <span class="pre">+=</span>
<span class="pre">&quot;abc&quot;</span></code> are now performed more efficiently in certain circumstances.  This
optimization won&#8217;t be present in other Python implementations such as Jython, so
you shouldn&#8217;t rely on it; using the <code class="xref py py-meth docutils literal"><span class="pre">join()</span></code> method of strings is still
recommended when you want to efficiently glue a large number of strings
together. (Contributed by Armin Rigo.)</li>
</ul>
<p>The net result of the 2.4 optimizations is that Python 2.4 runs the pystone
benchmark around 5% faster than Python 2.3 and 35% faster than Python 2.2.
(pystone is not a particularly good benchmark, but it&#8217;s the most commonly used
measurement of Python&#8217;s performance.  Your own applications may show greater or
smaller benefits from Python 2.4.)</p>
</div>
</div>
<div class="section" id="new-improved-and-deprecated-modules">
<h2>新たなモジュール、改良されたモジュール、非推奨のモジュール<a class="headerlink" href="#new-improved-and-deprecated-modules" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>As usual, Python&#8217;s standard library received a number of enhancements and bug
fixes.  Here&#8217;s a partial list of the most notable changes, sorted alphabetically
by module name. Consult the <code class="file docutils literal"><span class="pre">Misc/NEWS</span></code> file in the source tree for a more
complete list of changes, or look through the CVS logs for all the details.</p>
<ul>
<li><p class="first">The <a class="reference internal" href="../library/asyncore.html#module-asyncore" title="asyncore: A base class for developing asynchronous socket handling services."><code class="xref py py-mod docutils literal"><span class="pre">asyncore</span></code></a> module&#8217;s <code class="xref py py-func docutils literal"><span class="pre">loop()</span></code> function now has a <em>count</em> parameter
that lets you perform a limited number of passes through the polling loop.  The
default is still to loop forever.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/base64.html#module-base64" title="base64: RFC 3548: Base16, Base32, Base64 Data Encodings; Base85 and Ascii85"><code class="xref py py-mod docutils literal"><span class="pre">base64</span></code></a> module now has more complete RFC 3548 support for Base64,
Base32, and Base16 encoding and decoding, including optional case folding and
optional alternative alphabets. (Contributed by Barry Warsaw.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/bisect.html#module-bisect" title="bisect: Array bisection algorithms for binary searching."><code class="xref py py-mod docutils literal"><span class="pre">bisect</span></code></a> module now has an underlying C implementation for improved
performance. (Contributed by Dmitry Vasiliev.)</p>
</li>
<li><p class="first">The CJKCodecs collections of East Asian codecs, maintained by Hye-Shik Chang,
was integrated into 2.4.   The new encodings are:</p>
</li>
<li><p class="first">Chinese (PRC): gb2312, gbk, gb18030, big5hkscs, hz</p>
</li>
<li><p class="first">Chinese (ROC): big5, cp950</p>
</li>
<li><dl class="first docutils">
<dt>Japanese: cp932, euc-jis-2004, euc-jp, euc-jisx0213, iso-2022-jp,</dt>
<dd><p class="first last">iso-2022-jp-1, iso-2022-jp-2, iso-2022-jp-3, iso-2022-jp-ext, iso-2022-jp-2004,
shift-jis, shift-jisx0213, shift-jis-2004</p>
</dd>
</dl>
</li>
<li><p class="first">Korean: cp949, euc-kr, johab, iso-2022-kr</p>
</li>
<li><p class="first">Some other new encodings were added: HP Roman8,  ISO_8859-11, ISO_8859-16,
PCTP-154, and TIS-620.</p>
</li>
<li><p class="first">The UTF-8 and UTF-16 codecs now cope better with receiving partial input.
Previously the <code class="xref py py-class docutils literal"><span class="pre">StreamReader</span></code> class would try to read more data, making
it impossible to resume decoding from the stream.  The <code class="xref py py-meth docutils literal"><span class="pre">read()</span></code> method will
now return as much data as it can and future calls will resume decoding where
previous ones left off.  (Implemented by Walter Dörwald.)</p>
</li>
<li><p class="first">There is a new <a class="reference internal" href="../library/collections.html#module-collections" title="collections: Container datatypes"><code class="xref py py-mod docutils literal"><span class="pre">collections</span></code></a> module for  various specialized collection
datatypes.   Currently it contains just one type, <code class="xref py py-class docutils literal"><span class="pre">deque</span></code>,  a double-
ended queue that supports efficiently adding and removing elements from either
end:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">deque</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="s">&#39;ghi&#39;</span><span class="p">)</span>        <span class="c"># make a new deque with three items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;j&#39;</span><span class="p">)</span>           <span class="c"># add a new entry to the right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)</span>       <span class="c"># add a new entry to the left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>                       <span class="c"># show the representation of the deque</span>
<span class="go">deque([&#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>                 <span class="c"># return and remove the rightmost item</span>
<span class="go">&#39;j&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>             <span class="c"># return and remove the leftmost item</span>
<span class="go">&#39;f&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>                 <span class="c"># list the contents of the deque</span>
<span class="go">[&#39;g&#39;, &#39;h&#39;, &#39;i&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;h&#39;</span> <span class="ow">in</span> <span class="n">d</span>                <span class="c"># search the deque</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Several modules, such as the <code class="xref py py-mod docutils literal"><span class="pre">Queue</span></code> and <a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal"><span class="pre">threading</span></code></a> modules, now take
advantage of <a class="reference internal" href="../library/collections.html#collections.deque" title="collections.deque"><code class="xref py py-class docutils literal"><span class="pre">collections.deque</span></code></a> for improved performance.  (Contributed
by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">ConfigParser</span></code> classes have been enhanced slightly. The <code class="xref py py-meth docutils literal"><span class="pre">read()</span></code>
method now returns a list of the files that were successfully parsed, and the
<a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-meth docutils literal"><span class="pre">set()</span></code></a> method raises <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code></a> if passed a <em>value</em> argument that
isn&#8217;t a string.   (Contributed by John Belmonte and David Goodger.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/curses.html#module-curses" title="curses: An interface to the curses library, providing portable terminal handling. (Unix)"><code class="xref py py-mod docutils literal"><span class="pre">curses</span></code></a> module now supports the ncurses extension
<code class="xref py py-func docutils literal"><span class="pre">use_default_colors()</span></code>.  On platforms where the terminal supports
transparency, this makes it possible to use a transparent background.
(Contributed by Jörg Lehmann.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/difflib.html#module-difflib" title="difflib: Helpers for computing differences between objects."><code class="xref py py-mod docutils literal"><span class="pre">difflib</span></code></a> module now includes an <code class="xref py py-class docutils literal"><span class="pre">HtmlDiff</span></code> class that creates
an HTML table showing a side by side comparison of two versions of a text.
(Contributed by Dan Gass.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages, including MIME documents."><code class="xref py py-mod docutils literal"><span class="pre">email</span></code></a> package was updated to version 3.0,  which dropped various
deprecated APIs and removes support for Python versions earlier than 2.3.  The
3.0 version of the package uses a new incremental parser for MIME messages,
available in the <code class="xref py py-mod docutils literal"><span class="pre">email.FeedParser</span></code> module.  The new parser doesn&#8217;t require
reading the entire message into memory, and doesn&#8217;t raise exceptions if a
message is malformed; instead it records any problems in the  <code class="xref py py-attr docutils literal"><span class="pre">defect</span></code>
attribute of the message.  (Developed by Anthony Baxter, Barry Warsaw, Thomas
Wouters, and others.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/heapq.html#module-heapq" title="heapq: Heap queue algorithm (a.k.a. priority queue)."><code class="xref py py-mod docutils literal"><span class="pre">heapq</span></code></a> module has been converted to C.  The resulting tenfold
improvement in speed makes the module suitable for handling high volumes of
data.  In addition, the module has two new functions <code class="xref py py-func docutils literal"><span class="pre">nlargest()</span></code> and
<code class="xref py py-func docutils literal"><span class="pre">nsmallest()</span></code> that use heaps to find the N largest or smallest values in a
dataset without the expense of a full sort.  (Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">httplib</span></code> module now contains constants for HTTP status codes defined
in various HTTP-related RFC documents.  Constants have names such as
<code class="xref py py-const docutils literal"><span class="pre">OK</span></code>, <code class="xref py py-const docutils literal"><span class="pre">CREATED</span></code>, <code class="xref py py-const docutils literal"><span class="pre">CONTINUE</span></code>, and
<code class="xref py py-const docutils literal"><span class="pre">MOVED_PERMANENTLY</span></code>; use pydoc to get a full list.  (Contributed by
Andrew Eland.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/imaplib.html#module-imaplib" title="imaplib: IMAP4 protocol client (requires sockets)."><code class="xref py py-mod docutils literal"><span class="pre">imaplib</span></code></a> module now supports IMAP&#8217;s THREAD command (contributed by
Yves Dionne) and new <code class="xref py py-meth docutils literal"><span class="pre">deleteacl()</span></code> and <code class="xref py py-meth docutils literal"><span class="pre">myrights()</span></code> methods (contributed
by Arnaud Mazin).</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/itertools.html#module-itertools" title="itertools: Functions creating iterators for efficient looping."><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a> module gained a <code class="docutils literal"><span class="pre">groupby(iterable[,</span> <span class="pre">*func*])</span></code>
function. <em>iterable</em> is something that can be iterated over to return a stream
of elements, and the optional <em>func</em> parameter is a function that takes an
element and returns a key value; if omitted, the key is simply the element
itself.  <code class="xref py py-func docutils literal"><span class="pre">groupby()</span></code> then groups the elements into subsequences which have
matching values of the key, and returns a series of 2-tuples containing the key
value and an iterator over the subsequence.</p>
<p>Here&#8217;s an example to make this clearer.  The <em>key</em> function simply returns
whether a number is even or odd, so the result of <code class="xref py py-func docutils literal"><span class="pre">groupby()</span></code> is to return
consecutive runs of odd or even numbers.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key_val</span><span class="p">,</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">key_val</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">0 [2, 4, 6]</span>
<span class="go">1 [7]</span>
<span class="go">0 [8]</span>
<span class="go">1 [9, 11]</span>
<span class="go">0 [12, 14]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p><code class="xref py py-func docutils literal"><span class="pre">groupby()</span></code> is typically used with sorted input.  The logic for
<code class="xref py py-func docutils literal"><span class="pre">groupby()</span></code> is similar to the Unix <code class="docutils literal"><span class="pre">uniq</span></code> filter which makes it handy for
eliminating, counting, or identifying duplicate elements:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">word</span> <span class="o">=</span> <span class="s">&#39;abracadabra&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letters</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>   <span class="c"># Turn string into a sorted list of letters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letters</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;r&#39;, &#39;r&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">letters</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">a [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">b [&#39;b&#39;, &#39;b&#39;]</span>
<span class="go">c [&#39;c&#39;]</span>
<span class="go">d [&#39;d&#39;]</span>
<span class="go">r [&#39;r&#39;, &#39;r&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># List unique letters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">letters</span><span class="p">)]</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;r&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Count letter occurrences</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">letters</span><span class="p">)]</span>
<span class="go">[(&#39;a&#39;, 5), (&#39;b&#39;, 2), (&#39;c&#39;, 1), (&#39;d&#39;, 1), (&#39;r&#39;, 2)]</span>
</pre></div>
</div>
<p>(Contributed by Hye-Shik Chang.)</p>
</li>
<li><p class="first"><a class="reference internal" href="../library/itertools.html#module-itertools" title="itertools: Functions creating iterators for efficient looping."><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a> also gained a function named <code class="docutils literal"><span class="pre">tee(iterator,</span> <span class="pre">N)</span></code> that
returns <em>N</em> independent iterators that replicate <em>iterator</em>.  If <em>N</em> is omitted,
the default is 2.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">tee</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i1</span><span class="p">,</span><span class="n">i2</span>
<span class="go">(&lt;itertools.tee object at 0x402c2080&gt;, &lt;itertools.tee object at 0x402c2090&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>               <span class="c"># Run the first iterator to exhaustion</span>
<span class="go">[1, 2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span>               <span class="c"># Run the second iterator to exhaustion</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
<p>Note that <code class="xref py py-func docutils literal"><span class="pre">tee()</span></code> has to keep copies of the values returned  by the
iterator; in the worst case, it may need to keep all of them.   This should
therefore be used carefully if the leading iterator can run far ahead of the
trailing iterator in a long stream of inputs. If the separation is large, then
you might as well use  <a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-func docutils literal"><span class="pre">list()</span></code></a> instead.  When the iterators track closely
with one another, <code class="xref py py-func docutils literal"><span class="pre">tee()</span></code> is ideal.  Possible applications include
bookmarking, windowing, or lookahead iterators. (Contributed by Raymond
Hettinger.)</p>
</li>
<li><p class="first">A number of functions were added to the <a class="reference internal" href="../library/locale.html#module-locale" title="locale: Internationalization services."><code class="xref py py-mod docutils literal"><span class="pre">locale</span></code></a>  module, such as
<code class="xref py py-func docutils literal"><span class="pre">bind_textdomain_codeset()</span></code> to specify a particular encoding and a family of
<code class="xref py py-func docutils literal"><span class="pre">l*gettext()</span></code> functions that return messages in the chosen encoding.
(Contributed by Gustavo Niemeyer.)</p>
</li>
<li><p class="first">Some keyword arguments were added to the <a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> package&#8217;s
<code class="xref py py-func docutils literal"><span class="pre">basicConfig()</span></code> function to simplify log configuration.  The default
behavior is to log messages to standard error, but various keyword arguments can
be specified to log to a particular file, change the logging format, or set the
logging level. For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">&#39;/var/log/application.log&#39;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c"># Log all messages</span>
    <span class="nb">format</span><span class="o">=</span><span class="s">&#39;%(levelname):%(process):%(thread):%(message)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Other additions to the <a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> package include a <code class="docutils literal"><span class="pre">log(level,</span> <span class="pre">msg)</span></code>
convenience method, as well as a <code class="xref py py-class docutils literal"><span class="pre">TimedRotatingFileHandler</span></code> class that
rotates its log files at a timed interval.  The module already had
<code class="xref py py-class docutils literal"><span class="pre">RotatingFileHandler</span></code>, which rotated logs once the file exceeded a
certain size.  Both classes derive from a new <code class="xref py py-class docutils literal"><span class="pre">BaseRotatingHandler</span></code> class
that can be used to implement other rotating handlers.</p>
<p>(Changes implemented by Vinay Sajip.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/marshal.html#module-marshal" title="marshal: Convert Python objects to streams of bytes and back (with different constraints)."><code class="xref py py-mod docutils literal"><span class="pre">marshal</span></code></a> module now shares interned strings on unpacking a  data
structure.  This may shrink the size of certain pickle strings, but the primary
effect is to make <code class="file docutils literal"><span class="pre">.pyc</span></code> files significantly smaller. (Contributed by
Martin von Löwis.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/nntplib.html#module-nntplib" title="nntplib: NNTP protocol client (requires sockets)."><code class="xref py py-mod docutils literal"><span class="pre">nntplib</span></code></a> module&#8217;s <code class="xref py py-class docutils literal"><span class="pre">NNTP</span></code> class gained <code class="xref py py-meth docutils literal"><span class="pre">description()</span></code> and
<code class="xref py py-meth docutils literal"><span class="pre">descriptions()</span></code> methods to retrieve  newsgroup descriptions for a single
group or for a range of groups. (Contributed by Jürgen A. Erhard.)</p>
</li>
<li><p class="first">Two new functions were added to the <a class="reference internal" href="../library/operator.html#module-operator" title="operator: Functions corresponding to the standard operators."><code class="xref py py-mod docutils literal"><span class="pre">operator</span></code></a> module,
<code class="docutils literal"><span class="pre">attrgetter(attr)</span></code> and <code class="docutils literal"><span class="pre">itemgetter(index)</span></code>. Both functions return
callables that take a single argument and return the corresponding attribute or
item; these callables make excellent data extractors when used with <a class="reference internal" href="../library/functions.html#map" title="map"><code class="xref py py-func docutils literal"><span class="pre">map()</span></code></a>
or <a class="reference internal" href="../library/functions.html#sorted" title="sorted"><code class="xref py py-func docutils literal"><span class="pre">sorted()</span></code></a>.  For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">L</span><span class="p">)</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">)</span>
<span class="go">[2, 1, 4, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c"># Sort list by second tuple item</span>
<span class="go">[(&#39;d&#39;, 1), (&#39;c&#39;, 2), (&#39;b&#39;, 3), (&#39;a&#39;, 4)]</span>
</pre></div>
</div>
<p>(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/optparse.html#module-optparse" title="optparse: Command-line option parsing library. (撤廃)"><code class="xref py py-mod docutils literal"><span class="pre">optparse</span></code></a> module was updated in various ways.  The module now passes
its messages through <a class="reference internal" href="../library/gettext.html#gettext.gettext" title="gettext.gettext"><code class="xref py py-func docutils literal"><span class="pre">gettext.gettext()</span></code></a>, making it possible to
internationalize Optik&#8217;s help and error messages.  Help messages for options can
now include the string <code class="docutils literal"><span class="pre">'%default'</span></code>, which will be replaced by the option&#8217;s
default value.  (Contributed by Greg Ward.)</p>
</li>
<li><p class="first">長期間の計画として、いつかの将来の Python バージョンでは <a class="reference internal" href="../library/email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages, including MIME documents."><code class="xref py py-mod docutils literal"><span class="pre">email</span></code></a> パッケージにより <code class="xref py py-mod docutils literal"><span class="pre">rfc822</span></code> モジュールを置き換える計画です。この目的のために、 <a class="reference internal" href="../library/email.util.html#email.utils.formatdate" title="email.utils.formatdate"><code class="xref py py-func docutils literal"><span class="pre">email.utils.formatdate()</span></code></a> が、 <code class="xref py py-func docutils literal"><span class="pre">rfc822.formatdate()</span></code> の置き換えとして使えるように変更されています。新しい e-mail 処理コードはこれを使って書くことを考えてください。(Change implemented by Anthony Baxter.)</p>
</li>
<li><p class="first">A new <code class="docutils literal"><span class="pre">urandom(n)</span></code> function was added to the <a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal"><span class="pre">os</span></code></a> module, returning
a string containing <em>n</em> bytes of random data.  This function provides access to
platform-specific sources of randomness such as <code class="file docutils literal"><span class="pre">/dev/urandom</span></code> on Linux or
the Windows CryptoAPI.  (Contributed by Trevor Perrin.)</p>
</li>
<li><p class="first">Another new function: <code class="docutils literal"><span class="pre">os.path.lexists(path)</span></code>  returns true if the file
specified by <em>path</em> exists, whether or not it&#8217;s a symbolic link.  This differs
from the existing <code class="docutils literal"><span class="pre">os.path.exists(path)</span></code> function, which returns false if
<em>path</em> is a symlink that points to a destination that doesn&#8217;t exist.
(Contributed by Beni Cherniavsky.)</p>
</li>
<li><p class="first">A new <code class="xref py py-func docutils literal"><span class="pre">getsid()</span></code> function was added to the <a class="reference internal" href="../library/posix.html#module-posix" title="posix: The most common POSIX system calls (normally used via module os). (Unix)"><code class="xref py py-mod docutils literal"><span class="pre">posix</span></code></a> module that
underlies the <a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal"><span class="pre">os</span></code></a> module. (Contributed by J. Raynor.)</p>
</li>
<li><p class="first"><a class="reference internal" href="../library/poplib.html#module-poplib" title="poplib: POP3 protocol client (requires sockets)."><code class="xref py py-mod docutils literal"><span class="pre">poplib</span></code></a> モジュールが  POP over SSL をサポートするようになりました.  (Contributed by Hector Urtubia.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/profile.html#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal"><span class="pre">profile</span></code></a> module can now profile C extension functions. (Contributed
by Nick Bastin.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/random.html#module-random" title="random: Generate pseudo-random numbers with various common distributions."><code class="xref py py-mod docutils literal"><span class="pre">random</span></code></a> module has a new method called <code class="docutils literal"><span class="pre">getrandbits(N)</span></code> that
returns a long integer <em>N</em> bits in length.  The existing <code class="xref py py-meth docutils literal"><span class="pre">randrange()</span></code>
method now uses <code class="xref py py-meth docutils literal"><span class="pre">getrandbits()</span></code> where appropriate, making generation of
arbitrarily large random numbers more efficient.  (Contributed by Raymond
Hettinger.)</p>
</li>
<li><p class="first">The regular expression language accepted by the <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal"><span class="pre">re</span></code></a> module was extended
with simple conditional expressions, written as <code class="docutils literal"><span class="pre">(?(group)A|B)</span></code>.  <em>group</em> is
either a numeric group ID or a group name defined with <code class="docutils literal"><span class="pre">(?P&lt;group&gt;...)</span></code>
earlier in the expression.  If the specified group matched, the regular
expression pattern <em>A</em> will be tested against the string; if the group didn&#8217;t
match, the pattern <em>B</em> will be used instead. (Contributed by Gustavo Niemeyer.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal"><span class="pre">re</span></code></a> module is also no longer recursive, thanks to a massive amount
of work by Gustavo Niemeyer.  In a recursive regular expression engine, certain
patterns result in a large amount of C stack space being consumed, and it was
possible to overflow the stack. For example, if you matched a 30000-byte string
of <code class="docutils literal"><span class="pre">a</span></code> characters against the expression <code class="docutils literal"><span class="pre">(a|b)+</span></code>, one stack frame was
consumed per character.  Python 2.3 tried to check for stack overflow and raise
a <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal"><span class="pre">RuntimeError</span></code></a> exception, but certain patterns could sidestep the
checking and if you were unlucky Python could segfault. Python 2.4&#8217;s regular
expression engine can match this pattern without problems.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/signal.html#module-signal" title="signal: Set handlers for asynchronous events."><code class="xref py py-mod docutils literal"><span class="pre">signal</span></code></a> module now performs tighter error-checking on the parameters
to the <a class="reference internal" href="../library/signal.html#signal.signal" title="signal.signal"><code class="xref py py-func docutils literal"><span class="pre">signal.signal()</span></code></a> function.  For example, you can&#8217;t set a handler on
the <code class="xref py py-const docutils literal"><span class="pre">SIGKILL</span></code> signal; previous versions of Python would quietly accept
this, but 2.4 will raise a <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal"><span class="pre">RuntimeError</span></code></a> exception.</p>
</li>
<li><p class="first">Two new functions were added to the <a class="reference internal" href="../library/socket.html#module-socket" title="socket: Low-level networking interface."><code class="xref py py-mod docutils literal"><span class="pre">socket</span></code></a> module. <code class="xref py py-func docutils literal"><span class="pre">socketpair()</span></code>
returns a pair of connected sockets and <code class="docutils literal"><span class="pre">getservbyport(port)</span></code> looks up the
service name for a given port number. (Contributed by Dave Cole and Barry
Warsaw.)</p>
</li>
<li><p class="first">The <code class="xref py py-func docutils literal"><span class="pre">sys.exitfunc()</span></code> function has been deprecated.  Code should be using
the existing <a class="reference internal" href="../library/atexit.html#module-atexit" title="atexit: Register and execute cleanup functions."><code class="xref py py-mod docutils literal"><span class="pre">atexit</span></code></a> module, which correctly handles calling multiple exit
functions.  Eventually <code class="xref py py-func docutils literal"><span class="pre">sys.exitfunc()</span></code> will become a purely internal
interface, accessed only by <a class="reference internal" href="../library/atexit.html#module-atexit" title="atexit: Register and execute cleanup functions."><code class="xref py py-mod docutils literal"><span class="pre">atexit</span></code></a>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal"><span class="pre">tarfile</span></code></a> module now generates GNU-format tar files by default.
(Contributed by Lars Gustäbel.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal"><span class="pre">threading</span></code></a> module now has an elegantly simple way to support
thread-local data.  The module contains a <code class="xref py py-class docutils literal"><span class="pre">local</span></code> class whose attribute
values are local to different threads.</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">threading</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">local</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">data</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;www.python.org&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
<p>Other threads can assign and retrieve their own values for the <code class="xref py py-attr docutils literal"><span class="pre">number</span></code>
and <code class="xref py py-attr docutils literal"><span class="pre">url</span></code> attributes.  You can subclass <code class="xref py py-class docutils literal"><span class="pre">local</span></code> to initialize
attributes or to add methods. (Contributed by Jim Fulton.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/timeit.html#module-timeit" title="timeit: Measure the execution time of small code snippets."><code class="xref py py-mod docutils literal"><span class="pre">timeit</span></code></a> module now automatically disables periodic garbage
collection during the timing loop.  This change makes consecutive timings more
comparable.  (Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <a class="reference internal" href="../library/weakref.html#module-weakref" title="weakref: Support for weak references and weak dictionaries."><code class="xref py py-mod docutils literal"><span class="pre">weakref</span></code></a> module now supports a wider variety of objects including
Python functions, class instances, sets, frozensets, deques, arrays, files,
sockets, and regular expression pattern objects. (Contributed by Raymond
Hettinger.)</p>
</li>
<li><p class="first">The <code class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></code> module now supports a multi-call extension for
transmitting multiple XML-RPC calls in a single HTTP operation. (Contributed by
Brian Quinlan.)</p>
</li>
<li><p class="first"><code class="xref py py-mod docutils literal"><span class="pre">mpz</span></code>, <code class="xref py py-mod docutils literal"><span class="pre">rotor</span></code>,  <code class="xref py py-mod docutils literal"><span class="pre">xreadlines</span></code>  モジュールは削除されました。</p>
</li>
</ul>
<div class="section" id="cookielib">
<h3>cookielib<a class="headerlink" href="#cookielib" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The <code class="xref py py-mod docutils literal"><span class="pre">cookielib</span></code> library supports client-side handling for HTTP cookies,
mirroring the <code class="xref py py-mod docutils literal"><span class="pre">Cookie</span></code> module&#8217;s server-side cookie support. Cookies are
stored in cookie jars; the library transparently stores cookies offered by the
web server in the cookie jar, and fetches the cookie from the jar when
connecting to the server. As in web browsers, policy objects control whether
cookies are accepted or not.</p>
<p>In order to store cookies across sessions, two implementations of cookie jars
are provided: one that stores cookies in the Netscape format so applications can
use the Mozilla or Lynx cookie files, and one that stores cookies in the same
format as the Perl libwww library.</p>
<p><code class="xref py py-mod docutils literal"><span class="pre">urllib2</span></code> has been changed to interact with <code class="xref py py-mod docutils literal"><span class="pre">cookielib</span></code>:
<code class="xref py py-class docutils literal"><span class="pre">HTTPCookieProcessor</span></code> manages a cookie jar that is used when accessing
URLs.</p>
<p>This module was contributed by John J. Lee.</p>
</div>
<div class="section" id="doctest">
<h3>doctest<a class="headerlink" href="#doctest" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The <a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal"><span class="pre">doctest</span></code></a> module underwent considerable refactoring thanks to Edward
Loper and Tim Peters.  Testing can still be as simple as running
<a class="reference internal" href="../library/doctest.html#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal"><span class="pre">doctest.testmod()</span></code></a>, but the refactorings allow customizing the module&#8217;s
operation in various ways</p>
<p>The new <code class="xref py py-class docutils literal"><span class="pre">DocTestFinder</span></code> class extracts the tests from a given  object&#8217;s
docstrings:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&gt;&gt;&gt; f(2,2)</span>
<span class="sd">4</span>
<span class="sd">&gt;&gt;&gt; f(3,2)</span>
<span class="sd">6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>

<span class="n">finder</span> <span class="o">=</span> <span class="n">doctest</span><span class="o">.</span><span class="n">DocTestFinder</span><span class="p">()</span>

<span class="c"># Get list of DocTest instances</span>
<span class="n">tests</span> <span class="o">=</span> <span class="n">finder</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>The new <code class="xref py py-class docutils literal"><span class="pre">DocTestRunner</span></code> class then runs individual tests and can produce
a summary of the results:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="n">runner</span> <span class="o">=</span> <span class="n">doctest</span><span class="o">.</span><span class="n">DocTestRunner</span><span class="p">()</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
    <span class="n">tried</span><span class="p">,</span> <span class="n">failed</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="n">runner</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The above example produces the following output:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="mi">1</span> <span class="n">items</span> <span class="n">passed</span> <span class="nb">all</span> <span class="n">tests</span><span class="p">:</span>
   <span class="mi">2</span> <span class="n">tests</span> <span class="ow">in</span> <span class="n">f</span>
<span class="mi">2</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mi">1</span> <span class="n">items</span><span class="o">.</span>
<span class="mi">2</span> <span class="n">passed</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">Test</span> <span class="n">passed</span><span class="o">.</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal"><span class="pre">DocTestRunner</span></code> uses an instance of the <code class="xref py py-class docutils literal"><span class="pre">OutputChecker</span></code> class to
compare the expected output with the actual output.  This class takes a number
of different flags that customize its behaviour; ambitious users can also write
a completely new subclass of <code class="xref py py-class docutils literal"><span class="pre">OutputChecker</span></code>.</p>
<p>The default output checker provides a number of handy features. For example,
with the <a class="reference internal" href="../library/doctest.html#doctest.ELLIPSIS" title="doctest.ELLIPSIS"><code class="xref py py-const docutils literal"><span class="pre">doctest.ELLIPSIS</span></code></a> option flag, an ellipsis (<code class="docutils literal"><span class="pre">...</span></code>) in the
expected output matches any substring,  making it easier to accommodate outputs
that vary in minor ways:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">o</span> <span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&gt;&gt;&gt; o(1)</span>
<span class="sd">&lt;__main__.C instance at 0x...&gt;</span>
<span class="sd">&gt;&gt;&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Another special string, <code class="docutils literal"><span class="pre">&lt;BLANKLINE&gt;</span></code>, matches a blank line:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">p</span> <span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&gt;&gt;&gt; p(1)</span>
<span class="sd">&lt;BLANKLINE&gt;</span>
<span class="sd">&gt;&gt;&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Another new capability is producing a diff-style display of the output by
specifying the <a class="reference internal" href="../library/doctest.html#doctest.REPORT_UDIFF" title="doctest.REPORT_UDIFF"><code class="xref py py-const docutils literal"><span class="pre">doctest.REPORT_UDIFF</span></code></a> (unified diffs),
<a class="reference internal" href="../library/doctest.html#doctest.REPORT_CDIFF" title="doctest.REPORT_CDIFF"><code class="xref py py-const docutils literal"><span class="pre">doctest.REPORT_CDIFF</span></code></a> (context diffs), or <a class="reference internal" href="../library/doctest.html#doctest.REPORT_NDIFF" title="doctest.REPORT_NDIFF"><code class="xref py py-const docutils literal"><span class="pre">doctest.REPORT_NDIFF</span></code></a>
(delta-style) option flags.  For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">def</span> <span class="nf">g</span> <span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&gt;&gt;&gt; g(4)</span>
<span class="sd">here</span>
<span class="sd">is</span>
<span class="sd">a</span>
<span class="sd">lengthy</span>
<span class="sd">&gt;&gt;&gt;&quot;&quot;&quot;</span>
    <span class="n">L</span> <span class="o">=</span> <span class="s">&#39;here is a rather lengthy list of words&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">L</span><span class="p">[:</span><span class="n">n</span><span class="p">]:</span>
        <span class="nb">print</span> <span class="n">word</span>
</pre></div>
</div>
<p>Running the above function&#8217;s tests with <a class="reference internal" href="../library/doctest.html#doctest.REPORT_UDIFF" title="doctest.REPORT_UDIFF"><code class="xref py py-const docutils literal"><span class="pre">doctest.REPORT_UDIFF</span></code></a> specified,
you get the following output:</p>
<div class="highlight-python3"><div class="highlight"><pre>**********************************************************************
File &quot;t.py&quot;, line 15, in g
Failed example:
    g(4)
Differences (unified diff with -expected +actual):
    @@ -2,3 +2,3 @@
     is
     a
    -lengthy
    +rather
**********************************************************************
</pre></div>
</div>
</div>
</div>
<div class="section" id="build-and-c-api-changes">
<h2>ビルドならびに C API の変更<a class="headerlink" href="#build-and-c-api-changes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Some of the changes to Python&#8217;s build process and to the C API are:</p>
<ul class="simple">
<li>Three new convenience macros were added for common return values from
extension functions: <a class="reference internal" href="../c-api/none.html#c.Py_RETURN_NONE" title="Py_RETURN_NONE"><code class="xref c c-macro docutils literal"><span class="pre">Py_RETURN_NONE</span></code></a>, <a class="reference internal" href="../c-api/bool.html#c.Py_RETURN_TRUE" title="Py_RETURN_TRUE"><code class="xref c c-macro docutils literal"><span class="pre">Py_RETURN_TRUE</span></code></a>, and
<a class="reference internal" href="../c-api/bool.html#c.Py_RETURN_FALSE" title="Py_RETURN_FALSE"><code class="xref c c-macro docutils literal"><span class="pre">Py_RETURN_FALSE</span></code></a>. (Contributed by Brett Cannon.)</li>
<li>Another new macro, <code class="xref c c-macro docutils literal"><span class="pre">Py_CLEAR(obj)</span></code>,  decreases the reference count of
<em>obj</em> and sets <em>obj</em> to the null pointer.  (Contributed by Jim Fulton.)</li>
<li>A new function, <code class="docutils literal"><span class="pre">PyTuple_Pack(N,</span> <span class="pre">obj1,</span> <span class="pre">obj2,</span> <span class="pre">...,</span> <span class="pre">objN)</span></code>, constructs
tuples from a variable length argument list of Python objects.  (Contributed by
Raymond Hettinger.)</li>
<li>A new function, <code class="docutils literal"><span class="pre">PyDict_Contains(d,</span> <span class="pre">k)</span></code>, implements fast dictionary
lookups without masking exceptions raised during the look-up process.
(Contributed by Raymond Hettinger.)</li>
<li>The <code class="xref c c-macro docutils literal"><span class="pre">Py_IS_NAN(X)</span></code> macro returns 1 if  its float or double argument
<em>X</em> is a NaN.   (Contributed by Tim Peters.)</li>
<li>C code can avoid unnecessary locking by using the new
<a class="reference internal" href="../c-api/init.html#c.PyEval_ThreadsInitialized" title="PyEval_ThreadsInitialized"><code class="xref c c-func docutils literal"><span class="pre">PyEval_ThreadsInitialized()</span></code></a> function to tell  if any thread operations
have been performed.  If this function  returns false, no lock operations are
needed. (Contributed by Nick Coghlan.)</li>
<li>A new function, <a class="reference internal" href="../c-api/arg.html#c.PyArg_VaParseTupleAndKeywords" title="PyArg_VaParseTupleAndKeywords"><code class="xref c c-func docutils literal"><span class="pre">PyArg_VaParseTupleAndKeywords()</span></code></a>, is the same as
<a class="reference internal" href="../c-api/arg.html#c.PyArg_ParseTupleAndKeywords" title="PyArg_ParseTupleAndKeywords"><code class="xref c c-func docutils literal"><span class="pre">PyArg_ParseTupleAndKeywords()</span></code></a> but takes a  <code class="xref c c-type docutils literal"><span class="pre">va_list</span></code> instead of a
number of arguments. (Contributed by Greg Chapman.)</li>
<li>A new method flag, <code class="xref py py-const docutils literal"><span class="pre">METH_COEXISTS</span></code>, allows a function defined in slots
to co-exist with a <a class="reference internal" href="../c-api/structures.html#c.PyCFunction" title="PyCFunction"><code class="xref c c-type docutils literal"><span class="pre">PyCFunction</span></code></a> having the same name.  This can halve
the access time for a method such as <code class="xref py py-meth docutils literal"><span class="pre">set.__contains__()</span></code>.  (Contributed by
Raymond Hettinger.)</li>
<li>Python can now be built with additional profiling for the interpreter itself,
intended as an aid to people developing the Python core.  Providing
<code class="xref std std-option docutils literal"><span class="pre">----enable-profiling</span></code> to the <strong class="program">configure</strong> script will let you
profile the interpreter with <strong class="program">gprof</strong>, and providing the
<code class="xref std std-option docutils literal"><span class="pre">----with-tsc</span></code> switch enables profiling using the Pentium&#8217;s Time-Stamp-
Counter register.  Note that the <code class="xref std std-option docutils literal"><span class="pre">----with-tsc</span></code> switch is slightly
misnamed, because the profiling feature also works on the PowerPC platform,
though that processor architecture doesn&#8217;t call that register &#8220;the TSC
register&#8221;.  (Contributed by Jeremy Hylton.)</li>
<li>The <code class="xref c c-type docutils literal"><span class="pre">tracebackobject</span></code> type has been renamed to
<code class="xref c c-type docutils literal"><span class="pre">PyTracebackObject</span></code>.</li>
</ul>
<div class="section" id="port-specific-changes">
<h3>ポート特有の変更<a class="headerlink" href="#port-specific-changes" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>The Windows port now builds under MSVC++ 7.1 as well as version 6.
(Contributed by Martin von Löwis.)</li>
</ul>
</div>
</div>
<div class="section" id="porting-to-python-2-4">
<h2>Python 2.4 への移植<a class="headerlink" href="#porting-to-python-2-4" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>このセクションでは前述の変更により必要となるかもしれないコードの変更を列挙します:</p>
<ul class="simple">
<li>Left shifts and hexadecimal/octal constants that are too  large no longer
trigger a <a class="reference internal" href="../library/exceptions.html#FutureWarning" title="FutureWarning"><code class="xref py py-exc docutils literal"><span class="pre">FutureWarning</span></code></a> and return  a value limited to 32 or 64 bits;
instead they return a long integer.</li>
<li><p class="first">整数演算はもはや <code class="xref py py-exc docutils literal"><span class="pre">OverflowWarning</span></code> は引き起こしません。 <code class="xref py py-exc docutils literal"><span class="pre">OverflowWarning</span></code> 警告は Python 2.5 で撤廃されます。</p>
</li>
<li>The <a class="reference internal" href="../library/functions.html#zip" title="zip"><code class="xref py py-func docutils literal"><span class="pre">zip()</span></code></a> built-in function and <code class="xref py py-func docutils literal"><span class="pre">itertools.izip()</span></code> now return  an
empty list instead of raising a <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code></a> exception if called with no
arguments.</li>
<li>You can no longer compare the <code class="xref py py-class docutils literal"><span class="pre">date</span></code> and <a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-class docutils literal"><span class="pre">datetime</span></code></a> instances
provided by the <a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-mod docutils literal"><span class="pre">datetime</span></code></a> module.  Two  instances of different classes
will now always be unequal, and  relative comparisons (<code class="docutils literal"><span class="pre">&lt;</span></code>, <code class="docutils literal"><span class="pre">&gt;</span></code>) will raise
a <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code></a>.</li>
<li><code class="xref py py-func docutils literal"><span class="pre">dircache.listdir()</span></code> now passes exceptions to the caller instead of
returning empty lists.</li>
<li><code class="xref py py-func docutils literal"><span class="pre">LexicalHandler.startDTD()</span></code> used to receive the public and system IDs in
the wrong order.  This has been corrected; applications relying on the wrong
order need to be fixed.</li>
<li><a class="reference internal" href="../library/fcntl.html#fcntl.ioctl" title="fcntl.ioctl"><code class="xref py py-func docutils literal"><span class="pre">fcntl.ioctl()</span></code></a> now warns if the <em>mutate</em>  argument is omitted and
relevant.</li>
<li><p class="first"><a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal"><span class="pre">tarfile</span></code></a> モジュールがデフォルトで GNU フォーマットを生成するようになっています。</p>
</li>
<li>Encountering a failure while importing a module no longer leaves a partially-
initialized module object in <code class="docutils literal"><span class="pre">sys.modules</span></code>.</li>
<li><p class="first"><a class="reference internal" href="../library/constants.html#None" title="None"><code class="xref py py-const docutils literal"><span class="pre">None</span></code></a> が定数になっています。 <code class="docutils literal"><span class="pre">None</span></code> という名前に新しい値を割り当てようとするコードは、今では構文エラーになります。</p>
</li>
<li>The <code class="xref py py-func docutils literal"><span class="pre">signals.signal()</span></code> function now raises a <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal"><span class="pre">RuntimeError</span></code></a> exception
for certain illegal values; previously these errors would pass silently.  For
example, you can no longer set a handler on the <code class="xref py py-const docutils literal"><span class="pre">SIGKILL</span></code> signal.</li>
</ul>
</div>
<div class="section" id="acknowledgements">
<span id="acks"></span><h2>謝辞<a class="headerlink" href="#acknowledgements" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>著者は提案の申し出や修正、様々なこの記事の草稿の助けをしてくれた以下の人々に感謝します: Koray Can, Hye-Shik Chang, Michael Dyck, Raymond Hettinger, Brian Hurt, Hamish Lawson, Fredrik Lundh, Sean Reifschneider, Sadruddin Rejeb.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">What&#8217;s New in Python 2.4</a><ul>
<li><a class="reference internal" href="#pep-218-built-in-set-objects">PEP 218: ビルトインの集合オブジェクト</a></li>
<li><a class="reference internal" href="#pep-237-unifying-long-integers-and-integers">PEP 237: 長整数と整数を一体化していく</a></li>
<li><a class="reference internal" href="#pep-289-generator-expressions">PEP 289: ジェネレータ式</a></li>
<li><a class="reference internal" href="#pep-292-simpler-string-substitutions">PEP 292: Simpler String Substitutions</a></li>
<li><a class="reference internal" href="#pep-318-decorators-for-functions-and-methods">PEP 318: 関数とメソッドのためのデコレータ</a></li>
<li><a class="reference internal" href="#pep-322-reverse-iteration">PEP 322: Reverse Iteration</a></li>
<li><a class="reference internal" href="#pep-324-new-subprocess-module">PEP 324: 新しい subprocess モジュール</a></li>
<li><a class="reference internal" href="#pep-327-decimal-data-type">PEP 327: Decimal データ型</a><ul>
<li><a class="reference internal" href="#why-is-decimal-needed">なぜ Decimal が必要なのか?</a></li>
<li><a class="reference internal" href="#the-decimal-type"><code class="docutils literal"><span class="pre">Decimal</span></code> 型</a></li>
<li><a class="reference internal" href="#the-context-type"><code class="docutils literal"><span class="pre">Context</span></code> 型</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pep-328-multi-line-imports">PEP 328: マルチラインインポート</a></li>
<li><a class="reference internal" href="#pep-331-locale-independent-float-string-conversions">PEP 331: Locale に依存しない Float/String 変換</a></li>
<li><a class="reference internal" href="#other-language-changes">その他の言語の変更</a><ul>
<li><a class="reference internal" href="#optimizations">最適化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-improved-and-deprecated-modules">新たなモジュール、改良されたモジュール、非推奨のモジュール</a><ul>
<li><a class="reference internal" href="#cookielib">cookielib</a></li>
<li><a class="reference internal" href="#doctest">doctest</a></li>
</ul>
</li>
<li><a class="reference internal" href="#build-and-c-api-changes">ビルドならびに C API の変更</a><ul>
<li><a class="reference internal" href="#port-specific-changes">ポート特有の変更</a></li>
</ul>
</li>
<li><a class="reference internal" href="#porting-to-python-2-4">Python 2.4 への移植</a></li>
<li><a class="reference internal" href="#acknowledgements">謝辞</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="2.5.html"
                        title="前の章へ">What&#8217;s New in Python 2.5</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="2.3.html"
                        title="次の章へ">What&#8217;s New in Python 2.3</a></p>
<h3>このページ</h3>
<ul class="this-page-menu">
  <li><a href="../bugs.html">Report a Bug</a></li>
  <li><a href="../_sources/whatsnew/2.4.txt"
         rel="nofollow">Show Source</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="2.3.html" title="What’s New in Python 2.3"
             >次へ</a> |</li>
        <li class="right" >
          <a href="2.5.html" title="What’s New in Python 2.5"
             >前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &raquo;</li>
        <li>
          <span class="version_switcher_placeholder">3.4.3</span>
          <a href="../index.html">Documentation</a> &raquo;
        </li>

          <li class="nav-item nav-item-1"><a href="index.html" >What&#8217;s New in Python</a> &raquo;</li> 
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 1990-2015, Python Software Foundation.
    <br />
    The Python Software Foundation is a non-profit corporation.
    <a href="https://www.python.org/psf/donations/">Please donate.</a>
    <br />
    Last updated on Dec 28, 2015.
    <a href="../bugs.html">Found a bug</a>?
    <br />
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    <br />
    <a href="https://github.com/python-doc-ja/python-doc-ja">Pythonドキュメント日本語翻訳プロジェクト</a>
    によって翻訳されました。
    <a href="https://github.com/python-doc-ja/python-doc-ja/issues">誤訳を報告する。</a>
    </div>

  </body>
</html>